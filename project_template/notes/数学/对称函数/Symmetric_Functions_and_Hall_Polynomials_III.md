# Symmetric Functions and Hall Polynomials III
## II

## HALL POLYNOMIALS

## 1. Finite 0 -modules

Let $\mathfrak{o}$ be a (commutative) discrete valuation ring, $\mathfrak{p}$ its maximal ideal, $k=0 / p$ the residue field. Later we shall require $k$ to be a finite field, but for the present this restriction is unnecessary. We shall be concerned with finite $d$-modules $M$, that is to say, modules $M$ which possess a finite composition series, or equivalently finitely-generated o-modules $M$ such that $\mathfrak{p}^{r} M=0$ for some $r \geqslant 0$. If $k$ is finite, the finite o -modules are precisely those which have a finite number of elements.

Two examples to bear in mind are
(1.1) Example. Let $p$ be a prime number, $M$ a finite abelian $p$-group. Then $p^{r} M=0$ for large $r$, so that $M$ may be regarded as a module over the ring $\mathbf{Z} / p^{r} \mathbf{Z}$ for all large $r$, and hence as a module over the ring $\mathcal{D}=\mathbf{Z}_{p}$ of $p$-adic integers. The residue field is $k=\mathbf{F}_{p}$.
(1.2) Example. Let $k$ be a field, $M$ a finite-dimensional vector space over $k$, and let $T$ be a nilpotent endomorphism of $M$. Then $M$ may be regarded as a $k[t]$-module, where $t$ is an indeterminate, by defining $t x=T x$ for all $x \in M$. Since $T$ is nilpotent we have $t^{r} M=0$ for all large $r$, and hence $M$ may be regarded as a module over the power series ring $0=k[[t]]$, which is a discrete valuation ring with residue field $k$.

Remarks. 1. In both these examples the ring o is a complete discrete valuation ring. In general, if $M$ is a finite o -module as at the beginning, we have $\mathfrak{p}^{r} M=0$ for all sufficiently large $r$, so that $M$ is an $\mathfrak{o} / \mathfrak{p}^{r}$-module and hence a module over the $\mathfrak{p}$-adic completion $\hat{\mathfrak{o}}$ of $\mathfrak{o}$, which has the same residue field $k$ as $\mathfrak{D}$. Hence there would be no loss of generality in assuming at the outset that D is complete.
2. Suppose now that $k$ is finite. The complete discrete valuation rings with finite residue field are precisely the rings of integers of $\mathfrak{p}$-adic fields (Bourbaki, Alg. Comm., Chapter VI, §9), and a $\mathfrak{p}$-adic field $K$ is either a finite extension of the field $\mathbf{Q}_{p}$ of $p$-adic numbers (if char. $K=0$ ) or is a field of formal power series $k((t)$ ) over a finite field (if char. $K>0$ ). The two examples (1.1) and (1.2) (with $k$ finite) are therefore typical.
3. The results of this chapter will all be valid under the wider hypothesis that $o$ is the ring of integers (i.e. the unique maximal order) of a division algebra of finite rank over a $\mathfrak{p}$-adic field (Deuring, Algebren, Ch. VI, §11).

Since $\mathfrak{o}$ is a principal ideal domain, every finitely generated $\mathfrak{o}$-module is a direct sum of cyclic 0 -modules. For a finite 0 -module $M$, this means that $M$ has a direct sum decomposition of the form

$$
\begin{equation*}
M \cong \underset{i=1}{r} \mathfrak{o} / \mathfrak{p}^{\lambda_{t}} \tag{1.3}
\end{equation*}
$$

where the $\lambda_{i}$ are positive integers, which we may assume are arranged in descending order: $\lambda_{1} \geqslant \lambda_{2} \geqslant \ldots \geqslant \lambda_{r}>0$. In other words, $\lambda=\left(\lambda_{1}, \ldots, \lambda_{r}\right)$ is a partition.
(1.4) Let $\mu_{i}=\operatorname{dim}_{k}\left(\mathfrak{p}^{i-1} M / p^{i} M\right)$. Then $\mu=\left(\mu_{1}, \mu_{2}, \ldots\right)$ is the conjugate of the partition $\lambda$.

Proof. Let $x_{j}$ be a generator of the summand $\mathfrak{o} / \mathfrak{p}^{\lambda_{i}}$ in (1.3), and let $\pi$ be a generator of $\mathfrak{p}$. Then $\mathfrak{p}^{i-1} M$ is generated by those of the $\pi^{i-1} x_{j}$ which do not vanish, i.e. those for which $\lambda_{j} \geqslant i$. Hence $\mu_{j}$ is equal to the number of indices $j$ such that $\lambda_{j} \geqslant i$, and therefore $\mu_{i}=\lambda_{i}^{\prime}$.

From (1.4) it follows that the partition $\lambda$ is determined uniquely by the module $M$, and we call $\lambda$ the type of $M$. Clearly two finite 0 -modules are isomorphic if and only if they have the same type, and every partition $\lambda$ occurs as a type. If $\lambda$ is the type of $M$, then $|\lambda|=\sum \lambda_{i}$ is the length $l(M)$ of $M$, i.e. the length of a composition series of $M$. The length is an additive function of $M$ : this means that if

$$
0 \rightarrow M^{\prime} \rightarrow M \rightarrow M^{\prime \prime} \rightarrow 0
$$

is a short exact sequence of finite 0 -modules, then

$$
l\left(M^{\prime}\right)-l(M)+l\left(M^{\prime \prime}\right)=0
$$

If $N$ is a submodule of $M$, the cotype of $N$ in $M$ is defined to be the type of $M / N$.

## Cyclic and elementary modules

A finite o -module $M$ is cyclic (i.e. generated by one element) if and only if its type is a partition ( $r$ ) consisting of a single part $r=l(M)$, and $M$ is elementary (i.e. $\mathfrak{p} M=0$ ) if and only if the type of $M$ is ( $1^{r}$ ). If $M$ is elementary of type ( $1^{r}$ ), then $M$ is a vector space over $k$, and $l(M)=$ $\operatorname{dim}_{k} M=r$.

## Duality

Let $\pi$ be a generator of the maximal ideal $\mathfrak{p}$. If $m \leqslant n$, multiplication by
$\pi^{n-m}$ is an injective o -homomorphism of $\mathfrak{0} / \mathfrak{p}^{m}$ into $\mathfrak{0} / \mathfrak{p}^{n}$. Let $E$ denote the direct limit:

$$
E=\lim _{\rightarrow} \mathfrak{p} / \mathfrak{p}^{n} .
$$

Then $E$ is an injective $\mathfrak{o}$-module containing $\mathfrak{o} / \mathfrak{p}=k$, and is 'the' injective envelope of $k$, i.e. the smallest injective o -module which contains $k$ as a submodule.
If now $M$ is any finite 0 -module, the dual of $M$ is defined to be

$$
\hat{M}=\operatorname{Hom}_{\mathfrak{v}}(M, E) .
$$

$\hat{M}$ is a finite D -module isomorphic to $M$, hence of the same type as $M$. (To see this, observe that $M \mapsto \hat{M}$ commutes with direct sums; hence it is enough to check that $\hat{M} \cong M$ when $M$ is cyclic (and finite), which is easy.) Since $E$ is injective, an exact sequence

$$
0 \rightarrow N \rightarrow M \rightarrow M / N \rightarrow 0
$$

(where $N$ is a submodule of $M$ ) gives rise to an exact sequence

$$
0 \leftarrow \hat{N} \leftarrow \hat{M} \leftarrow(M / N) \leftarrow 0
$$

and $(M / N)^{\wedge}$ is the annihilator $N^{0}$ of $N$ in $\hat{M}$, i.e. the set of all $\xi \in \hat{M}$ such that $\xi(N)=0$. The natural mapping $M \rightarrow \hat{\hat{M}}$ is an isomorphism for all finite D -modules $M$, and identifies $N$ with $N^{00}$. Hence
(1.5) $N \leftrightarrow N^{0}$ is a one-one correspondence between the submodules of $M, \hat{M}$ respectively, which maps the set of all $N \subset M$ of type $\nu$ and cotype $\mu$ onto the set of all $N^{0} \subset \hat{M}$ of type $\mu$ and cotype $\nu$. |

## Automorphisms

Suppose that the residue field $k$ is finite, with $q$ elements. If $M$ is a finite 0 -module and $x$ is a non-zero element of $M$, we shall say that $x$ has height $r$ if $\mathfrak{p}^{r} x=0$ and $\mathfrak{p}^{r-1} x \neq 0$. The zero element of $M$ is assigned height 0 . We denote by $M_{r}$ the submodule of $M$ consisting of elements of height $\leqslant r$, so that $M_{r}$ is the annihilator of $\mathfrak{p}^{r}$ in $M$.
(1.6) The number of automorphisms of a finite D -module $M$ of type $\lambda$ is

$$
a_{\lambda}(q)=q^{|\lambda|+2 n(\lambda)} \prod_{i>1} \varphi_{m_{i}(\lambda)}\left(q^{-1}\right),
$$

where as usual $\varphi_{m}(t)=(1-t)\left(1-t^{2}\right) \ldots\left(1-t^{m}\right)$.
The number of automorphisms of $M$ is equal to the number of sequences $\left(x_{1}, \ldots, x_{r}\right)$ of elements of $M$ such that $x_{i}$ has height $\lambda_{i}(1 \leqslant i \leqslant r)$
and $M$ is the direct sum of the cyclic submodules $\boldsymbol{D} x_{i}$. To enumerate such sequences we shall use the following lemma:
(1.7) Let $N$ be a submodule of $M$, generated by elements of height $\geqslant r$, and let $x \in M$. Then the following conditions on $x$ are equivalent:
(i) $x$ has height $r$ and $\mathrm{D} x \cap N=0$;
(ii) $x \in M_{r}-\left(M_{r-1}+N_{r}\right)$.

Moreover the number of $x \in M$ satisfying these equivalent conditions is

$$
\begin{equation*}
q^{\lambda_{1}^{\prime}+\ldots+\lambda_{r}^{\prime}}\left(1-q^{\nu_{r}^{\prime}-\lambda_{r}^{\prime}}\right) \tag{1.8}
\end{equation*}
$$

if $\nu$ is the type of $N$.
Proof. If $x$ satisfies (i), clearly $x \in M_{r}$. If $x \in M_{r-1}+N_{r}$, then $0 \neq \mathfrak{p}^{r-1} x \subset$ $N_{r} \subset N$, so that $\mathfrak{D} x \cap N \neq 0$, contrary to assumption. Conversely, if $x$ satisfies (ii), it is clear that height $(x)=r$. If $\mathfrak{v} x \cap N \neq 0$, then for some $m<r$ we shall have $\mathfrak{p}^{m} x \subset N$, and therefore $\mathfrak{p}^{r-1} x$ is contained in the socle $N_{1}$ of $N$. Since $N$ is generated by elements of height $\geqslant r$, it follows that $\mathfrak{p}^{r-1} x=\mathfrak{p}^{r-1} y$ for some $y \in N$; hence $x-y \in M_{r-1}$ and therefore $x \in\left(M_{r-1}+N\right) \cap M_{r}=M_{r-1}+N_{r}$.

We have $M / M_{r} \cong \mathfrak{p}^{r} M$, so that

$$
l\left(M_{r}\right)=l(M)-l\left(\mathfrak{p}^{r} M\right)=\sum_{i=1}^{r} l\left(p^{i-1} M / p^{i} M\right)=\lambda_{1}^{\prime}+\ldots+\lambda_{r}^{\prime}
$$

by (1.4). Also

$$
\begin{aligned}
l\left(M_{r-1}+N_{r}\right) & =l\left(M_{r-1}\right)+l\left(\left(M_{r-1}+N_{r}\right) / M_{r-1}\right) \\
& =l\left(M_{r-1}\right)+l\left(N_{r} / N_{r-1}\right) \\
& =\lambda_{1}^{\prime}+\ldots+\lambda_{r-1}^{\prime}+\nu_{r}^{\prime}
\end{aligned}
$$

which proves (1.8).
The number of automorphisms of $M$ is therefore the product of the numbers (1.8) for $r=\lambda_{1}, \lambda_{2}, \ldots$, where $\nu=\left(\lambda_{1}, \ldots, \lambda_{k-1}\right)$ if $r=\lambda_{k}$. It is not hard to see that this product is equal to $a_{\lambda}(q)$ as defined in (1.6).

## Example

Let $M, N$ be finite $\mathfrak{0}$-modules of types $\lambda, \mu$ respectively. Then $M \oplus N$ has type $\lambda \cup \mu$, and $M \oplus N, \operatorname{Hom}(M, N), \operatorname{Tor}_{1}(M, N)$, and $\operatorname{Ext}^{1}(M, N)$ all have type $\lambda \times \mu$ (Chapter I, §1).

## 2. The Hall algebra

In this section the residue field $k$ of 0 is assumed to be finite.

Let $\lambda, \mu^{(1)}, \ldots, \mu^{(r)}$ be partitions, and let $M$ be a finite o -module of type $\lambda$. We define

$$
G_{\mu^{(0)} \ldots \mu^{(n)}}^{\lambda}(\mathfrak{D})
$$

to be the number of chains of submodules of $M$ :

$$
M=M_{0} \supset M_{1} \supset \ldots \supset M_{r}=0
$$

such that $M_{i-1} / M_{i}$ has type $\mu^{(i)}$, for $1 \leqslant i \leqslant r$. In particular, $G_{\mu \nu}^{\lambda}(\mathfrak{0})$ is the number of submodules $N$ of $M$ which have type $\nu$ and cotype $\mu$. Since $l(M)=l(M / N)+l(N)$, it is clear that
(2.1) $G_{\mu \nu}^{\lambda}(\mathfrak{0})=0$ unless $|\lambda|=|\mu|+|\nu|$.

Philip Hall had the idea of using the numbers $G_{\mu \nu}^{\lambda}(0)$ as the multiplication constants of a ring, as follows. Let $H=H(\mathfrak{D})$ be a free Z-module on a basis ( $u_{\lambda}$ ) indexed by all partitions $\lambda$. Define a product in $H$ by the rule

$$
u_{\mu} u_{\nu}=\sum_{\lambda} G_{\mu \nu}^{\lambda}(\mathfrak{D}) u_{\lambda}
$$

By (2.1) the sum on the right has only finitely many non-zero terms.
(2.2) $H(\mathfrak{D})$ is a commutative and associative ring with identity element.

Proof. The identity element is $u_{0}$, where 0 is the empty partition. Associativity follows from the fact that the coefficient of $u_{\lambda}$ in either $u_{\mu}\left(u_{\nu} u_{\rho}\right)$ or $\left(u_{\mu} u_{\nu}\right) u_{\rho}$ is just $G_{\mu \nu \rho}^{\lambda}$. Commutativity follows from (1.5), which shows that $G_{\mu \nu}^{\lambda}=G_{\nu \mu}^{\lambda}$.

The ring $H(\mathfrak{D})$ is the Hall algebra of $\mathfrak{o}$.
(2.3) The ring $H(\mathfrak{0})$ is generated (as $\mathbf{Z}$-algebra) by the elements $u_{\left(1^{\prime}\right)}(r \geqslant 1)$, and they are algebraically independent over $\mathbf{Z}$.

Proof. For convenience let us write $v_{r}$ in place of $u_{\left(1^{\prime}\right)}$, and for any partition $\lambda$ consider the product

$$
v_{\lambda^{\prime}}=v_{\lambda_{1}^{\prime}} v_{\lambda_{2}^{\prime}} \ldots v_{\lambda_{1}^{\prime}}
$$

where $\lambda^{\prime}=\left(\lambda_{1}^{\prime}, \ldots, \lambda_{s}^{\prime}\right)$ is as usual the conjugate of $\lambda$. This product $v_{\lambda^{\prime}}$ will be a linear combination of the $u_{\mu}$, say

$$
\begin{equation*}
v_{\lambda^{\prime}}=\sum_{\mu} a_{\lambda \mu} u_{\mu} \tag{1}
\end{equation*}
$$

in which the coefficient $a_{\lambda \mu}$ is by definition equal to the number of chains

$$
\begin{equation*}
M=M_{0} \supset M_{1} \supset \ldots \supset M_{s}=0 \tag{2}
\end{equation*}
$$

in a fixed finite $\mathfrak{0}$-module $M$ of type $\mu$, such that $M_{i-1} / M_{i}$ is of type ( $1^{x_{i}}$ ), i.e. elementary of length $\lambda_{i}^{\prime}$, for $1<i<s$. If such a chain (2) exists (that is, if $\left.a_{\lambda \mu} \neq 0\right)$ we must have $\mathfrak{p} M_{i-1} \subset M_{i}(1 \leqslant i \leqslant s)$ and therefore $\mathfrak{p}^{i} M \subset M_{i}$ for $1<i<s$. Hence

$$
l\left(M / p^{i} M\right) \geqslant l\left(M / M_{i}\right)
$$

which by virtue of (1.4) gives the inequality

$$
\mu_{1}^{\prime}+\ldots+\mu_{i}^{\prime} \geqslant \lambda_{1}^{\prime}+\ldots+\lambda_{i}^{\prime}
$$

for $1 \leqslant i \leqslant s$. Hence $\mu^{\prime} \geqslant \lambda^{\prime}$ and therefore by Chapter I, (1.11), $\mu \leqslant \lambda$. Moreover, the same reasoning shows that if $\mu=\lambda$ there is only one possible chain (2), namely $M_{i}=\mathfrak{p}^{i} M$.

Consequently we have $a_{\lambda \mu}=0$ unless $\mu \leqslant \lambda$, and $a_{\lambda \lambda}=1$. In other words, the matrix ( $a_{\lambda \mu}$ ) is strictly upper unitriangular (Chapter I, §6), and so the equations (1) can be solved to give the $u_{\mu}$ as integral linear combinations of the $v_{\lambda^{\prime}}$. Hence the $v_{\lambda^{\prime}}$ form a Z-basis of $H(\mathfrak{D})$, which proves (2.3).

From (2.3) it follows that the Hall algebra $H(\mathfrak{0})$ is isomorphic to the ring $\Lambda$ of symmetric functions (Chapter I). The obvious choice of isomorphism would be that which takes each $u_{\left(1^{r}\right)}$ to the $r$ th elementary symmetric function $e_{r}$; however, as we shall see in the next chapter, a more intelligent choice is to map $u_{\left(r^{\prime}\right)}$ to $q^{-r(r-1) / 2} e_{r}$, where $q$ is the number of elements in the residue field of $\mathfrak{v}$. Thus each generator $u_{\lambda}$ of $H(\mathfrak{p})$ is mapped to a symmetric function. We shall identify and study these symmetric functions in the next chapter; the remainder of the present chapter will be devoted to computing the structure constants $G_{\mu \nu}^{\lambda}(\mathfrak{D})$.

## 3. The $L R$-sequence of a submodule

Let $T$ be a tableau (Chapter I, §1) of shape $\lambda-\mu$ and weight $\nu=$ ( $\nu_{1}, \ldots, \nu_{r}$ ). Then $T$ determines (and is determined by) a sequence of partitions

$$
S=\left(\lambda^{(0)}, \lambda^{(1)}, \ldots, \lambda^{(r)}\right)
$$

such that $\lambda^{(0)}=\mu, \lambda^{(r)}=\lambda$, and $\lambda^{(i)} \supset \lambda^{(i-1)}$ for $1 \leqslant i \leqslant r$, by the condition that $\lambda^{(i)}-\lambda^{(i-1)}$ is the skew diagram consisting of the squares occupied by the symbol $i$ in $T$ (and hence is a horizontal strip, because $T$ is a tableau).

A sequence of partitions $S$ as above will be called a $L R$-sequence of type $(\mu, \nu ; \lambda)$ if
(LR1) $\lambda^{(0)}=\mu, \lambda^{(r)}=\lambda$, and $\lambda^{(i)} \supset \lambda^{(i-1)}$ for $1 \leqslant i \leqslant r$;
(LR2) $\lambda^{(i)}-\lambda^{(i-1)}$ is a horizontal strip of length $\nu_{i}$, for $1 \leqslant i \leqslant r$. (These two conditions ensure that $S$ determines a tableau $T$.)
(LR3) The word $w(T)$ obtained by reading $T$ from right to left in successive rows, starting at the top, is a lattice permutation (Chapter I, §9).

For (LR3) to be satisfied it is necessary and sufficient that, for $i \geqslant 1$ and $k \geqslant 0$, the number of symbols $i$ in the first $k$ rows of $T$ should be not less than the number of symbols $i+1$ in the first $k+1$ rows of $T$. In other words, a condition equivalent to (LR3) is

$$
\sum_{j=1}^{k}\left(\lambda_{j}^{(i)}-\lambda_{j}^{(i-1)}\right) \geqslant \sum_{j=1}^{k+1}\left(\lambda_{j}^{(i+1)}-\lambda_{j}^{(i)}\right)
$$

for all $i \geqslant 1$ and $k \geqslant 0$.
We shall show in this section that every submodule $N$ of a finite 0 -module $M$ gives rise to a $L R$-sequence of type ( $\mu^{\prime}, \nu^{\prime} ; \lambda^{\prime}$ ), where $\lambda, \mu, \nu$ are the types of $M, M / N$, and $N$ respectively. Before we come to the proof, a few lemmas are required. We do not need to assume in this section that the residue field of 0 is finite.
(3.1) Let $M$ be a finite 0 -module of type $\lambda$, and let $N$ be a submodule of type $\nu$ and cotype $\mu$ in $M$. Then $\mu \subset \lambda$ and $\nu \subset \lambda$.

Proof. Since

$$
\frac{\mathfrak{p}^{i-1}(M / N)}{\mathfrak{p}^{i}(M / N)} \cong \frac{\mathfrak{p}^{i-1} M+N}{\mathfrak{p}^{i} M+N} \cong \frac{\mathfrak{p}^{i-1} M}{\mathfrak{p}^{i-1} M \cap\left(\mathfrak{p}^{i} M+N\right)}
$$

and since also $\mathfrak{p}^{i-1} M \cap\left(\mathfrak{p}^{i} M+N\right) \supset \mathfrak{p}^{i} M$, it follows that

$$
l\left(\mathfrak{p}^{i-1}(M / N) / \mathfrak{p}^{i}(M / N)\right) \leqslant l\left(\mathfrak{p}^{i-1} M / \mathfrak{p}^{i} M\right)
$$

and hence that $\mu_{i}^{\prime} \leqslant \lambda_{i}^{\prime}$ by (1.4). Consequently $\mu \subset \lambda$. By duality (1.5), it follows that $\nu \subset \lambda$ also.

Let $M$ be an o-module of type $\lambda, N$ an elementary submodule of $M$. Then $\mathfrak{p} N=0$, so that $N \subset S$ where

$$
S=\{x \in M: \mathfrak{p} x=0\}
$$

is the socle of $M$, i.e. the unique largest elementary submodule of $M$.
(3.2) The type of $M / S$ is $\tilde{\lambda}=\left(\lambda_{1}-1, \lambda_{2}-1, \ldots\right)$.

Proof. If $M=\oplus \mathfrak{o} / \mathfrak{p}^{\lambda_{1}}$, then clearly $S=\oplus \mathfrak{p}^{\lambda_{1}-1} / \mathfrak{p}^{\lambda_{1}}$, whence $M / S \cong$ $\oplus \mathfrak{o} / \mathfrak{p}^{\lambda_{t}-1}$. |
(3.3) Let $M$ be a finite 0 -module of type $\lambda$, and $N$ an elementary submodule of $M$, of cotype $\mu$. Then $\lambda-\mu$ is a vertical strip (i.e. $\lambda_{i}-\mu_{i}=0$ or 1 for each $i$ ).

Proof. We have $N \subset S$, hence $M / S \cong(M / N) /(S / N)$, and therefore $\bar{\lambda} \subset$ $\mu \subset \lambda$ by (3.1) and (3.2). Hence

$$
0 \leqslant \lambda_{i}-\mu_{i} \leqslant \lambda_{i}-\tilde{\lambda}_{i}=1
$$

and therefore $\lambda-\mu$ is a vertical strip. |
Notice that if $\mu \subset \lambda$ then $\lambda-\mu$ is a vertical strip if and only if $\tilde{\lambda} \subset \mu$. (3.4) Let $M$ be a finite 0 -module of type $\lambda$, and let $N$ be a submodule of $M$, of type $\nu$ and cotype $\mu$. For each $i \geqslant 0$, let $\lambda^{(i)}$ be the cotype of $\mathfrak{p}^{i} N$. Then the sequence

$$
S(N)=\left(\lambda^{(0) \prime}, \lambda^{(1) \prime}, \ldots, \lambda^{(r) \prime}\right)
$$

(where $\mathfrak{p}^{\prime} N=0$ ) is an $L R$-sequence of type ( $\mu^{\prime}, \nu^{\prime} ; \lambda^{\prime}$ ).
Proof. Clearly $\lambda^{(0)}=\mu$ and $\lambda^{(r)}=\lambda$, and $\lambda^{(i)} \supset \lambda^{(i-1)}$ by (3.1) applied to the module $M / \mathfrak{p}^{i} N$ and the submodule $\mathfrak{p}^{i-1} N / \mathfrak{p}^{i} N$. Hence (LR1) is satisfied. Since $\mathfrak{p}^{i-1} N / \mathfrak{p}^{i} N$ is an elementary $\mathfrak{0}$-module, it follows from (3.3) that $\lambda^{(i)}-\lambda^{(i-1)}$ is a vertical strip, and hence that $\lambda^{(i) \prime}-\lambda^{(i-1) \prime}$ is a horizontal strip, of length equal to $l\left(p^{i-1} N / p^{i} N\right)=\nu_{i}^{\prime}$ (by (1.4)). Hence (LR2) is satisfied.

As to (LR3'), we have

$$
\lambda_{j}^{(i) \prime}=l\left(\mathfrak{p}^{j-1}\left(M / \mathfrak{p}^{i} N\right) / \mathfrak{p}^{j}\left(M / p^{i} N\right)\right)
$$

(again by (1.4)), so that

$$
\sum_{j=1}^{k} \lambda_{j}^{(i) \prime}=l\left(\left(M / p^{i} N\right) / p^{k}\left(M / p^{i} N\right)\right)=l\left(M /\left(\mathfrak{p}^{k} M+\mathfrak{p}^{i} N\right)\right)
$$

and therefore

$$
\sum_{j=1}^{k}\left(\lambda_{j}^{(i) \prime}-\lambda_{j}^{(i-1) \prime}\right)=l\left(V_{k i}\right)
$$

where $V_{k i}=\left(\mathfrak{p}^{k} M+\mathfrak{p}^{i-1} N\right) /\left(\mathfrak{p}^{k} M+\mathfrak{p}^{i} N\right)$. Likewise

$$
\sum_{j=1}^{k+1}\left(\lambda_{j}^{(i+1) \prime}-\lambda_{j}^{(i) \prime}\right)=l\left(V_{k+1, i+1}\right)
$$

Since multiplication by a generator of $\mathfrak{p}$ induces a homomorphism of $V_{k i}$ onto $V_{k+1, i+1}$, it follows that $l\left(V_{k i}\right) \geqslant l\left(V_{k+1, i+1}\right)$, and hence (LR3') is satisfied.

## Example

Let $V$ be an $n$-dimensional vector space over an algebraically closed field $k$. A flag in $V$ is a sequence $F=\left(V_{0}, V_{1}, \ldots, V_{n}\right)$ of subspaces of $V$, such that $0=V_{0} \subset V_{1} \subset$ ... $\subset V_{n}=V$ and $\operatorname{dim} V_{i}=i$ for $0 \leqslant i \leqslant n$. Let $X$ denote the set of all flags in $V$. The group $G=G L(V)$ acts transitively on $X$, so that $X$ may be identified with $G / B$, where $B$ is the subgroup which fixes a given flag, and therefore $X$ is a (non-singular projective) algebraic variety, the flag manifold of $V$.
Now let $u \in G$ be a unipotent endomorphism of $V$. Then as in (1.2) $V$ becomes a $k[t]$-module of finite length, with $t$ acting on $V$ as the nilpotent endomorphism $u-1$. Let $\lambda$ be the type of $V$, so that $\lambda$ is a partition of $n$ which describes the Jordan canonical form of $u$, and let $X_{\lambda} \subset X$ be the set of all flags $F \in X$ fixed by $u$. These flags $F$ are the composition series of the $k[t]$-module $V$. The set $X_{\lambda}$ is a closed subvariety of $X$.
For each $F=\left(V_{0}, V_{1}, \ldots, V_{n}\right) \in X_{\lambda}$, let $\lambda^{(i)}$ be the cotype of the submodule $V_{n-i}$ of $V$. Then by (3.1) we have

$$
0=\lambda^{(0)} \subset \lambda^{(1)} \subset \ldots \subset \lambda^{(n)}=\lambda
$$

and $\left|\lambda^{(i)}-\lambda^{(i-1}\right|=1$ for $1 \leqslant i \leqslant n$, so that $F$ determines in this way a standard tableau of $T$ of shape $\lambda$. Hence we have a partition of $X_{\lambda}$ into subsets $X_{T}$ indexed by the standard tableaux $T$ of shape $\lambda$.
These subsets $X_{T}$ have the following properties (Spaltenstein [S16]):
(a) $X_{T}$ is a smooth irreducible locally closed subvariety of $X_{\lambda}$.
(b) $\operatorname{dim} X_{T}=n(\lambda)$.
(c) $X_{T}$ is a disjoint union $\cup_{j=1}^{m} X_{T, j}$ such that each $X_{T, j}$ is isomorphic to an affine space and $U_{k<j} X_{T, k}$ is closed in $X_{T}$, for $j=1,2, \ldots, m$.
From these results it follows that the closures $\bar{X}_{T}$ of the $X_{T}$ are the irreducible components of $X_{\lambda}$, and all have the same dimension $n(\lambda)$. The number of irreducible components is therefore equal to the degree of the irreducible character $\chi^{\lambda}$ of $S_{n}$ (Chapter I, §7).
If $k$ contains the finite field $\mathbf{F}_{q}$ of $q$ elements, the number $X_{\lambda}(q)$ of $\mathbf{F}_{q}$-rational points of $X_{\lambda}$ is equal to $Q_{\left(1^{n}\right)}^{\lambda}(q)$ (Chapter III, §7).
More general results concerning the partial flags may be found in [H8], [S14].

## 4. The Hall polynomial

In this section we shall compute the structure constants $G_{\mu \nu}^{\lambda}(\mathcal{D})$ of the Hall algebra. (The residue field of o is assumed to be finite, as in §2.) Let $S$ be an $L R$-sequence of type ( $\mu^{\prime}, \nu^{\prime} ; \lambda^{\prime}$ ), and let $M$ be a finite 0 -module of type $\lambda$. Denote by $G_{S}(0)$ the number of submodules $N$ of $M$ whose
associated $L R$-sequence $S(N)$ is $S$. By (3.4), each such $N$ has type $\nu$ and cotype $\mu$.

Let $q$ denote the number of elements in the residue field of $\mathfrak{o}$, and recall that $n(\lambda)=\Sigma(i-1) \lambda_{i}$, for any partition $\lambda$. Then:
(4.1) For each $L R$-sequence $S$ of type ( $\mu^{\prime}, \nu^{\prime} ; \lambda^{\prime}$ ), there exists a monic polynomial $g_{S}(t) \in \mathbf{Z}[t]$ of degree $n(\lambda)-n(\mu)-n(\nu)$, independent of 0 , such that

$$
g_{S}(q)=G_{S}(\mathfrak{p})
$$

(In other words, $G_{S}(0)$ is a 'polynomial in $q$ '.)
Now define, for any three partitions $\lambda, \mu, \nu$

$$
\begin{equation*}
g_{\mu \nu}^{\lambda}(t)=\sum_{S} g_{S}(t) \tag{4.2}
\end{equation*}
$$

summed over all $L R$-sequences $S$ of type ( $\mu^{\prime}, \nu^{\prime} ; \lambda^{\prime}$ ). This polynomial is the Hall polynomial corresponding to $\lambda, \mu, \nu$. Recall from Chapter I ( $\$ \xi 5$ and 9) that $c_{\mu \nu}^{\lambda}$ denotes the coefficient of the Schur function $s_{\lambda}$ in the product $s_{\mu} s_{\nu}$; that $c_{\mu \nu}^{\lambda}=c_{\mu^{\prime} \nu^{\prime}}^{\lambda^{\prime}}$; and that $c_{\mu^{\prime} \nu^{\prime}}^{\lambda^{\prime}}$ is the number of $L R$-sequences of type ( $\mu^{\prime}, \nu^{\prime} ; \lambda^{\prime}$ ). Then from (4.1) it follows that
(4.3) (i) If $c_{\mu \nu}^{\lambda}=0$, the Hall polynomial $g_{\mu \nu}^{\lambda}(t)$ is identically zero. (In particular, $g_{\mu \nu}^{\lambda}(t)=0$ unless $|\lambda|=|\mu|+|\nu|$ and $\mu, \nu \subset \lambda$.)
(ii) If $c_{\mu \nu}^{\lambda} \neq 0$, then $g_{\mu \nu}^{\lambda}(t)$ has degree $n(\lambda)-n(\mu)-n(\nu)$ and leading coeffcient $c_{\mu \nu}^{\lambda}$.
(iii) In either case, $G_{\mu \nu}^{\lambda}(\mathfrak{D})=g_{\mu \nu}^{\lambda}(q)$.
(iv) $g_{\mu \nu}^{\lambda}(t)=g_{\nu \mu}^{\lambda}(t)$.

The only point that requires comment is (iv). From (2.2) we have $G_{\mu \nu}^{\lambda}(\mathfrak{o})=G_{\nu \mu}^{\lambda}(\mathfrak{o})$ for all $\mathfrak{o}$, hence $g_{\mu \nu}^{\lambda}(q)=g_{\nu \mu}^{\lambda}(q)$ for all prime-powers $q$, and so $g_{\mu \nu}^{\lambda}(t)=g_{\nu \mu}^{\lambda}(t)$. I

The starting point of the proof of (4.1) is the following proposition:
(4.4) Let $M$ be a finite o-module of type $\lambda$ and let $N$ be an elementary submodule of cotype $\alpha$ in $M$ (so that $\lambda-\alpha$ is a vertical strip, by (3.3)). Let $\beta$ be a partition such that $\alpha \subset \beta \subset \lambda$ and let $H_{\alpha \beta \lambda}(\mathfrak{D})$ denote the number of submodules $P \subset N$ of cotype $\beta$ in $M$. Then

$$
H_{\alpha \beta \lambda}(\mathfrak{D})=h_{\alpha \beta \lambda}(q)
$$

where $h_{\alpha \beta \lambda}(t) \in \mathbf{Z}[t]$ is the polynomial

$$
\begin{equation*}
h_{\alpha \beta \lambda}(t)=t^{d(\alpha, \beta, \lambda)} \prod_{i>1}\left[\lambda_{i}^{\prime}-\beta_{i}^{\prime}, \beta_{i}^{\prime}-\alpha_{i}^{\prime}\right]\left(t^{-1}\right), \tag{4.4.1}
\end{equation*}
$$

in which

$$
\begin{equation*}
d(\alpha, \beta, \lambda)=\sum_{r<s}\left(\beta_{r}-\alpha_{r}\right)\left(\lambda_{s}-\beta_{s}\right) \tag{4.4.2}
\end{equation*}
$$

and $[r, s]$ is the Gaussian polynomial $\left[\begin{array}{c}r+s \\ r\end{array}\right]$ (Chapter I, §2, Example 1) if $r, s \geqslant 0$, and is zero otherwise.

Proof. Let $\theta=\lambda-\beta, \varphi=\beta-\alpha$. Also let $N_{i}=N \cap \mathfrak{p}^{i} M$. Since

$$
\mathfrak{p}^{i} M / N_{i} \cong\left(\mathfrak{p}^{i} M+N\right) / N \cong \mathfrak{p}^{i}(M / N)
$$

we have

$$
\begin{aligned}
l\left(N_{i}\right) & =l\left(\mathfrak{p}^{i} M\right)-l\left(\mathfrak{p}^{i}(M / N)\right) \\
& =\sum_{j>i}\left(\lambda_{j}^{\prime}-\alpha_{j}^{\prime}\right)
\end{aligned}
$$

by (1.4), or equivalently

$$
\begin{equation*}
n_{i}=l\left(N_{i}\right)=\sum_{j>i}\left(\theta_{j}^{\prime}+\varphi_{j}^{\prime}\right) \tag{1}
\end{equation*}
$$

Now let $P$ be a submodule of $N$, of cotype $\beta$ in $M$, and let $P_{i}=$ $P \cap p^{i} M=P \cap N_{i}$. Then

$$
P / P_{i} \cong\left(P+\mathfrak{p}^{i} M\right) / p^{i} M
$$

and therefore

$$
\begin{aligned}
l\left(P_{i-1}\right)-l\left(P_{i}\right) & =l\left(P / P_{i}\right)-l\left(P / P_{i-1}\right) \\
& =l\left(\left(P+\mathfrak{p}^{i} M\right) / \mathfrak{p}^{i} M\right)-l\left(\left(P+\mathfrak{p}^{i-1} M\right) / \mathfrak{p}^{i-1} M\right) \\
& =l\left(\mathfrak{p}^{i-1} M / \mathfrak{p}^{i} M\right)-l\left(\left(P+\mathfrak{p}^{i-1} M\right) /\left(P+\mathfrak{p}^{i} M\right)\right) \\
& =\lambda_{i}^{\prime}-\beta_{i}^{\prime}=\theta_{i}^{\prime}
\end{aligned}
$$

by (1.4). Conversely, if $P$ is a submodule of $N$ such that

$$
\begin{equation*}
l\left(P_{i-1} / P_{i}\right)=\theta_{i}^{\prime} \quad(i \geqslant 1) \tag{2}
\end{equation*}
$$

then the preceding calculation shows that $P$ has cotype $\beta$ in $M$.
Suppose that $i \geqslant 1$ and $P_{i}$ are given. We ask for the number of submodules $P_{i-1}$ of $N_{i-1}$ which satisfy (2) and

$$
\begin{equation*}
P_{i-1} \cap N_{i}=P_{i} \tag{3}
\end{equation*}
$$

The number of sequences $x=\left(x_{1}, \ldots, x_{\theta_{i}}\right)$ in $N_{i-1}$ which are linearly independent modulo $N_{i}$ is

$$
\begin{equation*}
\left(q^{n_{i-1}}-q^{n_{i}}\right)\left(q^{n_{i-1}}-q^{n_{l}+1}\right) \ldots\left(q^{n_{i-1}}-q^{n_{l}+\theta_{i}-1}\right) . \tag{4}
\end{equation*}
$$

For each such sequence $x$, the submodule $P_{i-1}$ generated by $P_{i}$ and $x$ satisfies (2) and (3). Conversely, any such $P_{i-1}$ can be obtained in this way from any sequence $x$ of $\theta_{i}^{\prime}$ elements of $P_{i-1}$ which are linearly independent modulo $P_{i}$. The number of such sequences is

$$
\begin{equation*}
\left(q^{p_{l-1}}-q^{p_{i}}\right)\left(q^{p_{i-1}}-q^{p_{i}+1}\right) \ldots\left(q^{p_{i-1}}-q^{p_{i}+\theta_{i}-1}\right) \tag{5}
\end{equation*}
$$

where

$$
\begin{equation*}
p_{i}=l\left(P_{i}\right)=\sum_{j>i} \theta_{j}^{\prime} \tag{6}
\end{equation*}
$$

by virtue of (2). So the number of submodules $P_{i-1}$ of $N_{i-1}$ which satisfy (2) and (3) is the quotient of (4) by (5), namely

$$
q^{\theta_{i}^{\prime}\left(n_{i-1}-p_{i-1}\right)}\left[\theta_{i}^{\prime}, \varphi_{i}^{\prime}\right]\left(q^{-1}\right)
$$

Taking the product of these for all $i \geqslant 1$, and observing that $n_{i-1}-p_{i-1}=$ $\Sigma_{j>i} \varphi_{j}^{\prime}$ (from (1) and (6)) we obtain

$$
H_{\alpha \beta \lambda}(\mathfrak{o})=q^{d} \prod_{i>1}\left[\lambda_{i}^{\prime}-\beta_{i}^{\prime}, \beta_{i}^{\prime}-\alpha_{i}^{\prime}\right]\left(q^{-1}\right)
$$

where

$$
d=\sum_{i<j} \theta_{i}^{\prime} \varphi_{j}^{\prime}
$$

Now $\theta_{i}^{\prime}$ is the number of squares of the skew diagram $\theta=\lambda-\beta$ in the $i$ th column, and $\Sigma_{j>i} \varphi_{j}^{\prime}$ is the number of squares of $\varphi=\beta-\alpha$ in the same or later colums, hence in higher rows. It follows that

$$
d=\sum_{r<s} \varphi_{r} \theta_{s}=d(\alpha, \beta, \lambda)
$$

which completes the proof of (4.4).

Suppose in particular that $N$ in (4.4) is the socle $S$ of $M$, so that $\alpha=\tilde{\lambda}$ by (3.2). Then $H_{\bar{\lambda} \beta \lambda}(0)$ is the number of elementary submodules $P$ of cotype $\beta$ in $M$, so that

$$
H_{\bar{\lambda} \beta \lambda}(\mathfrak{D})=G_{\beta\left(1^{m}\right)}^{\lambda}(\mathfrak{D})
$$

where $m=|\lambda-\beta|=|\theta|$. In this case we have $\varphi=\beta-\tilde{\lambda}$, so that $\varphi_{i}=$ $\beta_{i}-\lambda_{i}+1=1-\theta_{i}$, and the exponent $d=d(\tilde{\lambda}, \beta, \lambda)$ is therefore

$$
\begin{aligned}
d & =\sum_{r<s}\left(1-\theta_{r}\right) \theta_{s} \\
& =\sum_{r<s}\left(1-\theta_{r}\right) \theta_{s}=\sum_{r<s} \theta_{s}-\sum_{r<s} \theta_{r} \theta_{s} .
\end{aligned}
$$

because $\theta_{r}=\theta_{r}^{2}$ for all $r$. Since $\sum \theta_{r}=m$ we have

$$
\begin{equation*}
\sum_{r<s} \theta_{r} \theta_{s}=\frac{1}{2} m^{2}-\frac{1}{2} \sum \theta_{r}^{2}=\frac{1}{2} m(m-1) \tag{4.5}
\end{equation*}
$$

and hence

$$
d=\sum(s-1) \theta_{s}-\frac{1}{2} m(m-1)=n(\lambda)-n(\beta)-n\left(1^{m}\right) .
$$

So from (4.4) we have the formula

$$
G_{\beta\left(1^{m}\right)}^{\lambda}(\mathfrak{0})=q^{n(\lambda)-n(\beta)-n\left(1^{m}\right)} \prod_{i>1}\left[\lambda_{i}^{\prime}-\beta_{i}^{\prime}, \beta_{i}^{\prime}-\lambda_{i+1}^{\prime}\right]\left(q^{-1}\right)
$$

(because $\tilde{\lambda}_{i}^{\prime}=\lambda_{i+1}^{\prime}$ for all $i \geqslant 1$ ). This is valid for any partitions $\lambda, \beta$, where $m=|\lambda|-|\beta|$. (If $\lambda-\beta$ is not a vertical strip, both sides are zero.)
Equivalently, if we define

$$
\begin{equation*}
g_{\beta\left(1^{m}\right)}^{\lambda}(t)=t^{n(\lambda)-n(\beta)-n\left(1^{m}\right)} \prod_{i>1}\left[\lambda_{i}^{\prime}-\beta_{i}^{\prime}, \beta_{i}^{\prime}-\lambda_{i+1}^{\prime}\right]\left(t^{-1}\right) \tag{4.6}
\end{equation*}
$$

then we have $g_{\beta\left(1^{m}\right)}^{\lambda}(q)=G_{\beta\left(1^{m}\right)}^{\lambda}(\mathfrak{D})$.
The next stage in the proof of (4.1) is
(4.7) Let $R=\left(\alpha^{\prime}, \beta^{\prime}, \lambda^{\prime}\right)$ be a three-term $L R$-sequence. Then there exists a monic polynomial $F_{R}(t) \in \mathbf{Z}[t]$, depending only on $R$, of degree $n(\beta)-$ $n(\alpha)-\binom{n}{2}$ where $n=|\beta-\alpha|$, with the following property: if $M$ is a finite 0 -module of type $\lambda$, and $P$ is an elementary submodule of cotype $\beta$ in $M$, then the number of submodules $N$ of cotype $\alpha$ in $M$ such that $\mathfrak{p} N=P$ is equal to $F_{R}(q)$.
(Observe that when $\beta=\lambda$ (so that $\lambda-\alpha$ is a vertical strip) we have $P=0$, so that $N$ is elementary and therefore $F_{R}(t)=g_{\alpha\left(1^{n}\right)}^{\lambda}(t)$ in this case.)

Proof. Let $Q$ be a submodule of $P$, and let $\gamma$ be the cotype of $Q$ in $M$, so that we have $\alpha \subset \beta \subset \gamma \subset \lambda$.

Let $f(P, Q)$ (resp. $g(P, Q)$ ) denote the number of submodules $N$ of cotype $\alpha$ in $M$ such that $N \supset P \supset Q \supset \mathfrak{p} N$ (resp. $N \supset P \supset Q=\mathfrak{p} N$ ). The number we want to calculate is $g(P, P)$. Now $f(P, Q)$ is easily obtained, as we shall see in a moment, and then $g(P, Q)$ can be obtained by Möbius inversion [R8].

First of all let us calculate $f(P, Q)$. We have

$$
\begin{aligned}
N \supset P \supset Q \supset \mathfrak{p} N & \Leftrightarrow N \supset P \text { and } N / Q \text { is elementary } \\
& \Leftrightarrow S \supset N \supset P, \quad \text { where } S / Q \text { is the socle of } M / Q \\
& \Leftrightarrow N / P \subset S / P .
\end{aligned}
$$

By (3.2) $S$ has cotype $\tilde{\gamma}$ in $M$, and so by (4.4) (applied to the module $M / P$ and its elementary submodule $S / P$ ) we have

$$
\begin{equation*}
f(P, Q)=H_{\tilde{\gamma} \alpha \beta}(\mathfrak{D}) \tag{i}
\end{equation*}
$$

if $\tilde{\gamma} \subset \alpha$, i.e. if $\gamma-\alpha$ is a vertical strip, and $f(P, Q)=0$ otherwise.
Now it is clear that
(ii)

$$
f(P, Q)=\sum_{R \subset Q} g(P, R)
$$

summed over all submodules (i.e. vector subspaces) $R$ of $Q$. The equations (ii) for fixed $P$ and varying $Q \subset P$ can be solved by Möbius inversion: the solution is

$$
g(P, Q)=\sum_{R \subset Q} f(P, R) \mu(R, Q)
$$

where $\mu$ is the Möbius function on the lattice of subspaces of the vector space $P$, which (loc. cit.) is given by

$$
\mu(R, Q)=(-1)^{d} q^{d(d-1) / 2}
$$

where $d=\operatorname{dim}_{k}(Q / R)$. Hence in particular we have

$$
\begin{equation*}
g(P, P)=\sum_{R \subset P}(-1)^{m} q^{m(m-1) / 2} f(P, R) \tag{iii}
\end{equation*}
$$

where $m=\operatorname{dim}_{k}(P / R)$ and the summation is over all subspaces $R$ of $P$.

Now for each partition $\delta$ such that $\beta \subset \delta \subset \lambda$, the number of $R \subset P$ of cotype $\delta$ in $M$ is $H_{\beta \delta \lambda}(\mathfrak{D})$. Hence from (i) and (iii) it follows that

$$
\begin{equation*}
g(P, P)=\sum_{\delta}(-1)^{m} q^{m(m-1) / 2} H_{\beta \delta \lambda}(\mathfrak{D}) H_{\tilde{\delta} \alpha \beta}(\mathfrak{D}) \tag{iv}
\end{equation*}
$$

where the sum is over all $\delta$ such that $\beta \subset \delta \subset \lambda$ and such that $\delta-\alpha$ is a vertical strip, and $m=|\delta-\beta|$. So if we define the polynomial $F_{R}(t)$ by

$$
\begin{equation*}
F_{R}(t)=\sum_{\delta}(-1)^{m} t^{m(m-1) / 2} h_{\beta \delta \lambda}(t) h_{\tilde{\delta} \alpha \beta}(t) \tag{4.8}
\end{equation*}
$$

summed over partitions $\delta$ as above, then it follows from (iv) and (4.4) that $g(P, P)=F_{R}(q)$.

To complete the proof it remains to be shown that this polynomial $F_{R}(t)$ is monic of degree $n(\beta)-n(\alpha)-\binom{n}{2}$, where $n=|\beta-\alpha|$.
The degree of the summand corresponding to $\delta$ in (4.8) is by (4.4.2) equal to

$$
d=\frac{1}{2} m(m-1)+\sum_{r \leqslant s}\left(\varphi_{r} \psi_{s}+\left(1-\theta_{r}-\varphi_{r}\right) \theta_{s}\right)
$$

where $\theta=\beta-\alpha, \varphi=\delta-\beta$ and $\psi=\lambda-\delta$, and $m=|\varphi|$. Each of $\theta, \varphi, \psi$ is a vertical strip, so that each $\theta_{r}, \varphi_{r}$, and $\psi_{r}$ is 0 or 1 : in particular we have $\frac{1}{2} m(m-1)=\sum_{r \leqslant s} \varphi_{r} \varphi_{s}-m$ by (4.5), so that

$$
\begin{equation*}
d=\sum_{r \leqslant s} \varphi_{r}\left(\varphi_{s}+\psi_{s}-\theta_{s}\right)+\sum_{r \leqslant s}\left(1-\theta_{r}\right) \theta_{s}-|\varphi| . \tag{v}
\end{equation*}
$$

Now ( $\alpha^{\prime}, \beta^{\prime}, \lambda^{\prime}$ ) is an $L R$-sequence. This implies that, for each $r \geqslant 1$, the number of squares of $\beta^{\prime}-\alpha^{\prime}=\theta^{\prime}$ in the columns with indices $\geqslant r$ is not less than the number of squares of $\lambda^{\prime}-\beta^{\prime}$ in the same columns: that is to say, we have

$$
\begin{equation*}
\sum_{s \geqslant r} \theta_{s} \geqslant \sum_{s \geqslant r}\left(\varphi_{s}+\psi_{s}\right) \tag{vi}
\end{equation*}
$$

for each $r \geqslant 1$. From (v) and (vi) it follows that

$$
d \leqslant \sum_{r \ll s}\left(1-\theta_{r}\right) \theta_{s}
$$

with equality if and only if $\varphi=0$, i.e. if and only if $\delta=\beta$. Hence the dominant term of the sum (4.8) is $h_{\tilde{\beta} \alpha \beta}(t)=g_{\alpha\left(1^{n}\right)}^{\beta}(t)$, which by (4.6) is monic of degree $n(\beta)-n(\alpha)-\binom{n}{2}$. This completes the proof. I

The proof of (4.1) can now be rapidly completed. Let $M$ be an 0 -module of type $\lambda$, and let $S=\left(\lambda^{(0) \prime}, \ldots, \lambda^{(r) \prime}\right)$ be an $L R$-sequence of type ( $\mu^{\prime}, \nu^{\prime} ; \lambda^{\prime}$ ). Let $N$ be a submodule of $M$ such that $S(N)=S$, and let
$N_{1}=\mathfrak{p} N$. Then clearly $S\left(N_{1}\right)=\left(\lambda^{(1) \prime}, \ldots, \lambda^{(r) \prime}\right)=S_{1}$ say. Conversely, if we are given a submodule $N_{1}$ of $M$ such that $S\left(N_{1}\right)=S_{1}$, the number of submodules $N$ such that $S(N)=S$ and $\mathfrak{p} N=N_{1}$ is equal to $F_{R_{1}}(q)$, where $R_{1}=\left(\lambda^{(0)}, \lambda^{(1) \prime}, \lambda^{(2) \prime}\right)$, as we see by (4.7) applied to the module $M / p N_{1}$ and its elementary submodule $N_{1} / \mathfrak{p} N_{1}$. Consequently

$$
G_{S}(\mathfrak{p})=G_{S_{1}}(\mathfrak{p}) \cdot F_{R_{1}}(q)
$$

and therefore

$$
G_{S}(\mathfrak{0})=\prod_{i=1}^{r} F_{R_{i}}(q)
$$

where $R_{i}=\left(\lambda^{(i-1) \prime}, \lambda^{(i) \prime}, \lambda^{(i+1) \prime}\right)$. (When $i=r$ we take $\lambda^{(r+1) \prime}=\lambda^{(r) \prime}$, so that as remarked earlier $F_{R}(q)=g_{\alpha\left(1^{m}\right)}^{\lambda}(q)$, where $\alpha=\lambda^{(r-1) \prime}$ and $m=$ $|\lambda-\alpha|$.)

Hence if we define

$$
\begin{equation*}
g_{S}(t)=\prod_{i=1}^{r} F_{R_{t}}(t) \tag{4.9}
\end{equation*}
$$

we have $g_{s}(q)=G_{S}(\mathfrak{0})$, and by (4.7) the polynomial $g_{s}(t)$ is monic of degree

$$
\sum_{i=1}^{r}\left(n\left(\lambda^{(i)}\right)-n\left(\lambda^{(i-1)}\right)-\binom{\nu_{i}^{\prime}}{2}\right)=n(\lambda)-n(\mu)-n(\nu) \text {. Q.E.D. }
$$

The proof just given provides an explicit (if complicated) expression for $g_{\mu \nu}^{\lambda}(t)$, via the formulas (4.2), (4.4), (4.8), and (4.9). If $a, b, c, N$ are non-negative integers such that $b \leqslant c$, let us define

$$
\Phi(a, b, c ; N ; t)=\sum_{r>0}(-1)^{r} t^{N r+r(r+1) / 2}\left[\begin{array}{l}
a  \tag{4.10}\\
r
\end{array}\right]\left[\begin{array}{l}
c-r \\
b-r
\end{array}\right]
$$

where $\left[\begin{array}{l}a \\ r\end{array}\right]$ and $\left[\begin{array}{l}c-r \\ b-r\end{array}\right]$ are Gaussian polynomials in $t$. (The sum on the right of (4.10) is finite, since the term written is zero as soon as $r>$ $\min (a, b)$.

With this notation we have
(4.11) Let $S=\left(\alpha^{(0)}, \alpha^{(1)}, \ldots, \alpha^{(r)}\right)$ be an LR-sequence of type ( $\left.\mu^{\prime}, \nu^{\prime} ; \lambda^{\prime}\right)$. Then

$$
g_{S}(t)=t^{n(\lambda)-n(\mu)-n(\nu)} \prod_{i>j>1} \Phi\left(a_{i j}, b_{i j}, c_{i j} ; N_{i j} ; t^{-1}\right)
$$

where

$$
\begin{array}{ll}
a_{i j}=\alpha_{i+1}^{(j+1)}-\alpha_{i+1}^{(j)}, & b_{i j}=\alpha_{i}^{(j-1)}-\alpha_{i+1}^{(j)}, \\
c_{i j}=\alpha_{i}^{(j)}-\alpha_{i+1}^{(j)}, & N_{i j}=\sum_{h<i}\left(a_{h-1, j-1}-a_{h, j}\right) .
\end{array}
$$

(Thus $a_{i j}$ is the number of symbols $j+1$ in the $(i+1)$ th row of the tableau defined by $S ; c_{i j}$ is the number of columns of $\alpha^{(j)}$ of length $i$, and $c_{i j}-b_{i j}=a_{i-1, j-1}$ is the number of $j$ 's in the $i$ th row of $S$. Finally, $N_{i j}$ is the excess of the number of $j$ 's in the first $i$ rows of $S$ over the number of $(j+1)$ 's in the first $i+1$ rows, and hence is $\geqslant 0$ by virtue of the lattice permutation property.)

Proof. With the notation of (4.7) let $R=\left(\alpha^{\prime}, \beta^{\prime}, \lambda^{\prime}\right)$ be a three-term $L R$-sequence, and let

$$
a_{i}=\lambda_{i+1}^{\prime}-\beta_{i+1}^{\prime}, \quad b_{i}=\alpha_{i}^{\prime}-\beta_{i+1}^{\prime}, \quad c_{i}=\beta_{i}^{\prime}-\beta_{i+1}^{\prime}
$$

As in (4.8) let $\delta$ be a partition such that $\tilde{\delta} \subset \alpha \subset \beta \subset \delta \subset \lambda$, where $\tilde{\delta}_{i}^{\prime}=\delta_{i+1}^{\prime}$ for all $i \geqslant 1$, and let $r_{i}=\delta_{i+1}^{\prime}-\beta_{i+1}^{\prime}$, so that $m=|\delta-\beta|=\sum r_{i}$. (Since $R$ is an $L R$-sequence we have $\beta_{1}^{\prime}=\delta_{1}^{\prime}=\lambda_{1}^{\prime}$, so that $a_{0}=r_{0}=0$; also $0 \leqslant r_{i} \leqslant a_{i}$ $\leqslant c_{i}$ and $0 \leqslant r_{i} \leqslant b_{i} \leqslant c_{i}$.)
We shall use (4.8) to calculate $F_{R}(t)$. From (4.4) we have

$$
t^{m(m-1) / 2} h_{\beta \delta \lambda}(t) h_{\tilde{\delta} \alpha \beta}(t)=t^{A} \prod_{i>1}\left[\begin{array}{l}
a_{i}  \tag{1}\\
r_{i}
\end{array}\right]\left(t^{-1}\right)\left[\begin{array}{l}
c_{i}-r_{i} \\
b_{i}-r_{i}
\end{array}\right]\left(t^{-1}\right),
$$

in which the exponent of $t$ is

$$
\begin{align*}
A & =\frac{1}{2}\left(\sum r_{j}\right)^{2}-\frac{1}{2} \sum r_{j}+\sum_{i<j}\left(\left(a_{i}-r_{i}\right) r_{j}+\left(c_{i}-b_{i}\right)\left(b_{j}-r_{j}\right)\right)  \tag{2}\\
& =-\frac{1}{2} \sum r_{j}\left(r_{j}+1\right)-\sum N_{j} r_{j}+\sum_{i<j}\left(c_{i}-b_{i}\right) b_{j}
\end{align*}
$$

where $N_{j}=\Sigma_{i<j}\left(c_{i}-a_{i}-b_{i}\right)$. Moreover,

$$
\sum_{i<j}\left(c_{i}-b_{i}\right) b_{j}=\sum_{i<j}\left(\beta_{i}^{\prime}-\alpha_{i}^{\prime}\right)\left(\alpha_{j}^{\prime}-\beta_{j+1}^{\prime}\right)
$$

which reduces to

$$
\begin{equation*}
n(\beta)-n(\alpha)-\frac{1}{2} s(s-1) \tag{3}
\end{equation*}
$$

where $s=|\beta-\alpha|$.

From (1), (2), (3), and (4.8) we obtain

$$
\begin{equation*}
F_{R}(t)=t^{n(\beta)-n(\alpha)-s(s-1) / 2} \prod_{i>1} \Phi\left(a_{i}, b_{i}, c_{i} ; N_{i} ; t^{-1}\right) \tag{4}
\end{equation*}
$$

Since by (4.9)

$$
g_{s}(t)=\prod_{j=1}^{r} F_{R_{J}}(t)
$$

where $R_{j}=\left(\alpha^{(j-1)}, \alpha^{(j)}, \alpha^{(j+1)}\right)$, the formula (4) leads directly to (4.11). (Since $(j+1)$ 's appear for the first time in the $(j+1)$ th row of $S$, it follows that $a_{i j}=0$ if $i<j$, whence the restriction $i \geqslant j$ in the product on the right-hand side of (4.11).

As an example (which we shall make use of later) we shall compute $g_{\mu \nu}^{\lambda}(t)$ when $\nu=(r)$ is a partition with only one part $r=|\lambda-\mu|$. (The case when $\nu=\left(1^{r}\right)$ is given by (4.6).) First we have

## (4.12) $g_{\mu(r)}^{\lambda}(t)=0$ unless $\lambda-\mu$ is a horizontal strip of length $r$.

Proof. Let $M$ be a finite 0 -module of type $\lambda$, and let $N$ be a cyclic submodule of cotype $\mu$ in $M$. Let $N_{i}=N \cap \mathfrak{p}^{i} M$. Then since $\mathfrak{p}^{i} M / N_{i} \cong$ $\left(\mathfrak{p}^{i} M+N\right) / N \cong \mathfrak{p}^{i}(M / N)$ we have

$$
l\left(N_{i-1} / N_{i}\right)=\lambda_{i}^{\prime}-\mu_{i}^{\prime}
$$

and since $\mathfrak{p} N_{i-1}=\mathfrak{p}\left(N \cap \mathfrak{p}^{i-1} M\right) \subset N \cap \mathfrak{p}^{i} M=N_{i}$, it follows that

$$
0 \leqslant \lambda_{i}^{\prime}-\mu_{i}^{\prime} \leqslant l\left(N_{i-1} / p N_{i-1}\right) .
$$

Since $N$ is cyclic, so is $N_{i}$, and hence $l\left(N_{i-1} / \mathfrak{p} N_{i-1}\right) \leqslant 1$. Hence $\lambda_{i}^{\prime}-\mu_{i}^{\prime}=0$ or 1 for each $i \geqslant 1$, and therefore $\lambda-\mu$ is a horizontal strip. So unless $\lambda-\mu$ is a horizontal strip we have $g_{\mu(r)}^{\lambda}(q)=0$ for all prime-powers $q$, and therefore $g_{\mu(r)}^{\lambda}(t)=0$. |

Remark. Alternatively (and more rapidly) (4.12) follows from (4.3): we have $g_{\mu(r)}^{\lambda}(t)=0$ unless $c_{\mu(r)}^{\lambda} \neq 0$, i.e. unless $s_{\lambda}$ occurs in the product $s_{\mu} h_{r}$, which by Chapter I, (5.16) requires $\lambda-\mu$ to be a horizontal strip.

Assume then that $\lambda-\mu$ is a horizontal $r$-strip. Then $\lambda^{\prime}-\mu^{\prime}$ is a vertical $r$-strip, and there is only one $L R$-sequence $S=\left(\alpha^{(0)}, \alpha^{(1)}, \ldots, \alpha^{(r)}\right)$ of type ( $\mu^{\prime},\left(1^{r}\right) ; \lambda^{\prime}$ ), namely that obtained by filling in the squares of the vertical strip $\lambda^{\prime}-\mu^{\prime}$ consecutively, starting at the top. For this $S$ we have $a_{i j}=0$ or 1 for each pair $(i, j)$, and also $c_{i j}-b_{i j}=a_{i-1, j-1}=0$ or 1 , since there is at most one square of $\lambda^{\prime}-\mu^{\prime}$ in any row. Moreover, if $a_{i j}=1$ (so that there is
a square labelled $j+1$ in the ( $i+1$ )th row) we have $N_{i j}=0$. Hence, from the definition (4.10) of $\Phi$ we find that $\Phi\left(a_{i j}, b_{i j}, c_{i j} ; N_{i j} ; t\right)$ is equal to

$$
\begin{array}{ll}
1 & \text { if } a_{i-1, j-1}=a_{i j}=0 \text { or } \\
1-t & \text { if } a_{i-1, j-1}=0, a_{i j}=1 \\
\left(1-t^{c_{i j}}\right) /(1-t) & \text { if } a_{i-1, j-1}=1, a_{i j}=0
\end{array}
$$

Moreover, in the latter case (i.e. when there is a square labelled $j$ in the $i$ th row, but none labelled $j$ in the row below), $c_{i j}$ is the number of columns of $\lambda^{\prime}$ of length $i$, that is $c_{i j}=m_{i}(\lambda)$. Putting these facts together, we obtain
(4.13) Let $\sigma=\lambda-\mu$ be a horizontal strip of total length $r$, and let I be the set of integers $i \geqslant 1$ such that $\sigma_{i}^{\prime}=1$ and $\sigma_{i+1}^{\prime}=0$. Then

$$
g_{\mu(r)}^{\lambda}(t)=\frac{t^{n(\lambda)-n(\mu)}}{1-t^{-1}} \prod_{i \in I}\left(1-t^{-m_{l}(\lambda)}\right)
$$

where $m_{i}(\lambda)$ is the multiplicity of $i$ in $\lambda$. I

## Examples

1. Let $(x ; t)_{r}=(1-x)(1-x t) \ldots\left(1-x t^{r-1}\right)$ for all $r \geqslant 0$. Then $\Phi(a, b, c ; N ; t)$ is equal to the coefficient of $x^{b}$ in $\left(x t^{N+1} ; t\right)_{a} /(x ; t)_{c-b+1}$. (Use Chapter I, §2, Example 3.) Deduce that if $N=c-a-b$ we have

$$
\Phi(a, b, c ; N ; t)=\left[\begin{array}{c}
c-a \\
b
\end{array}\right]
$$

This applies in particular to the terms corresponding to $i=j$ in the product (4.11), since $N_{i i}=c_{i i}-a_{i i}-b_{i i}$.
2. Let

$$
{ }_{2} \varphi_{1}(\alpha, \beta ; \gamma ; t, x)=\sum_{r>0} \frac{(\alpha ; t)_{r}(\beta ; t)_{r}}{(\gamma ; t)_{r}(t ; t)_{r}} x^{r}
$$

in the standard notation for basic hypergeometric series (see e.g. [G5]). In this notation we have

$$
\Phi(a, b, c ; N ; t)=\left[\begin{array}{l}
c \\
b
\end{array}\right]_{2} \varphi_{1}\left(t^{a}, t^{b} ; t^{c} ; t^{-1}, t^{N}\right)
$$

so that $g_{S}(t)$ is a product of Gaussian polynomials and terminating ${ }_{2} \varphi_{1}$ 's.

## Notes and references

The contents of $\S \S 1$ and 2 , together with the theorem (4.3), are due to Philip Hall, who did not publish anything more than a summary of his
theory [H3]. The contents of $\S 3$, in particular (3.4), are due to J. A. Green [G13]. Theorem (4.1) was first proved by T. Klein [K10], a student of Green. Our proof is different from hers.

It should be pointed out that Hall was in fact anticipated by more than half a century by E. Steinitz, who in 1900 defined what we have called the Hall polynomials and the Hall algebra, recognized their connection with Schur functions, and conjectured Hall's theorem (4.3). Steinitz's note [S26] is a summary of a lecture given at the annual meeting of the Deutsche Mathematiker-Vereinigung in Aachen in 1900; it gives neither proofs nor indications of method, and remained forgotten until brought to light by K . Johnsen in 1982 [J13].

For generalizations of the notion of the Hall algebra, see the papers by C. M. Ringel [R2], [R3], [R4].

## APPENDIX*: Another proof of Hall's theorem

This Appendix is devoted to a simple proof of the following slightly weakened form of (4.3) (we shall freely use the terminology and notation of Chapter II):
(AZ.1) For any three partitions $\lambda, \mu, \nu$ there exists a polynomial $g_{\mu \nu}^{\lambda}(t) \in \mathbf{Z}[t]$ such that $G_{\mu \nu}^{\lambda}(\mathfrak{0})=g_{\mu \nu}^{\lambda}(q)$. Moreover, $g_{\mu \nu}^{\lambda}(t)$ has degree $\leqslant n(\lambda)-n(\mu)-$ $n(\nu)$, and the coefficient of $t^{n(\lambda)-n(\mu)-n(\nu)}$ is equal to $c_{\mu \nu}^{\lambda}$.

Our proof does not use the Littlewood-Richardson rule (Chapter I, (9.2)). Therefore, combining it with the arguments of $\S \S 3$ and 4 of Chapter II we shall obtain a new proof of the Littlewood-Richardson rule which makes the appearance of the lattice permutations more natural.

Our proof is based on a combinatorial interpretation of the coefficients $a_{\lambda \mu}$ from the formula (1) of Chapter II, §2. We need some definitions.

A composition is a sequence $\alpha=\left(\alpha_{1}, \alpha_{2}, \ldots\right)$ of non-negative integers with only a finite number of non-zero terms. So a partition is a composition such that $\alpha_{1} \geqslant \alpha_{2} \geqslant \ldots$. The group $S_{\infty}$ of finite permutations of $\mathrm{N}^{+}=\{1,2,3, \ldots\}$ acts on compositions by $w \alpha=\left(\alpha_{w^{-1}(1)}, \alpha_{w^{-1}(2)}, \ldots\right)$. We shall write $\alpha \sim \beta$ if $\alpha$ and $\beta$ are conjugate under this action: clearly, each $S_{\infty}$-orbit contains exactly one partition.
As well as partitions the compositions have diagrams: the diagram of $\alpha$ is formally defined as the set $\left\{(i, j) \in \mathbf{Z}^{2}: 1 \leqslant j \leqslant \alpha_{i}\right\}$ and is graphically displayed as the set of squares containing $\alpha_{i}$ squares in the $i$ th row.

If $\alpha$ and $\beta$ are two compositions, an array of shape $\alpha$ and weight $\beta$ is a numbering of the squares of the diagram of $\alpha$ by positive integers such that for any $i \geqslant 1$ there are $\beta_{i}$ squares numbered by $i$ (more formally, an array is a function $A: \alpha \rightarrow \mathrm{N}^{+}$such that Card $A^{-1}(i)=\beta_{i}$ for all $i \geqslant 1$; it will be convenient for us to assume that $A$ is defined on all of $\mathbf{N}^{+} \times \mathbf{N}^{+}$so that $A(i, j)=+\infty$ when $j>\alpha_{i}$ ). For any $x=(i, j) \in \mathrm{N}^{+} \times \mathrm{N}^{+}$let $x^{\rightarrow}=$ $(i, j+1)$. An array $\alpha$ will be called row-ordered (resp. row-strict) if $A(x \rightarrow) \geqslant A(x)$ (resp. $A(x \rightarrow)>A(x)$ ) for any $x \in \alpha$. Likewise we define column-ordered and column-strict arrays.

[^1]We define a total ordering on $\mathbf{N}^{+} \times \mathbf{N}^{+}$by

$$
(i, j)<_{L}\left(i^{\prime}, j^{\prime}\right) \Leftrightarrow \text { either } j<j^{\prime}, \text { or } j=j^{\prime} \text { and } i>i^{\prime}
$$

Finally, for each row-strict array $A$ of shape $\alpha$ we let

$$
d(A)=\operatorname{Card}\left\{(x, y) \in \alpha \times \alpha: y<_{L} x, A(x)<A(y)<A(x \rightarrow)\right\} .
$$

(AZ.2) Let $\lambda, \mu$ be partitions and $\alpha, \beta$ compositions such that $\alpha \sim \mu$ and $\beta \sim \lambda^{\prime}$. Then the coefficient $a_{\lambda \mu}$ (Chapter II, §2) is equal to

$$
a_{\lambda \mu}=\sum_{A} q^{d(A)}
$$

summed over all row-strict arrays $A$ of shape $\alpha$ and weight $\beta$.
Before proving (AZ.2) we shall derive from it (AZ.1). From (AZ.2) the polynomial

$$
\sum_{A} t^{d(A)} \in \mathbf{Z}[t]
$$

where the sum is the same as in (AZ.2), depends only on $\lambda$ and $\mu$; we denote it by $a_{\lambda \mu}(t)$.
(AZ.3) (a) $a_{\lambda \mu}(t)$ has coefficients $\geqslant 0$.
(b) $a_{\lambda \mu}(1)$ is equal to the number of ( 0,1 )-matrices with row sums $\mu_{1}, \mu_{2}, \ldots$ and column sums $\lambda_{1}^{\prime}, \lambda_{2}^{\prime}, \ldots$.
(c) $a_{\lambda \mu}(t)=0$ unless $\mu \leqslant \lambda$. Moreover, $a_{\lambda \lambda}(t)=1$.

Proof. (a) is evident. To prove (b) it is enough to establish a bijection between row-strict arrays of shape $\mu$ and weight $\lambda^{\prime}$, and ( 0,1 )-matrices with row sums $\mu_{1}, \mu_{2}, \ldots$ and column sums $\lambda_{1}^{\prime}, \lambda_{2}^{\prime}, \ldots$. To do this we assign to an array $A$ the matrix ( $c_{i j}$ ), where $c_{i j}=1$ if the $i$ th row of $A$ contains $j$, and $c_{i j}=0$ otherwise; this is the required bijection. Finally, (c) follows at once from (a), (b), and the Gale-Ryser theorem (Chapter I, §7, Example 9).

From (AZ.3)(c), $\left(a_{\lambda \mu}(t)\right)$ is a strictly upper unitriangular matrix over $\mathbf{Z}[t]$. Hence it is invertible, and its inverse has the same form. Therefore, the entries in the transition matrices between the bases ( $v_{\lambda^{\prime}}$ ) and $\left(u_{\lambda}\right)$ in $H(0)$ are integer polynomials in $q$. Since the multiplication law in $H(0)$ with respect to the basis ( $v_{\lambda^{\prime}}$ ) does not depend on $q$, it follows that the structure constants in the basis ( $u_{\lambda}$ ) are integer polynomials in $q$. This proves the existence of the Hall polynomials $g_{\mu \nu}^{\lambda}(t) \in \mathbf{Z}[t]$. It remains to find their degrees and leading coefficients.
(AZ.4) $a_{\lambda \mu}(t)$ has degree $\leqslant n(\mu)-n(\lambda)$, and the coefficient of $t^{n(\mu)-n(\lambda)}$ is equal to $K_{\mu^{\prime} \lambda^{\prime}}$ (Chapter I, §5).

This follows at once from the next combinatorial lemma:
(AZ.5) For any row-strict array $A$ of shape $\mu$ and weight $\lambda^{\prime}$ let $\tilde{d}(A)$ denote the number of pairs $(x, y) \in \mu \times \mu$ such that $y$ lies above $x$ (in the same column) and $A(x)<A(y)<A(x \rightarrow)$. Then
(a) $d(A)+\tilde{d}(A)=n(\mu)-n(\lambda)$;
(b) $\tilde{d}(A)=0$ if and only if $A$ is column-ordered.

Proof. (a) Let

$$
\begin{aligned}
& D(A)=\left\{(x, y) \in \mu \times \mu: y<_{L} x, A(x) \leqslant A(y)<A(x \rightarrow)\right\}, \\
& N(\mu)=\{(x, y) \in \mu \times \mu: y \text { lies above } x\}, \\
& \tilde{D}(A)=\{(x, y) \in N(\mu): A(x)<A(y)<A(x \rightarrow)\} ;
\end{aligned}
$$

then we have

$$
\begin{aligned}
& \operatorname{Card} D(A)=d(A)+\sum_{i>1}\binom{\lambda_{i}^{\prime}}{2}=d(A)+n(\lambda), \\
& \operatorname{Card} N(\mu)=\sum_{i>1}\binom{\mu_{i}^{\prime}}{2}=n(\mu),
\end{aligned}
$$

and

$$
\operatorname{Card} \tilde{D}(A)=\tilde{d}(A)
$$

We shall construct a mapping $\varphi: D(A) \rightarrow N(\mu)$. Let $(x, y) \in D(A)$ and suppose that $x=\left(i_{1}, j_{1}\right), \quad y=\left(i_{2}, j_{2}\right)$. Clearly $i_{1} \neq i_{2}$; let $i=\max \left(i_{1}, i_{2}\right)$, $i^{\prime}=\min \left(i_{1}, i_{2}\right), j=\min \left(j_{1}, j_{2}\right)$ and finally $\varphi(x, y)=\left((i, j),\left(i^{\prime}, j\right)\right)$. The definitions readily imply that $\varphi$ is a bijection of $D(A)$ onto $N(\mu)-\tilde{D}(A)$, whence our assertion.
(b) The 'if' part is evident. Now suppose that $A$ is not column-ordered: that is to say, there are $x=(i, j), y=\left(i^{\prime}, j\right) \in \mu$ such that $i>i^{\prime}$ and $A(x)<A(y)$. Choose such a pair with least possible $j$; clearly it belongs to $\tilde{D}(A)$, hence $\tilde{d}(A) \neq 0$.

Now let $\tilde{a}_{\lambda \mu}(t)=t^{n(\mu)-n(\lambda)} a_{\lambda \mu}\left(t^{-1}\right)$. From (AZ.4) and (AZ.5) we have

$$
\begin{equation*}
\tilde{a}_{\lambda \mu}(t)=\sum_{A} t^{\tilde{d}(A)} \tag{AZ.6}
\end{equation*}
$$

summed over all row-strict arrays of shape $\mu$ and weight $\lambda^{\prime}$; in particular, $\tilde{a}_{\lambda \mu}(t) \in \mathbf{Z}[t]$. Moreover, $\tilde{a}_{\lambda \mu}(0)=K_{\mu^{\prime} \lambda^{\prime}}$.

Now consider the ring $\Lambda[t]=\Lambda_{\text {z }[t]}$ of polynomials in $t$ with coefficients from $\Lambda$; we shall write down the elements of $\Lambda[t]$ as $P(x ; t)$. Clearly, $\Lambda[t]$
is a free $\mathbf{Z}[t]$-module with basis $\left(e_{\lambda}\right)$. From (AZ.3)(c), the matrix $\left(\tilde{a}_{\lambda \mu}(t)\right)$ is strictly upper unitriangular. Therefore, the equations

$$
\begin{equation*}
e_{\lambda^{\prime}}=\sum_{\mu} \tilde{a}_{\lambda \mu}(t) P_{\mu}(x ; t) \tag{1}
\end{equation*}
$$

uniquely determine the elements $P_{\mu}(x ; t) \in \Lambda[t]$, and they form a $\mathrm{Z}[t]$. basis of $\Lambda[t]$. Let $f_{\mu \nu}^{\lambda}(t)$ be the structure constants of $\Lambda[t]$ with respect to this basis, i.e.

$$
P_{\mu}(x ; t) P_{\nu}(x ; t)=\sum_{\lambda} f_{\mu \nu}^{\lambda}(t) P_{\lambda}(x ; t)
$$

it is clear that $f_{\mu \nu}^{\lambda}(t) \in \mathbf{Z}[t]$ for all $\lambda, \mu, \nu$.
(AZ.7)(a) $g_{\mu \nu}^{\lambda}(t)=t^{n(\lambda)-n(\mu)-n(\nu)} f_{\mu \nu}^{\lambda}\left(t^{-1}\right)$.
(b) $P_{\lambda}(x ; 0)=s_{\lambda}(x)$. In particular, $f_{\mu \nu}^{\lambda}(0)=c_{\mu \nu}^{\lambda}$ are the structure constants of $\Lambda$ in the basis $\left(s_{\lambda}\right)$.

Proof. (a) follows at once from the definitions. To prove (b) it is enough to observe that

$$
M(e, s)_{\lambda^{\prime} \mu}=K_{\mu^{\prime} \lambda^{\prime}}=\tilde{a}_{\lambda \mu}(0)
$$

by (AZ.6) and the results of Chapter I, §6. I
From (AZ.7), $g_{\mu \nu}^{\lambda}(t)$ has degree $\leqslant n(\lambda)-n(\mu)-n(\nu)$, and the coefficient of this power of $t$ is equal to $f_{\mu \nu}^{\lambda}(0)=c_{\mu \nu}^{\lambda}$. This completes the proof of (AZ.1).

It remains to prove (AZ.2). For this we reformulate the definitions of an array and of $d(A)$ in terms of sequences of compositions. If $\alpha$ and $\beta$ are two compositions, we shall write $\beta \dashv \alpha$ if $\alpha_{i}-1 \leqslant \beta_{i} \leqslant \alpha_{i}$ for any $i \geqslant 1$. If $\beta \dashv \alpha$ then we define $d(\alpha, \beta)$ to be the number of pairs $(i, j)$ such that $\beta_{i}=\alpha_{i}, \beta_{j}=\alpha_{j}-1$ and $\left(j, \alpha_{j}\right)<_{L}\left(i, \alpha_{i}\right)$.
(AZ.8) Let $\alpha$ and $\beta$ be two compositions and suppose that $\beta_{i}=0$ for $i>r$. There is a natural one-to-one correspondence between row-strict arrays $A$ of shape $\alpha$ and weight $\beta$, and sequences of compositions ( $\alpha^{(0)}, \alpha^{(1)}, \ldots, \alpha^{(r)}$ ) such that $0=\alpha^{(0)} \dashv \alpha^{(1)} \dashv \ldots \dashv \alpha^{(r)}=\alpha$ and $\left|\alpha^{(i)}\right|-\left|\alpha^{(i-1)}\right|=\beta_{i}$ for $i \geqslant 1$. Moreover, this correspondence transforms $d(A)$ into $\Sigma_{i>1} d\left(\alpha^{(i)}, \alpha^{(i-1)}\right)$.

Proof. We attach to an array $A$ the sequence $\left(\alpha^{(i)}\right.$, where $\alpha^{(i)}=$ $A^{-1}(\{1,2, \ldots, i\})$. All our assertions are verified directly.

Remembering the definition of $a_{\lambda \mu}$ (Chapter II, §2) we see that an evident induction reduces the proof of (AZ.2) to the next statement:
(AZ.9) Let $\lambda, \mu$ be partitions with $|\lambda|=|\mu|+r$, and $\alpha$ a composition such that $\alpha \sim \lambda$. Then

$$
G_{\mu\left(l^{\prime}\right)}^{\lambda}(\mathfrak{0})=\sum_{\beta} q^{d(\alpha, \beta)}
$$

summed over all compositions $\beta$ such that $\beta \dashv \alpha$ and $\beta \sim \mu$.
Proof. Let $M$ be a finite 0 -module of type $\lambda$. Recall that $G_{\mu\left(1^{\prime}\right)}^{\lambda}(0)$ is the number of submodules $N \subset M$ of type ( $1^{r}$ ) and cotype $\mu$. The condition that $N$ has type ( $1^{r}$ ) means that $N$ is an $r$-dimensional vector $k$-subspace of the socle $S$ of $M$. Let $G_{r}(S)$ denote the set of these subspaces. We shall use the decomposition of $G_{r}(S)$ into Schubert cells. Recall that if a basis $\left(v_{i}\right)_{i \in I}$ of $S$ is given, where $I$ is a totally ordered set, then the corresponding Schubert cells $C_{J}$ in $G_{r}(S)$ are parametrized by $r$-subsets $J \subset I$. The elements of $C_{J}$ have coordinates ( $c_{i j} \in k: j \in J, i \in I-J, j<i$ ); the subspace corresponding to ( $c_{i j}$ ) has the basis $\left(v_{j}+\sum_{i} c_{i j} v_{i}\right)_{j \in J}$. It is known (and easy to prove) that $G_{r}(S)$ is the disjoint union of the $C_{J}$. Moreover, we have Card $\left(C_{J}\right)=q^{d(J)}$, where $d(J)$ is the number of pairs $(i, j)$ such that $j \in J, i \in I-J$ and $j<i$.

Now we express $M$ in the form $M=\oplus_{i>1} \mathfrak{D} x_{i}$, where $\operatorname{Ann}\left(x_{i}\right)=\mathfrak{p}^{\alpha_{i}}$. Let $I$ denote the set of indices $i \geqslant 1$ such that $\alpha_{i}>0$, and for each $i \in I$ let $v_{i}=\pi^{\alpha_{i}-1} x_{i}$, where $\pi$ is a generator of $\mathfrak{p}$. It is clear that the $v_{i}(i \in I)$ form a $k$-basis of $S$. We order $I$ by requiring that $j$ precedes $i$ if and only if $\left(j, \alpha_{j}\right)<_{L}\left(i, \alpha_{i}\right)$. Consider the corresponding decomposition of $G_{r}(S)$ into Schubert cells. The subsets $J \subset I$ are in natural one-to-one correspondence with compositions $\beta \dashv \alpha$ : to a subset $J$ there corresponds the composition $\beta$ such that $\beta_{i}=\alpha_{i}-1$ for $i \in J$, and $\beta_{i}=\alpha_{i}$ for $i \in I-J$. It is clear that this correspondence transforms $d(J)$ into $d(\alpha, \beta)$. Finally, it is easy to prove that all submodules $N \in C_{J}$ have the same cotype $\mu$, where $\mu$ is the partition such that $\mu \sim \beta$. This completes the proof of (AZ.9).

Remarks. 1. The polynomials $P_{\lambda}(x ; t)$ defined by (1) are called the HallLittlewood functions. They will be studied in detail in Chapter III.
2. It is easy to see that (AZ.9) is equivalent to Chapter II, (4.6): each of these statements follows at once from the other by means of the following well-known expression for Gaussian polynomials:

$$
\left[\begin{array}{l}
n  \tag{2}\\
r
\end{array}\right]=\sum_{J} t^{d(J)}
$$

where the sum is over all $r$-subsets of a totally ordered $n$-set $I$, and $d(J)$ is defined in the proof of (AZ.9) above. The formula (2) follows e.g. from Chapter I, §2, Example 3. On the other hand, one of the standard ways to prove (2) is to count the number of points on a Grassmannian over a finite field in two different ways, which was essentially done above.

## III

## HALL-LITTLEWOOD SYMMETRIC FUNCTIONS

## 1. The symmetric polynomials $R_{\lambda}$

Let $x, \ldots, x_{n}$ and $t$ be independent indeterminates over $\mathbf{Z}$, and let $\lambda$ be a partition of length $\leqslant n$. Define

$$
R_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)=\sum_{w \in S_{n}} w\left(x_{1}^{\lambda_{1}} \ldots x_{n}^{\lambda_{n}} \prod_{i<j} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}}\right)
$$

The denominator in each term of the sum on the right-hand side is, up to sign, the Vandermonde polynomial

$$
a_{\delta}=\prod_{i<j}\left(x_{i}-x_{j}\right)
$$

(Chapter I, §3), and therefore we have
(1.1) $R_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)=a_{\delta}^{-1} \sum_{w \in S_{n}} \varepsilon(w) . w\left(x_{1}^{\lambda_{1}} \ldots x_{n}^{\lambda_{n}} \prod_{i<j}\left(x_{i}-t x_{j}\right)\right)$
where as usual $\varepsilon(w)$ is the sign of the permutation $w$. The sum on the right-hand side of (1.1) is skew-symmetric in $x_{1}, \ldots, x_{n}$, hence is divisible by $a_{\delta}$ in the ring $\mathbf{Z}\left[x_{1}, \ldots, x_{n}, t\right]$, and consequently $R_{\lambda}$ is a homogeneous symmetric polynomial in $x_{1}, \ldots, x_{n}$, of degree $|\lambda|$, with coefficients in $\mathrm{Z}[t]$. Hence $R_{\lambda}$ can be expressed as a linear combination of the Schur functions $s_{\mu}\left(x_{1}, \ldots, x_{n}\right)$, with coefficients in $\mathbf{Z}[t]$. In fact we have

$$
\begin{equation*}
R_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)=\sum_{\mu} u_{\lambda \mu}(t) s_{\mu}\left(x_{1}, \ldots, x_{n}\right) \tag{1.2}
\end{equation*}
$$

where $u_{\lambda \mu}(t) \in \mathbf{Z}[t]$, and $u_{\lambda \mu}(t)=0$ unless $|\lambda|=|\mu|$ and $\lambda \geqslant \mu$.
Moreover, the polynomial $u_{\lambda \lambda}(t)$ can be explicitly computed. For each integer $m \geqslant 0$ let

$$
v_{m}(t)=\prod_{i=1}^{m} \frac{1-t^{i}}{1-t}=\varphi_{m}(t) /(1-t)^{m}
$$

and for a partition $\lambda=\left(\lambda_{1}, \ldots, \lambda_{n}\right)$ of length $\leqslant n$ (in which some of the $\lambda_{i}$ may be zero) we define

$$
v_{\lambda}(t)=\prod_{i \geqslant 0} v_{m_{i}}(t)
$$

where $m_{i}$ is the number of $\lambda_{j}$ equal to $i$, for each $i \geqslant 0$. Then we have

$$
\begin{equation*}
u_{\lambda \lambda}(t)=v_{\lambda}(t) . \tag{1.3}
\end{equation*}
$$

Proof of (1.2) and (1.3). The product $\Pi_{i<j}\left(x_{i}-t x_{j}\right)$, when multiplied out, is a sum of terms of the form

$$
\prod_{i<j} x_{i}^{r_{l / 1}}\left(-t x_{j}\right)^{r_{i j}}
$$

where $\left(r_{i j}\right)$ is any $n \times n$ matrix of 0 's and 1 's such that

$$
\begin{equation*}
r_{i i}=0, \quad r_{i j}+r_{j i}=1 \text { if } i \neq j \tag{i}
\end{equation*}
$$

For such a matrix ( $r_{i j}$ ), let
(ii)

$$
\begin{gather*}
\alpha_{i}=\lambda_{i}+\sum_{j} r_{i j}, \\
d=\sum_{i<j} r_{j i} . \tag{iii}
\end{gather*}
$$

Then from (1.1) it is clear that $R_{\lambda}$ is a sum of terms

$$
(-t)^{d} a_{\alpha} a_{\delta}^{-1}
$$

where as in Chapter I, $\S 3, a_{\alpha}$ is the skew-symmetric polynomial generated by $x^{\alpha}=x_{1}^{\alpha_{1}} \ldots x_{n}^{\alpha_{n}}$. Since $a_{\alpha}=0$ if any two of the $\alpha_{i}$ are equal, we may assume that $\alpha_{1}, \ldots, \alpha_{n}$ are all distinct. We rearrange them in descending order, say

$$
\begin{equation*}
a_{w(i)}=\mu_{i}+n-i \quad(1 \leqslant i \leqslant n) \tag{iv}
\end{equation*}
$$

for some permutation $w \in S_{n}$ and some partition $\mu=\left(\mu_{1}, \ldots, \mu_{n}\right)$. Then $a_{\alpha} a_{\delta}^{-1}$ is equal to $\varepsilon(w) s_{\mu}$, and to prove (1.2) it is enough to show that $\mu \leqslant \lambda$.

Let $s_{i j}=r_{w(i), w(j)}$. The matrix $\left(s_{i j}\right)$ satisfies the same conditions (i) as the matrix ( $r_{i j}$ ), and from (ii) and (iv) we have

$$
\mu_{i}+n-i=\lambda_{w(i)}+\sum_{j} s_{i j}
$$

Hence for $1 \leqslant k \leqslant n$
(v)

$$
\mu_{1}+\ldots+\mu_{k}=\lambda_{w(1)}+\ldots+\lambda_{w(k)}+\sum_{i=1}^{k} \sum_{j=1}^{n} s_{i j}-\sum_{i=1}^{k}(n-i)
$$

Now

$$
\begin{aligned}
\sum_{i=1}^{k} \sum_{j=1}^{n} s_{i j} & =\sum_{i, j=1}^{k} s_{i j}+\sum_{i=1}^{k} \sum_{j=k+1}^{n} s_{i j} \\
& =\frac{1}{2} k(k-1)+\sum_{i=1}^{k} \sum_{j>k} s_{i j} \\
& \leqslant \frac{1}{2} k(k-1)+k(n-k) \\
& =\sum_{i=1}^{k}(n-i)
\end{aligned}
$$

Hence it follows from (v) that

$$
\begin{aligned}
\mu_{1}+\ldots+\mu_{k} & \leqslant \lambda_{w(1)}+\ldots+\lambda_{w(k)} \\
& \leqslant \lambda_{1}+\ldots+\lambda_{k}
\end{aligned}
$$

and therefore $\mu \leqslant \lambda$. This proves (1.2).
Furthermore, these calculations show that $\lambda=\mu$ if and only if $\lambda_{w(i)}=\lambda_{i}$ for $1 \leqslant i \leqslant n$, and $s_{i j}=1$ for all pairs $i<j$. It follows that

$$
\begin{equation*}
u_{\lambda \lambda}(t)=\sum_{w} \varepsilon(w)(-t)^{d} \tag{vi}
\end{equation*}
$$

summed over all $w \in S_{n}$ which fix $\lambda$, where

$$
d=\sum_{i<j} r_{j i}=\sum_{i<j} s_{w^{-1}(j), w^{-1}(i)}
$$

is equal to the number $n(w)$ of pairs $i<j$ in $\{1,2, \ldots, n\}$ such that $w^{-1}(j)<w^{-1}(i)$; this number $n(w)$ is also the number of pairs $l<k$ such that $w(k)<w(l)$, and the signature $\varepsilon(w)$ is equal to $(-1)^{n(w)}$. Hence from (vi) we have

$$
\begin{equation*}
u_{\lambda \lambda}(t)=\sum_{w \in S_{n}^{\lambda}} t^{n(w)} \tag{vii}
\end{equation*}
$$

where $S_{n}^{\lambda}$ is the subgroup of permutations $w \in S_{n}$ such that $\lambda_{w(i)}=\lambda_{i}$ for $1 \leqslant i \leqslant n$. Clearly $S_{n}^{\lambda}=\prod_{i>0} S_{m_{i}}$ where as before $m_{i}$ is the number of $\lambda_{j}$
equal to $i$, and hence to prove (1.3) it is enough to show that (viii)

$$
\sum_{w \in S_{m}} t^{n(w)}=v_{m}(t)
$$

We prove (viii) by induction on $m$. Let $w_{i}$ denote the transposition $(i, m)$, for $1 \leqslant i \leqslant m$ (so that $w_{m}$ is the identity). The $w_{i}$ are coset representatives of $S_{m-1}$ in $S_{m}$, and we have

$$
n\left(w^{\prime} w_{i}\right)=n\left(w^{\prime}\right)+m-i
$$

for $w^{\prime} \in S_{m-1}$, because in the sequence ( $w^{\prime} w_{i}(1), \ldots, w^{\prime} w_{i}(m)$ ) the number $m$ occurs in the $i$ th place and is therefore followed by $m-i$ numbers less than $m$. Consequently

$$
\sum_{w \in S_{m}} t^{n(w)}=\left(\sum_{w^{\prime} \in S_{m-1}} t^{n\left(w^{\prime}\right)}\right)\left(1+t+\ldots+t^{m-1}\right)
$$

from which (viii) follows immediately. This completes the proof of (1.3). |
By taking $\lambda=0$ in (1.2) and (1.3) we have

$$
\begin{equation*}
\sum_{w \in S_{n}} w\left(\prod_{i<j} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}}\right)=v_{n}(t) \tag{1.4}
\end{equation*}
$$

which is independent of $x_{1}, \ldots, x_{n}$.
Next we shall show that
(1.5) $R_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)$ is divisible by $v_{\lambda}(t)$ (i.e. all the coefficients of $R_{\lambda}$ are divisible by $v_{\lambda}(t)$ in $\left.\mathbf{Z}[t]\right)$.

Proof. Suppose for example that $\lambda_{1}=\ldots=\lambda_{m}>\lambda_{m+1}$. Then any $w \in S_{n}$ which permutes only the digits $1,2, \ldots, m$ will fix the monomial $x_{1}^{\lambda_{1}} \ldots x_{n}^{\lambda_{n}}$, and by (1.4) we can extract a factor $v_{m}(t)$ from $R_{\lambda}$. It follows that

$$
\begin{aligned}
R_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right) & =v_{\lambda}(t) \sum_{w \in S_{n} / S_{n}^{\lambda}} w\left(x_{1}^{\lambda_{1}} \ldots x_{n}^{\lambda_{n}} \prod_{\lambda_{i}>\lambda_{j}} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}}\right) \\
& =v_{\lambda}(t) P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right), \quad \text { say. }
\end{aligned}
$$

Since $R_{\lambda}$ is a polynomial in $x_{1}, \ldots, x_{n}$, so also is $P_{\lambda}$; and since $t$ occurs only in the numerators of the terms in the sum $P_{\lambda}$, it follows that $P_{\lambda}$ is a symmetric polynomial in $x_{1}, \ldots, x_{n}$ with coefficients in $\mathrm{Z}[t]$. |

It is these polynomials $P_{\lambda}$, rather than the $R_{\lambda}$, which are the subject of this chapter.

## 2. Hall-Littlewood functions

The polynomials $P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)$ just defined are called the HallLittlewood polynomials. They were first defined indirectly by Philip Hall, in terms of the Hall algebra (Chapter II) and then directly by D. E. Little. wood [L12], essentially as we have defined them. From the proof of (1.5) we have two equivalent definitions:

$$
\begin{align*}
& P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)=\frac{1}{v_{\lambda}(t)} \sum_{w \in S_{n}} w\left(x_{1}^{\lambda_{1}} \ldots x_{n}^{\lambda_{n}} \prod_{i<j} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}}\right),  \tag{2.1}\\
& P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)=\sum_{w \in S_{n} / S_{n}^{\lambda}} w\left(x_{1}^{\lambda_{1}} \ldots x_{n}^{\lambda_{n}} \prod_{\lambda_{i}>\lambda_{j}} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}}\right)
\end{align*}
$$

The $P_{\lambda}$ serve to interpolate between the Schur functions $s_{\lambda}$ and the monomial symmetric functions $m_{\lambda}$, because

$$
\begin{equation*}
P_{\lambda}\left(x_{1}, \ldots, x_{n} ; 0\right)=s_{\lambda}\left(x_{1}, \ldots, x_{n}\right) \tag{2.3}
\end{equation*}
$$

as is clear from (2.1), and

$$
\begin{equation*}
P_{\lambda}\left(x_{1}, \ldots, x_{n} ; 1\right)=m_{\lambda}\left(x_{1}, \ldots, x_{n}\right) \tag{2.4}
\end{equation*}
$$

as is clear from (2.2).
As with the other types of symmetric functions studied in Chapter I, the number of variables $x_{1}, \ldots, x_{n}$ is immaterial, provided only that it is not less than the length of the partition $\lambda$. For we have
(2.5) Let $\lambda$ be a partition of length $\leqslant n$. Then

$$
P_{\lambda}\left(x_{1}, \ldots, x_{n}, 0 ; t\right)=P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)
$$

Proof. From (2.2) we have

$$
P_{\lambda}\left(x_{1}, \ldots, x_{n+1} ; t\right)=\sum_{w \in S_{n+1} / S_{n+1}^{\lambda}} w\left(x_{1}^{\lambda_{1}} \ldots x_{n+1}^{\lambda_{n+1}} \prod_{\lambda_{i}>\lambda_{j}} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}}\right) .
$$

When we set $x_{n+1}$ equal to 0 , the only terms on the right-hand side which survive will be those which correspond to permutations $w \in S_{n+1}$ which send $n+1$ to some $r$ such that $\lambda_{r}=0$; modulo $S_{n+1}^{\lambda}$, such a permutation fixes $n+1$, so that the summation is effectively over $S_{n} / S_{n}^{\lambda}$.

Remark. The polynomials $R_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)$ defined in $\S 1$ do not have this stability property, and are therefore of little interest.

By virtue of (2.5) we may pass to the limit and define $P_{\lambda}(x ; t)$ to be the element of $\Lambda[t]$ whose image in $\Lambda_{n}[t]$ for each $n \geqslant l(\lambda)$ is $P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)$. The symmetric function $P_{\lambda}(x ; t)$ is the Hall-Littlewood function corresponding to the partition $\lambda$. It is homogeneous of degree $|\lambda|$.
From (1.2), (1.3), and (1.5) it follows that

$$
P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)=\sum_{\mu} w_{\lambda \mu}(t) s_{\mu}\left(x_{1}, \ldots, x_{n}\right)
$$

with coefficients $w_{\lambda \mu}(t) \in \mathbf{Z}[t]$ such that $w_{\lambda \mu}(t)=0$ unless $|\lambda|=|\mu|$ and $\lambda \geqslant \mu$, and $w_{\lambda \lambda}(t)=1$. Hence
(2.6) The transition matrix $M(P, s)$ which expresses the $P_{\lambda}$ in terms of the $s_{\mu}$ is strictly upper unitriangular (Chapter I, §6).

Since the $s_{\mu}$ form a $\mathbf{Z}$-basis of the ring $\Lambda$ of symmetric functions, and therefore also a $\mathbf{Z}[t]$-basis of $\Lambda[t]$, it follows from (2.6) that the same is true of the $P_{\lambda}$ :
(2.7) The symmetric functions $P_{\lambda}(x ; t)$ form a $\mathbf{Z}[t]$-basis of $\Lambda[t]$. |

Next we consider $P_{\lambda}$ when $\lambda=\left(1^{r}\right)$ and when $\lambda=(r)$. In the first case we have

$$
\begin{equation*}
P_{\left(1^{r}\right)}(x ; t)=e_{r}(x), \tag{2.8}
\end{equation*}
$$

the rth elementary symmetric function of the $x_{i}$.
Proof. By stability (2.5) $P_{\left(1^{\prime}\right)}$ is uniquely determined by its image in $\Lambda_{r}[t]$ : in other words, we may assume that the number of variables is $r$. But then it is clear from (2.2) that $P_{\left(1^{\prime}\right)}\left(x_{1}, \ldots, x_{r} ; t\right)=x_{1} \ldots x_{r}=e_{r}$. I

We now define

$$
\begin{aligned}
q_{r} & =q_{r}(x ; t)=(1-t) P_{(r)}(x ; t) \quad(r \geqslant 1) \\
q_{0} & =q_{0}(x ; t)=1
\end{aligned}
$$

From (2.2) we have, for $r \geqslant 1$,

$$
\begin{equation*}
q_{r}\left(x_{1}, \ldots, x_{n} ; t\right)=(1-t) \sum_{i=1}^{n} x_{i}^{r} \prod_{j \neq i} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}} \tag{2.9}
\end{equation*}
$$

The generating function for the $q_{r}$ is

$$
\begin{align*}
Q(u) & =\sum_{r=0}^{\infty} q_{r}(x ; t) u^{r}=\prod_{i} \frac{1-x_{i} t u}{1-x_{i} u}  \tag{2.10}\\
& =H(u) / H(t u)
\end{align*}
$$

in the notation of Chapter I.
Proof. Suppose first that the number of variables $x_{i}$ is finite, and put $z=u^{-1}$. By the usual rule for partial fractions we have

$$
\prod_{i=1}^{n} \frac{z-t x_{i}}{z-x_{i}}=1+\sum_{i=1}^{n} \frac{(1-t) x_{i}}{z-x_{i}} \prod_{j \neq i} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}},
$$

so that

$$
\prod_{i=1}^{n} \frac{1-t u x_{i}}{1-u x_{i}}=1+(1-t) \sum_{i=1}^{n} \frac{x_{i} u}{1-x_{i} u} \prod_{j \neq i} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}}
$$

in which the coefficient of $u^{r}$, for $r \geqslant 0$, is equal to $q_{r}\left(x_{1}, \ldots, x_{n} ; t\right)$ by (2.9). Now let $n \rightarrow \infty$ as usual.

It will be convenient to introduce another family of symmetric functions $Q_{\lambda}(x ; t)$, which are scalar multiples of the $P_{\lambda}(x ; t)$. They are defined as follows:

$$
\begin{equation*}
Q_{\lambda}(x ; t)=b_{\lambda}(t) P_{\lambda}(x ; t) \tag{2.11}
\end{equation*}
$$

where

$$
\begin{equation*}
b_{\lambda}(t)=\prod_{i>1} \varphi_{m_{i}(\lambda)}(t) \tag{2.12}
\end{equation*}
$$

Here, as usual, $m_{i}(\lambda)$ denotes the number of times $i$ occurs as a part of $\lambda$, and $\varphi_{r}(t)=(1-t)\left(1-t^{2}\right) \ldots\left(1-t^{r}\right)$. In particular,

$$
\begin{equation*}
Q_{(r)}(x ; t)=q_{r}(x ; t) \tag{2.13}
\end{equation*}
$$

We shall refer to the $Q_{\lambda}$ as well as the $P_{\lambda}$ as Hall-Littlewood functions. They may also be defined inductively, as follows. If $f$ is any polynomial or formal power series in $x_{1}, \ldots, x_{n}$ (and possibly other variables), and $1 \leqslant i \leqslant$ $n$, let $f^{(i)}$ denote the result of setting $x_{i}=0$ in $f$. Then if we write $Q_{\lambda}$ for $Q_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)$, we have

$$
\begin{equation*}
Q_{\lambda}=\sum_{i=1}^{n} x_{i}^{\lambda_{1}} g_{i} Q_{\mu}^{(i)} \tag{2.14}
\end{equation*}
$$

where $\mu=\left(\lambda_{2}, \lambda_{3}, \ldots\right)$ is the partition obtained by deleting the largest part of $\lambda$, and

$$
g_{i}=(1-t) \prod_{j \neq i} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}}
$$

Proof. Let $l$ be the length of $\lambda$. From the definitions of $b_{\lambda}(t)$ and $v_{\lambda}(t)$ we have

$$
v_{\lambda}(t)=v_{n-l}(t) b_{\lambda}(t) /(1-t)^{l},
$$

and therefore

$$
\begin{aligned}
Q_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right) & =\frac{(1-t)^{l}}{v_{n-l}(t)} R_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right) \\
& =(1-t)^{l} \sum_{w \in S_{n} / S_{n-1}} w\left(x_{1}^{\lambda_{1}} \ldots x_{l}^{\lambda_{l}} \prod_{i=1}^{l} \prod_{j>i} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}}\right)
\end{aligned}
$$

by (1.4), where $S_{n-1}$ acts on $x_{l+1}, \ldots, x_{n}$. It follows that

$$
Q_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)=\sum_{w \in S_{n} / S_{n-1}} w\left(x_{1}^{\lambda_{1}} g_{1} Q_{\mu}\left(x_{2}, \ldots, x_{n} ; t\right)\right)
$$

which is equivalent to (2.14).
Let

$$
\begin{aligned}
F(u) & =\frac{1-u}{1-t u} \\
& =1+\sum_{r>1}\left(t^{r}-t^{r-1}\right) u^{r}
\end{aligned}
$$

as a power series in $u$. Then we have
(2.15) Let $u_{1}, u_{2}, \ldots$ be independent indeterminates. Then $Q_{\lambda}(x ; t)$ is the coefficient of $u^{\lambda}=u_{1}^{\lambda_{1}} u_{2}^{\lambda_{2}} \ldots$ in

$$
Q\left(u_{1}, u_{2}, \ldots\right)=\prod_{i \geqslant 1} Q\left(u_{i}\right) \prod_{i<j} F\left(u_{i}^{-1} u_{j}\right) .
$$

Proof. We proceed by induction on the length $l$ of $\lambda$. When $l=1$, (2.15) follows from (2.13). So let $l>1$ and assume the result true for $\mu=$ $\left(\lambda_{2}, \lambda_{3}, \ldots\right)$.
As before, let $Q^{(i)}(u)$ (resp. $Q^{(i)}\left(u_{1}, u_{2}, \ldots\right)$ ) denote the result of setting $x_{i}=0$ in $Q(u)$ (resp. $Q\left(u_{1}, u_{2}, \ldots\right)$ ). From (2.10) we have

$$
Q^{(i)}(u)=F\left(x_{i} u\right) Q(u)
$$

and hence

$$
\begin{equation*}
Q^{(i)}\left(u_{1}, u_{2}, \ldots\right)=Q\left(u_{1}, u_{2}, \ldots\right) \prod_{j>1} F\left(x_{i} u_{j}\right) \tag{1}
\end{equation*}
$$

From (2.14), $Q_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)$ is the coefficient of $u^{\lambda}$ in

$$
\begin{align*}
& \sum_{\lambda_{1}>0} u_{1}^{\lambda_{1}} \sum_{i=1}^{n} x_{i}^{\lambda_{1}} g_{i} Q^{(i)}\left(u_{2}, u_{3}, \ldots\right) \\
& \quad=Q\left(u_{2}, u_{3}, \ldots\right) \sum_{\lambda_{1}>0} u_{1}^{\lambda_{1}} \sum_{i=1}^{n} x_{i}^{\lambda_{1}} g_{i} \prod_{j>2} F\left(x_{i} u_{j}\right) \tag{2}
\end{align*}
$$

by (1) above. Let us expand the product $\Pi_{j>2} F\left(x_{i} u_{j}\right)$ as a power series in $x_{i}$, say

$$
\prod_{j \geqslant 2} F\left(x_{i} u_{j}\right)=\sum_{m \geqslant 0} f_{m} x_{i}^{m}
$$

where the coefficients $f_{m}$ are polynomials in $t, u_{2}, u_{3}, \ldots$. Then the expression (2) is equal to $Q\left(u_{2}, u_{3}, \ldots\right)$ multiplied by

$$
\begin{aligned}
\sum_{\lambda_{1} \geqslant 0} u_{1}^{\lambda_{1}} \sum_{m>0} f_{m} \sum_{i=1}^{n} x_{i}^{\lambda_{1}+m} g_{i} & =\sum_{\lambda_{1}, m} u_{1}^{\lambda_{1}} q_{\lambda_{1}+m} f_{m} \\
& =Q\left(u_{1}\right) \sum_{m>0} f_{m} u_{1}^{-m} \\
& =Q\left(u_{1}\right) \prod_{j \geqslant 2} F\left(u_{1}^{-1} u_{j}\right)
\end{aligned}
$$

and hence finally $Q_{\lambda}$ is the coefficient of $u^{\lambda}$ in

$$
Q\left(u_{1}\right) \prod_{j>2} F\left(u_{1}^{-1} u_{j}\right) \cdot Q\left(u_{2}, u_{3}, \ldots\right)=Q\left(u_{1}, u_{2}, u_{3}, \ldots\right)
$$

For any finite sequence $\alpha=\left(\alpha_{1}, \alpha_{2}, \ldots\right)$ of integers let

$$
q_{\alpha}=q_{\alpha}(x ; t)=\prod_{i \geqslant 1} q_{\alpha_{i}}(x ; t)
$$

with the convention that $q_{r}=0$ if $r<0$ (so that $q_{\alpha}=0$ if any $\alpha_{i}$ is negative). The raising operators $R_{i j}, i<j$ (Chapter I, §1) act as follows: $R_{i j} q_{\alpha}=q_{R_{i j}}$. Then the coefficient of $u^{\alpha}$ in

$$
F\left(u_{i}^{-1} u_{j}\right) \prod_{k \geqslant 1} Q\left(u_{k}\right)=\left(1+\sum_{r \geqslant 1}\left(t^{r}-t^{r-1}\right) u_{i}^{-r} u_{j}^{r}\right) \sum_{\beta} q_{\beta} u^{\beta}
$$

is

$$
1+\sum_{r>1}\left(t^{r}-t^{r-1}\right) R_{i j}^{r} q_{\alpha}=\frac{1-R_{i j}}{1-t R_{i j}} q_{\alpha} .
$$

It follows that (2.15) may be restated in terms of raising operators:

$$
Q_{\lambda}=\prod_{i<j} \frac{1-R_{i j}}{1-t R_{i j}} q_{\lambda}
$$

for all partitions $\lambda$.
Hence

$$
Q_{\lambda}=\prod_{i<j}\left(1+(t-1) R_{i j}+\left(t^{2}-t\right) R_{i j}^{2}+\ldots\right) q_{\lambda}
$$

and it follows from Chapter I, (1.14) that

$$
Q_{\lambda}=\sum_{\mu} a_{\lambda \mu}(t) q_{\mu}
$$

where the polynomials $a_{\lambda \mu}(t) \in \mathbf{Z}[t]$ are such that $a_{\lambda \mu}(t)=0$ unless $\lambda \leqslant \mu$, and $a_{\lambda \lambda}(t)=1$. By (2.7), the $Q_{\lambda}$ form a $\mathbf{Q}(t)$-basis of $\Lambda \otimes_{\mathbf{Z}} \mathbf{Q}(t)$; and therefore
(2.16) The symmetric functions $q_{\lambda}$ form a $\mathbf{Q}(t)$-basis of $\Lambda \otimes_{\mathbf{Z}} \mathbf{Q}(t)$, and the transition matrix (Chapter I, § 6) $M(Q, q)$ is strictly lower unitriangular.

## Examples

1. If we set $x_{i}=t^{i-1}(1 \leqslant i \leqslant n)$ we have

$$
R_{\lambda}\left(1, t, \ldots, t^{n-1} ; t\right)=t^{n(\lambda)} v_{n}(t)
$$

directly from the definition (1.1), because the only term in the sum which does not vanish is that corresponding to $w=1$. Hence

$$
Q_{\lambda}\left(1, t, \ldots, t^{n-1} ; t\right)=t^{n(\lambda)} \varphi_{n}(t) / \varphi_{m_{0}}(t)
$$

where $m_{0}=n-l(\lambda)$. Let $n \rightarrow \infty$, then also $m_{0} \rightarrow \infty$ and so when $x_{i}=t^{i-1}$ for all $i \geqslant 1$ we have

$$
Q_{\lambda}\left(1, t, t^{2}, \ldots, ; t\right)=t^{n(\lambda)} .
$$

2. We can use the inductive definition (2.14) to define $Q_{\lambda}$ for any finite sequence $\left(\lambda_{1}, \lambda_{2}, \ldots, \lambda_{i}\right)$ of non-negative integers, not necessarily in descending order. The formula ( $2.15^{\prime}$ ) will still be valid and can be used to extend the definition of $Q_{\lambda}$ to any sequence ( $\lambda_{1}, \lambda_{2}, \ldots \lambda_{l}$ ) of integers, positive or negative. If $\lambda_{l}<0$, clearly $Q_{\lambda}=0$.
To reduce $Q_{\lambda}$ when the $\lambda_{i}$ are not in descending order to a linear combination
of the $Q_{\mu}$ where $\mu$ is a partition, we may proceed as follows: since interchange of $x_{1}$ and $x_{2}$ transforms

$$
\frac{x_{1}^{r} x_{2}^{s}\left(x_{2}-t x_{1}\right)\left(x_{1}-t x_{2}\right)}{x_{1}-x_{2}}
$$

into

$$
-\frac{x_{1}^{s} x_{2}^{r}\left(x_{2}-t x_{1}\right)\left(x_{1}-t x_{2}\right)}{x_{1}-x_{2}}
$$

it follows that

$$
Q_{(r, s+1)}-t Q_{(r+1, s)}=-\left(Q_{(s, r+1)}-t Q_{(s+1, r)}\right)
$$

or, replacing $r$ by $r-1$, that

$$
Q_{(s, r)}=t Q_{(r, s)}-Q_{(r-1, s+1)}+t Q_{(s+1, r-1)}
$$

Assuming $s<r$, this relation enables us to express $Q_{(s, r)}$ in terms of the $Q_{(r-i, s+i)}$ where $0 \leqslant i \leqslant\left[\frac{1}{2}(r-s)\right]=m$ say. The result is

$$
Q_{(s, r)}=t Q_{(r, s)}+\sum_{i=1}^{m}\left(t^{i+1}-t^{i-1}\right) Q_{(r-i, s+i)}
$$

if $r-s=2 m+1$, whereas if $r-s=2 m$ the last term in the sum must be replaced by $\left(t^{m}-t^{m-1}\right) Q_{(r-m, s+m)}$.

For simplicity we have stated these formulas for a two-term sequence ( $s, r$ ): but the same holds for any two consecutive terms of a sequence $\lambda$.
3. The definitions (2.1) and (2.2) of $P_{\lambda}$ can be written in terms of lowering operations $R_{j i}(i<j)$ :

$$
\begin{aligned}
P_{\lambda} & =v_{\lambda}(t)^{-1} \prod_{i<j}\left(1-t R_{j i}\right) s_{\lambda} \\
& =\prod_{\lambda_{1}>\lambda_{j}}\left(1-t R_{j i}\right) s_{\lambda}
\end{aligned}
$$

Hence, for example,

$$
\begin{aligned}
P_{(n)} & =\prod_{j=2}^{n}\left(1-t R_{j 1}\right) s_{(n)} \\
& =\sum_{J}(-t)^{|J|} \prod_{j \in J} R_{j 1} s_{(n)}
\end{aligned}
$$

summed over all subsets $J$ of $\{2,3, \ldots, n\}$. The only $J$ for which $\prod_{j \in J} R_{j 1} s_{(n)} \neq 0$ are $J=\{2,3, \ldots, i\}(2 \leqslant i \leqslant n)$, and therefore

$$
P_{(n)}=\sum_{r=0}^{n-1}(-t)^{r} s_{\left(n-r, 1^{1}\right)}
$$

## . The Hall algebra again

By (2.7), the product $P_{\mu} P_{\nu}$ of two Hall-Littlewood functions will be a Inear combination of the $P_{\lambda}$, where $|\lambda|=|\mu|+|\nu|(\lambda, \mu, \nu$ being partitions) with coefficients in $\mathbf{Z}[t]$ : that is to say, there exist polynomials $\int_{\mu \nu}^{\lambda}(t) \in \mathbf{Z}[t]$ such that

$$
P_{\mu}(x ; t) P_{\nu}(x ; t)=\sum_{\lambda} f_{\mu \nu}^{\lambda}(t) P_{\lambda}(x ; t) .
$$

When $t=0$ we have by (2.3)

$$
\begin{equation*}
f_{\mu \nu}^{\lambda}(0)=c_{\mu \nu}^{\lambda}, \tag{3.1}
\end{equation*}
$$

the coefficient of $s_{\lambda}$ in $s_{\mu} s_{\nu}$. Likewise, from (2.4), $f_{\mu \nu}^{\lambda}$ (1) is the coefficient of $m_{\lambda}$ in the product $m_{\mu} m_{\nu}$ when expressed as a sum of monomial symmetric functions.

In order to connect the symmetric functions $P_{\lambda}$ with the Hall algebra, we need to compute the polynomial $f_{\mu \nu}^{\lambda}(t)$ in the case $\nu=\left(1^{m}\right)$.
Recall that

$$
\left[\begin{array}{l}
n \\
r
\end{array}\right]=\varphi_{n}(t) / \varphi_{r}(t) \varphi_{n-r}(t)
$$

if $0 \leqslant r \leqslant n$ and that $\left[\begin{array}{l}n \\ r\end{array}\right]=0$ otherwise, where

$$
\varphi_{r}(t)=(1-t)\left(1-t^{2}\right) \ldots\left(1-t^{r}\right)
$$

(3.2) We have

$$
f_{\mu\left(1^{m}\right)}^{\lambda}(t)=\prod_{i \geqslant 1}\left[\begin{array}{c}
\lambda_{i}^{\prime}-\lambda_{i+1}^{\prime} \\
\lambda_{i}^{\prime}-\mu_{i}^{\prime}
\end{array}\right]
$$

(and therefore $f_{\mu\left(1^{m}\right)}^{\lambda}(t)=0$ unless $\lambda-\mu$ is a vertical $m$-strip).
Proof. We shall work with a finite set of variables $x_{1}, \ldots, x_{n}$, where $n \geqslant l(\mu)+m$. We have to multiply $P_{\mu}$, given by the formula (2.2), by $P_{\left(1^{m}\right)}$, which by (2.7) is equal to the $m$ th elementary symmetric function $e_{m}$. Let $k=\mu_{1}$ be the largest part of $\mu$, and split up the set $\left\{x_{1}, \ldots, x_{n}\right\}$ into subsets $X_{0}, \ldots, X_{k}$ (some possibly empty) such that $x_{j} \in X_{i}$ if and only if $\mu_{j}=i$, so that $\left|X_{i}\right|=m_{i}$, the multiplicity of $i$ as a part of $\mu$. Let $e_{r}\left(X_{i}\right)$ denote the elementary symmetric functions of the set of variables $X_{i}$. Since

$$
\prod_{i=1}^{n}\left(1+x_{i} t\right)=\prod_{j=0}^{k} \prod_{x_{i} \in X_{j}}\left(1+x_{i} t\right)
$$

it follows that

$$
\begin{equation*}
e_{m}\left(x_{1}, \ldots, x_{n}\right)=\sum_{r} e_{r_{0}}\left(X_{0}\right) \ldots e_{r_{k}}\left(X_{k}\right) \tag{1}
\end{equation*}
$$

summed over all $r=\left(r_{0}, \ldots, r_{k}\right) \in \mathbf{N}^{k+1}$ such that $r_{i} \leqslant m_{i}$ for each $i$ and $\sum r_{i}=m$.

To each such $\boldsymbol{r}$ there corresponds a partition $\lambda$ defined by

$$
\lambda_{i}^{\prime}=\mu_{i}^{\prime}+r_{i-1} \quad(1 \leqslant i \leqslant k+1) .
$$

Clearly $\lambda-\mu$ is a vertical $m$-strip, and conversely every partition $\lambda$ such that $\lambda-\mu$ is a vertical $m$-strip arises in this way.

Each $e_{r_{i}}\left(X_{i}\right)$ on the right-hand side of (1) is equal to $P_{\left(1^{r_{i}}\right.}\left(X_{i} ; t\right)$ by (2.7), and hence by (2.1) can be written as a sum over the symmetric group $S_{m_{i}}$ acting on the set $X_{i}$. In this way (1) takes the form

$$
\begin{equation*}
e_{m}\left(x_{1}, \ldots, x_{n}\right)=\sum_{\lambda} c_{\lambda, \mu}(t)^{-1} \Phi_{\lambda, \mu}\left(x_{1}, \ldots, x_{n} ; t\right) \tag{2}
\end{equation*}
$$

summed over all partitions $\lambda \supset \mu$ such that $\lambda-\mu$ is a vertical $m$-strip, where

$$
\Phi_{\lambda, \mu}=\sum_{w \in S_{n}^{\mu}} w\left(x_{1}^{\lambda_{1}-\mu_{1}} \ldots x_{n}^{\lambda_{n}-\mu_{n}} \prod_{\substack{i<j \\ \mu_{i}=\mu_{j}}} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}}\right)
$$

and

$$
c_{\lambda, \mu}(t)=\prod_{i=0}^{k} v_{r_{i}}(t) v_{m_{i}-r_{i}}(t)
$$

If we now multiply both sides of (2) by $P_{\mu}\left(x_{1}, \ldots, x_{n} ; t\right)$ as given by (2.2) we shall obtain

$$
P_{\mu} e_{m}=\sum_{\lambda} c_{\lambda, \mu}(t)^{-1} R_{\lambda}
$$

from which it follows that the coefficient of $P_{\lambda}$ in $P_{\mu} e_{m}$ is

$$
f_{\mu\left(1^{m}\right)}^{\lambda}(t)=v_{\lambda}(t) c_{\lambda, \mu}(t)^{-1}
$$

which easily reduces to the expression given.
If we now compare (3.2) with Chapter II, (4.6) we see that

$$
\begin{equation*}
G_{\mu\left(1^{m}\right)}^{\lambda}(\mathcal{D})=q^{n(\lambda)-n(\mu)-n\left(1^{m}\right)} f_{\mu\left(1^{m}\right)}^{\lambda}\left(q^{-1}\right) . \tag{3.3}
\end{equation*}
$$

from this we deduce the following structure theorem for the Hall algebra H(o):
(3.4) Let $\psi: H(\mathfrak{D}) \otimes_{\mathbf{Z}} \mathbf{Q} \rightarrow \Lambda_{\mathbf{Q}}$ be the $\mathbf{Q}$-linear mapping defined by

$$
\psi\left(u_{\lambda}\right)=q^{-n(\lambda)} P_{\lambda}\left(x ; q^{-1}\right)
$$

Then $\psi$ is an isomorphism of rings.
Proof. By (2.7), $\psi$ is a linear isomorphism. Since $H(0)$ is freely generated (as $\mathbf{Z}$-algebra) by the $u_{\left(1^{\prime}\right)}$ (Chapter II, (2.3)), we may define a ring fomomorphism $\psi^{\prime}: H(\mathfrak{D}) \otimes_{\mathbf{Z}} \mathbf{Q} \rightarrow \Lambda_{\mathbf{Q}}$ by

$$
\psi^{\prime}\left(u_{\left(1^{\prime}\right)}\right)=q^{-r(r-1) / 2} e_{r}
$$

We shall show that $\psi^{\prime}=\psi$, which will prove (3.4). To do this we shall prove by induction on the partition $\lambda$ that $\psi^{\prime}\left(u_{\lambda}\right)=\psi\left(u_{\lambda}\right)$. When $\lambda=0$, this is clear from the definitions. Now assume that $\lambda \neq 0$, and let $\mu$ be the partition obtained from $\lambda$ by deleting the last column. Suppose that this last column has $m$ elements. Then from Chapter II, (4.6) we have $G_{\mu\left(1^{m}\right)}^{\lambda}(\mathrm{D})$ $=1$, and $G_{\mu\left(1^{m}\right)}^{\nu}(\mathfrak{D})=0$ unless $\nu \supset \mu$ and $\nu-\mu$ is a vertical $m$-strip. Moreover, if $\nu-\mu$ is a vertical $m$-strip, it is easy to see that $\nu \leqslant \lambda$. Hence

$$
\begin{equation*}
u_{\mu} u_{\left(1^{m}\right)}=u_{\lambda}+\sum_{\nu<\lambda} G_{\mu\left(1^{m}\right)}^{\nu}(\mathfrak{D}) u_{\nu} \tag{1}
\end{equation*}
$$

and likewise

$$
\begin{equation*}
P_{\mu} P_{\left(1^{m}\right)}=P_{\lambda}+\sum_{\nu<\lambda} f_{\mu\left(1^{m}\right)}^{\nu}\left(q^{-1}\right) P_{\nu} \tag{2}
\end{equation*}
$$

where $P_{\mu}$ stands for $P_{\mu}\left(x ; q^{-1}\right)$, and so on. If we now apply $\psi^{\prime}$ to both sides of (1) and recall that $P_{\left(1^{m}\right)}=e_{m}$ by (2.7), and compare the result with (2), taking as inductive hypothesis that $\psi^{\prime}\left(u_{\nu}\right)=q^{-n(\nu)} P_{\nu}$ for all $\nu<\lambda$, then it follows from (3.3) that $\psi^{\prime}\left(u_{\lambda}\right)=q^{-n(\lambda)} P_{\lambda}=\psi\left(u_{\lambda}\right)$.

Remark. This proof depends on the identity (3.3), which appears as merely a happy accident. It is possible to give a proof of (3.4) which does not depend on an apparent miracle: see the notes at the end of Chapter V.

From (3.4) it follows that

$$
\begin{equation*}
G_{\mu \nu}^{\lambda}(\mathcal{D})=q^{n(\lambda)-n(\mu)-n(\nu)} f_{\mu \nu}^{\lambda}\left(q^{-1}\right) \tag{3.5}
\end{equation*}
$$

for any three partitions $\lambda, \mu, \nu$, and therefore by Chapter II, (4.3) the polynomials $f_{\mu \nu}^{\lambda}$ are related to the Hall polynomials $g_{\mu \nu}^{\lambda}$ of Chapter II as follows:

$$
\begin{equation*}
g_{\mu \nu}^{\lambda}(t)=t^{n(\lambda)-n(\mu)-n(\nu)} f_{\mu \nu}^{\lambda}\left(t^{-1}\right) \tag{3.6}
\end{equation*}
$$

In particular:
(3.7) (i) If $f_{\mu \nu}^{\lambda}(0)=0$, then $f_{\mu \nu}^{\lambda}(t)$ is identically zero.
(ii) $f_{\mu \nu}^{\lambda}(t)=0$ unless $|\lambda|=|\mu|+|\nu|$ and $\mu, \nu \subset \lambda$.

The results of Chapter II, §4 (especially (4.2) and (4.11)) provide an explicit formula for $f_{\mu \nu}^{\lambda}(t)$, namely

$$
\begin{equation*}
f_{\lambda \mu}(t)=\sum_{S} f_{\mathcal{S}}(t) \tag{3.8}
\end{equation*}
$$

summed over $L R$-sequences of type ( $\mu^{\prime}, \nu^{\prime} ; \lambda^{\prime}$ ), where in the notation of Chapter II, (4.10) and (4.11)

$$
\begin{equation*}
f_{S}(t)=\prod_{i \geqslant j} \Phi\left(a_{i j}, b_{i j}, c_{i j} ; N_{i j} ; t\right) . \tag{3.9}
\end{equation*}
$$

In particular:
(3.10) If $\lambda \supset \mu$ and $\theta=\lambda-\mu$ is a horizontal $r$-strip, then

$$
f_{\mu(r)}^{\lambda}(t)=(1-t)^{-1} \prod_{i \in I}\left(1-t^{m_{i}(\lambda)}\right)
$$

where $I$ is the set of positive integers $i$ such that $\theta_{i}^{\prime}>\theta_{i+1}^{\prime}$ (so that $\theta_{i}^{\prime}=1$ and $\theta_{i+1}^{\prime}=0$ ) and $m_{i}(\lambda)$ is the multiplicity of $i$ as a part of $\lambda$. In all other cases $f_{\mu(r)}^{\lambda}(t)=0$.

In view of (3.6), this is simply a transcription of Chapter II, (4.13).
Remark. We have arrived at this result (which we shall later make use of) by an indirect route, via the Hall algebra. It is also possible to derive (3.10) directly from the definition of the $P_{\lambda}(x ; t)$ : see Morris [M13].

## Examples

1. Let $\lambda$ be a partition. Then for each $m \geqslant 0$,

$$
\sum_{\mu} G_{\mu\left(1^{m}\right)}^{\lambda}(\mathfrak{o})
$$

is the number of elementary submodules $E$ of type $\left(1^{m}\right)$ in a fixed o -module $M$ of type $\lambda$. All these submodules $E$ lie in the socle $S$ of $M$, which is a $k$-vector space of dimension $l=l(\lambda)$, and the sum above is therefore equal to the number of $m$-dimensional subspaces of an $l$-dimensional vector space over a finite field with $q$ elements, which is $\left[\begin{array}{c}l \\ m\end{array}\right](q)$. Hence by (3.3) we obtain

$$
\sum_{\mu} t^{n(\mu)} f_{\mu\left(l^{m}\right)}^{\lambda}(t)=t^{n(\lambda)-m(m-1) / 2}\left[\begin{array}{l}
l \\
m
\end{array}\right]\left(t^{-1}\right)
$$

Now let $y$ be an indeterminate. Then

$$
\begin{aligned}
\left(\sum_{\mu} t^{n(\mu)} P_{\mu}\right)\left(\sum_{m} e_{m} y^{m}\right) & =\sum_{\lambda, \mu, m} y^{m} t^{n(\mu)} f_{\mu\left(1^{m}\right)}^{\lambda}(t) P_{\lambda} \\
& =\sum_{\lambda} t^{n(\lambda)} P_{\lambda} \sum_{m} y^{m} t^{-m(m-1) / 2}\left[\begin{array}{c}
l(\lambda) \\
m
\end{array}\right]\left(t^{-1}\right) \\
& =\sum_{\lambda} t^{n(\lambda)} P_{\lambda} \prod_{j=1}^{l(\lambda)}\left(1+t^{1-j} y\right)
\end{aligned}
$$

by the identity of Chapter I, §2, Example 3. In particular, when $y=-1$ we obtain

$$
\left(\sum_{\mu} t^{n(\mu)} P_{\mu}\right)\left(\sum_{m}(-1)^{m} e_{m}\right)=1
$$

and therefore

$$
\begin{equation*}
\sum_{|\mu|=n} t^{n(\mu)} P_{\mu}=h_{n} \tag{2}
\end{equation*}
$$

Hence the identity (1) takes the form

$$
\begin{equation*}
\prod_{i>1}\left(1+x_{i} y\right) /\left(1-x_{i}\right)=\sum_{\lambda} t^{n(\lambda)} \prod_{j=1}^{l(\lambda)}\left(1+t^{1-j} y\right) \cdot P_{\lambda}(x ; t) . \tag{3}
\end{equation*}
$$

2. (a) Let

$$
\tilde{P}_{\lambda}=q^{-n(\lambda)} P_{\lambda}\left(x ; q^{-1}\right), \quad \tilde{Q}_{\lambda}=q^{|\lambda|+n(\lambda)} Q_{\lambda}\left(x ; q^{-1}\right)
$$

so that $\tilde{Q}_{\lambda}=a_{\lambda}(q) \tilde{P}_{\lambda}$, where by Chapter II, (1.6) $a_{\lambda}(q)$ is the order of the automorphism group Aut $M_{\lambda}$ of an $\mathfrak{D}$-module of type $\lambda$. From $\S 2$, Example 1 it follows that the specialization $x_{i} \mapsto q^{-i}(i \geqslant 1)$ maps each $\tilde{Q}_{\lambda}$ to 1 and hence $\tilde{P}_{\lambda}$ to $a_{\lambda}(q)^{-1}$. Hence from (3.4) the mapping $u_{\lambda} \mapsto \mid$ Aut $\left.M_{\lambda}\right|^{-1}$ of the Hall algebra $H(\mathfrak{o})$ into $\mathbf{Q}$ is multiplicative, i.e. is a character of $H(\mathfrak{D})$.
(b) From Example 1 above we have

$$
\sum_{|\lambda|=n} \tilde{P}_{\lambda}=h_{n}
$$

and therefore, specializing as above,

$$
\sum_{|\lambda|=n} \mid \text { Aut }\left.M_{\lambda}\right|^{-1}=h_{n}\left(q^{-1}, q^{-2}, \ldots\right)
$$

Hence

$$
\sum_{\lambda} \mid \text { Aut }\left.M_{\lambda}\right|^{-1}=\prod_{i>1}\left(1-q^{-i}\right)^{-1}=\sum_{\lambda} q^{-|\lambda|}
$$

or equivalently

$$
\sum_{\lambda} \mid \text { Aut }\left.M_{\lambda}\right|^{-1}=\sum_{\lambda}\left|M_{\lambda}\right|^{-1}
$$

as convergent infinite series.
(c) More generally, the identity (3) of Example 1 above leads to

$$
\sum_{\lambda} \frac{(x ; q)_{l(\lambda)}}{\mid \text { Aut } M_{\lambda} \mid}=\prod_{i \geqslant 1} \frac{1-x q^{-i}}{1-q^{-i}}
$$

where $(x ; q)_{n}=(1-x)(1-q x) \ldots\left(1-q^{n-1} x\right)$.
3. (a) Let $\mu=\left(\mu^{(1)}, \ldots, \mu^{(r)}\right)$ be any sequence of partitions, and let

$$
v_{\mu}\left(M_{\lambda}\right)=g_{\mu^{(1)} \ldots \mu^{(2)}}^{\lambda}(q)
$$

be the number of chains of submodules

$$
M_{\lambda}=M_{0} \supset M_{1} \supset \ldots \supset M_{r}=0
$$

such that $M_{i-1} / M_{i}$ has type $\mu^{(i)}$, for $1 \leqslant i \leqslant r$. Show that

$$
\begin{equation*}
\sum_{\lambda} \frac{v_{\mu}\left(M_{\lambda}\right)}{\mid \text { Aut } M_{\lambda} \mid}=\prod_{i=1}^{r}\left|\operatorname{Aut} M_{\mu}^{(i)}\right|^{-1} . \tag{1}
\end{equation*}
$$

In particular, if $v\left(M_{\lambda}\right)$ is the number of composition series of $M_{\lambda}$, then

$$
\sum_{|\lambda|=r} \frac{v\left(M_{\lambda}\right)}{\mid \text { Aut } M_{\lambda} \mid}=\frac{1}{(q-1)^{r}} .
$$

(Specialize the identity

$$
\sum_{\lambda} g_{\mu^{(1)} \ldots \mu^{(r)}}^{\lambda}(q) u_{\lambda}=u_{\mu^{(1)}} \ldots u_{\mu^{(r)}}
$$

as in Example 2 above.)
(b) Let $H=\left(H_{1}, \ldots, H_{r}\right)$ be any sequence of finite abelian groups, and for each finite abelian group $G$ let $v_{H}(G)$ denote the number of chains of subgroups

$$
G=G_{0} \geqslant G_{1} \geqslant \ldots \geqslant G_{r}=0
$$

such that $G_{i-1} / G_{i} \cong H_{i}$ for $1 \leqslant i \leqslant r$. Show that

$$
\sum_{(G)} \frac{v_{H}(G)}{|\operatorname{Aut} G|}=\prod_{i=1}^{r}\left|\operatorname{Aut} H_{i}\right|^{-1}
$$

where the sum on the left is over all isomorphism classes of finite abelian groups. (Split $G$ and the $H_{i}$ into their $p$-primary components, and use (a) above.)
4. The fact (Example 2 (a)) that $u_{\lambda} \rightarrow a_{\lambda}(q)^{-1}$ is a character of the Hall algebra $H(0)$ is equivalent to the following relation:

$$
\begin{equation*}
\sum_{\lambda} a_{\lambda}(q)^{-1} a_{\mu}(q) a_{\nu}(q) g_{\mu \nu}^{\lambda}(q)=1 \tag{1}
\end{equation*}
$$

for all partitions $\mu, \nu$. This may be proved directly as follows.
Fix $\boldsymbol{0}$-modules $L, M, N$ of respective types $\lambda, \mu, \nu$, and let $E_{M N}^{L}$ denote the set of all exact sequences

$$
E(\alpha, \beta): 0 \rightarrow N \xrightarrow{\alpha} L \xrightarrow{\beta} M \rightarrow 0 .
$$

In such an exact sequence, $N^{\prime}=\alpha(N)$ is a submodule of $L$ of type $\nu$, with $L / N^{\prime} \cong M$ of type $\mu$; hence the number of choices for $N^{\prime}$ is $g_{\mu \nu}^{\lambda}(q)$. Given $N^{\prime}$, there are $a_{\nu}(q)$ choices for $\alpha$, and $a_{\mu}(q)$ choices for $\beta$, and therefore

$$
e_{M N}^{L}=\left|E_{M N}^{L}\right|=a_{\mu}(q) a_{\nu}(q) g_{\mu \nu}^{\lambda}(q) .
$$

Hence (1) is equivalent to

$$
\begin{equation*}
\sum_{(L)} a_{L}^{-1} e_{M N}^{L}=1 \tag{2}
\end{equation*}
$$

where $a_{L}=\mid$ Aut $L \mid$ and the sum is over isomorphism classes of finite $\mathfrak{0}$-modules $L$.
The group Aut $L$ acts on $E_{M N}^{L}$ by $\varphi E(\alpha, \beta)=E\left(\varphi \alpha, \beta \varphi^{-1}\right)$, and it is not difficult to verify that $\varphi \in$ Aut $L$ fixes $E(\alpha, \beta)$ if and only if $\varphi=1+\alpha \theta \beta$, where $\theta \in \operatorname{Hom}(M, N)$. Hence the orbits are all of size $a_{L} / h$, where $h=|\operatorname{Hom}(M, N)|$, and the number of them is therefore $a_{L}^{-1} e_{M N}^{L} h$.
On the other hand, the orbits of Aut $L$ in $E_{M N}^{L}$, for all $L$, are the equivalence classes of extensions of $M$ by $N$ (see e.g. [C1], Chapter XIV) and are in one-one correspondence with the elements of $\operatorname{Ext}^{1}(M, N)$. Now $\operatorname{Ext}^{1}(M, N)$ and $\operatorname{Hom}(M, N)$ are finite $\mathfrak{0}$-modules of the same type $\mu \times \nu$ (Chapter II, $\S 1$, Example) and in particular have the same order $h\left(=q^{|\mu \times \nu|}\right)$. Hence we have

$$
\sum_{(L)} a_{L}^{-1} e_{M N}^{L} h=h
$$

which proves (2) and therefore also (1).
5. Let $\mu=\left(\mu_{1}, \ldots, \mu_{r}\right)$ be a partition of length $r$, and for a finite $\boldsymbol{o}$-module $M$ let $w_{\mu}(M)$ denote the number of chains of submodules

$$
M=M_{0} \supset M_{1} \supset \ldots \supset M_{r}=0
$$

such that $\left|M_{i-1} / M_{i}\right|=q^{\mu_{i}}$ for $1 \leqslant i \leqslant r$. Thus

$$
w_{\mu}\left(M_{\lambda}\right)=\sum g_{\nu^{(1)} \ldots \nu^{(r)}}^{\lambda}(q)
$$

summed over all sequences $\left(\nu^{(1)}, \ldots, \nu^{(r)}\right.$ ) of partitions such that $\left|\nu^{(i)}\right|=\mu_{i}$ for $1 \leqslant i \leqslant r$. From Example 2 it follows that

$$
\sum_{\lambda} w_{\mu}\left(M_{\lambda}\right) \tilde{P_{\lambda}}=h_{\mu}
$$

and hence that

$$
\begin{equation*}
\sum_{\lambda} \frac{w_{\mu}\left(M_{\lambda}\right)}{\left|\operatorname{Aut} M_{\lambda}\right|}=h_{\mu}\left(q^{-1}, q^{-2}, \ldots\right) \tag{1}
\end{equation*}
$$

Since (Chapter I, §2, Example 4)

$$
\begin{aligned}
h_{r}\left(q^{-1}, q^{-2}, \ldots\right) & =q^{-r} / \varphi_{r}\left(q^{-1}\right) \\
& =q^{r(r-1) / 2} /(q-1) \ldots\left(q^{r}-1\right)
\end{aligned}
$$

we may rewrite (1) in the form

$$
\begin{equation*}
\sum_{\lambda} \frac{w_{\mu}\left(M_{\lambda}\right)}{\left|\operatorname{Aut} M_{\lambda}\right|}=q^{n\left(\mu^{\prime}\right)} \prod_{i>1}\left(q^{i}-1\right)^{-\mu_{i}^{\prime}} \tag{2}
\end{equation*}
$$

In particular, when $r=2$ and $\mu=(n-k, k), w_{\mu}\left(M_{\lambda}\right)$ is the number of submod. ules of $M_{\lambda}$ of order $q^{k}$. More particularly still, when $\mu=(n-1,1), w_{\mu}\left(M_{\lambda}\right)$ is the number of submodules of $M_{\lambda}$ of order $q$. These all lie in the socle, which is a $k$-vector space of dimension $l(\lambda)$, so that $w_{\mu}\left(M_{\lambda}\right)=\left(q^{l(\lambda)}-1\right) /(q-1)$ when $\mu=$ ( $n-1,1$ ). Deduce that

$$
\sum_{\lambda} \frac{q^{l(\lambda)} t^{|\lambda|}}{\left|\operatorname{Aut} M_{\lambda}\right|}=\frac{1+t}{\prod_{i>1}\left(1-q^{-i} t\right)}
$$

where the sum on the left is over all partitions $\lambda$.

## Notes and References

The identities of Examples 2(b) and 3(a) are due to P. Hall [H1], [H2]. See also [M4].

## 4. Orthogonality

We shall now generalize the developments of Chapter I, $\S 4$ by giving three series expansions for the product

$$
\prod_{i, j}\left(1-t x_{i} y_{j}\right) /\left(1-x_{i} y_{j}\right) .
$$

The first of these is

$$
\begin{equation*}
\prod_{i, j}\left(1-t x_{i} y_{i}\right) /\left(1-x_{i} y_{j}\right)=\sum_{\lambda} z_{\lambda}(t)^{-1} p_{\lambda}(x) p_{\lambda}(y) \tag{4.1}
\end{equation*}
$$

summed over all partitions $\lambda$, where

$$
z_{\lambda}(t)=z_{\lambda} \cdot \prod_{i>1}\left(1-t^{\lambda_{i}}\right)^{-1}
$$

We have

$$
\begin{aligned}
\log \prod_{i, j}\left(1-t x_{i} y_{j}\right) /\left(1-x_{i} y_{j}\right) & =\sum_{i, j}\left(\log \left(1-t x_{i} y_{j}\right)-\log \left(1-x_{i} y_{j}\right)\right) \\
& =\sum_{i, j} \sum_{m=1}^{\infty} \frac{1-t^{m}}{m}\left(x_{i} y_{j}\right)^{m} \\
& =\sum_{m=1}^{\infty} \frac{1-t^{m}}{m} p_{m}(x) p_{m}(y)
\end{aligned}
$$

Ind therefore

$$
\begin{aligned}
\prod_{i, j}\left(1-t x_{i} y_{j}\right) /\left(1-x_{i} y_{j}\right) & =\prod_{m=1}^{\infty} \exp \left(\frac{1-t^{m}}{m} p_{m}(x) p_{m}(y)\right) \\
& =\prod_{m=1}^{\infty} \sum_{r_{m}=0}^{\infty} \frac{\left(1-t^{m}\right)^{r_{m}}}{m^{r_{m}} \cdot r_{m}!} p_{m}(x)^{r_{m}} p_{m}(y)^{r_{m}} \\
& =\sum_{\lambda} z_{\lambda}(t)^{-1} p_{\lambda}(x) p_{\lambda}(y) .
\end{aligned}
$$

Next we have

$$
\begin{align*}
\prod_{i, j}\left(1-t x_{i} y_{j}\right) /\left(1-x_{i} y_{j}\right) & =\sum_{\lambda} q_{\lambda}(x ; t) m_{\lambda}(y)  \tag{4,2}\\
& =\sum_{\lambda} m_{\lambda}(x) q_{\lambda}(y ; t)
\end{align*}
$$

summed over all partitions $\lambda$.
Proof. From (2.10) it follows that

$$
\prod_{i, j}\left(1-t x_{i} y_{j}\right) /\left(1-x_{i} y_{j}\right)=\prod_{j} \sum_{r_{j}=0}^{\infty} q_{r_{j}}(x ; t) y_{j}^{r_{j}}
$$

and the product on the right, when multiplied out, is equal to

$$
\sum_{\lambda} q_{\lambda}(x ; t) m_{\lambda}(y) .
$$

Likewise with the $x$ 's and $y$ 's interchanged. |

- From (4.2) it follows that
(4.3) The transition matrix $M(q, m)$ is symmetric.

Next, in generalization of Chapter I, (4.3) we have

$$
\begin{align*}
\prod_{i, j}\left(1-t x_{i} y_{j}\right) /\left(1-x_{i} y_{j}\right) & =\sum_{\lambda} P_{\lambda}(x ; t) Q_{\lambda}(y ; t)  \tag{4.4}\\
& =\sum_{\lambda} b_{\lambda}(t) P_{\lambda}(x ; t) P_{\lambda}(y ; t)
\end{align*}
$$

Proof. Consider the transition matrices

$$
A=M(q, Q), \quad B=M(m, Q), \quad C=M(q, m)
$$

and let $D=B^{\prime} A$. By (2.16), $A^{-1}$ is lower unitriangular, hence so is $A$. Also $B$ is upper triangular, because

$$
B^{-1}=M(Q, P) M(P, s) M(s, m)
$$

and $M(Q, P)$ is diagonal by (2.11), $M(P, s)$ is upper triangular by (2.6), and $M(s, m)$ is upper triangular by Chapter I, (6.5). It follows that $D$ is lower triangular. On the other hand, $D=B^{\prime} C B$, and $C$ is symmetric by (4.3); hence $D$ is symmetric as well as triangular, and is therefore a diagonal matrix, with diagonal elements equal to those of $B$, so that $D=M(P, Q)$ and therefore $D_{\lambda \lambda}=b_{\lambda}(t)^{-1}$.

Hence

$$
\begin{aligned}
\sum_{\lambda} q_{\lambda}(x ; t) m_{\lambda}(y) & =\sum_{\lambda, \mu, \nu} A_{\lambda \mu} B_{\lambda \nu} Q_{\mu}(x ; t) Q_{\nu}(y ; t) \\
& =\sum_{\mu} b_{\mu}(t)^{-1} Q_{\mu}(x ; t) Q_{\mu}(y ; t) \\
& =\sum_{\mu} P_{\mu}(x ; t) Q_{\mu}(y ; t)
\end{aligned}
$$

and so (4.4) follows from (4.2).
Remark. There is yet another expansion for $\Pi\left(1-t x_{i} y_{j}\right) /\left(1-x_{i} y_{j}\right)$. Let us define

$$
\begin{equation*}
S_{\lambda}(x ; t)=\operatorname{det}\left(q_{\lambda_{1}-i+j}(x ; t)\right) \tag{4.5}
\end{equation*}
$$

for any partition $\lambda$, so that

$$
\begin{equation*}
S_{\lambda}(x ; t)=\prod_{i<j}\left(1-R_{i j}\right) q_{\lambda}=\prod_{i<j}\left(1-t R_{i j}\right) Q_{\lambda} \tag{4.6}
\end{equation*}
$$

by Chapter I, (3.4") and (2.14'). If we introduce a set of (fictitious) variables $\xi_{i}$ by means of

$$
\prod_{i}\left(1-t x_{i} y\right) /\left(1-x_{i} y\right)=\prod_{i}\left(1-\xi_{i} y\right)^{-1}
$$

then $q_{r}(x ; t)=h_{r}(\xi)$ and therefore $S_{\lambda}(x ; t)=s_{\lambda}(\xi)$ by Chapter I , (3.4). Hence from Chapter I, (4.3) we have

$$
\begin{align*}
\prod_{i, j}\left(1-t x_{i} y_{j}\right) /\left(1-x_{i} y_{i}\right) & =\sum_{\lambda} S_{\lambda}(x ; t) s_{\lambda}(y)  \tag{4.7}\\
& =\sum_{\lambda} s_{\lambda}(x) S_{\lambda}(y ; t) .
\end{align*}
$$

We now define a scalar product on $\Lambda[t]$ (with values in $\mathbf{Q}(t)$ ) by requiring that the bases $\left(q_{\lambda}(x ; t)\right.$ ) and ( $m_{\lambda}(x)$ ) be dual to each other:

$$
\begin{equation*}
\left\langle q_{\lambda}(x ; t), m_{\mu}(x)\right\rangle=\delta_{\lambda \mu} . \tag{4.8}
\end{equation*}
$$

The same considerations as in Chapter I, §4, applied to the identities (4.1), (4.4), and (4.7) show that

$$
\begin{equation*}
\left\langle P_{\lambda}(x ; t), Q_{\mu}(x ; t)\right\rangle=\delta_{\lambda \mu}, \tag{4.9}
\end{equation*}
$$

$$
\begin{equation*}
\left\langle S_{\lambda}(x ; t), s_{\mu}(x)\right\rangle=\delta_{\lambda \mu}, \tag{4.10}
\end{equation*}
$$

$$
\begin{equation*}
\left\langle p_{\lambda}(x), p_{\mu}(x)\right\rangle=z_{\lambda}(t) \delta_{\lambda \mu} . \tag{4.11}
\end{equation*}
$$

(4.12) The bilinear form $\langle u, v\rangle$ on $\Lambda[t]$ is symmetric.

When $t=0$, this scalar product specializes to that of Chapter I, because $P_{\lambda}(x ; 0)=Q_{\lambda}(x ; 0)=s_{\lambda}(x)$. When $t=1$ it collapses, because $b_{\lambda}(1)=0$ and therefore $Q_{\lambda}(x ; 1)=0$ for all partitions $\lambda \neq 0$.

Remark. Since $z_{\lambda}(t)=z_{\lambda} p_{\lambda}\left(1, t, t^{2}, \ldots\right)$, it follows from (4.11) and Chapter I , (7.12) that the scalar product (4.8) is given by

$$
\begin{equation*}
\langle f, g\rangle=(f * g)\left(1, t, t^{2}, \ldots\right) \tag{4.13}
\end{equation*}
$$

for all $f, g \in \Lambda[t]$ where $f * g$ is the internal product of $f$ and $g$ defined in Chapter I, §7.

## Examples

1. By taking $y_{i}=t^{i-1}$ for all $i \geqslant 1$ in (4.4) and making use of $\S 2$, Example 1 , we obtain

$$
\sum_{\lambda} t^{n(\lambda)} P_{\lambda}(x ; t)=\Pi\left(1-x_{i}\right)^{-1},
$$

so that

$$
\sum_{|\lambda|=n} t^{n(\lambda)} P_{\lambda}(x ; t)=h_{n}(x) .
$$

(See also §3, Example 1.)
2. By applying the involution $\omega$ (Chapter $I, \S 2$ ) to the $y$-variables in (4.7) we obtain

$$
\sum_{\lambda} S_{\lambda}(x ; t) s_{\lambda^{\prime}}(y)=\prod_{i, j}\left(1+x_{i} y_{j}\right) /\left(1+t x_{i} y_{j}\right)
$$

Now take $y_{i}=t^{i-1}$ for all $i \geqslant 1$; then (Chapter $\mathrm{I}, \S 3$, Example 2)

$$
s_{\lambda^{\prime}}(y)=t^{n\left(\lambda^{\prime}\right)} H_{\lambda}(t)^{-1}
$$

and therefore

$$
\sum_{\lambda} S_{\lambda}(x ; t) t^{n\left(\lambda^{\prime}\right)} H_{\lambda}(t)^{-1}=\prod\left(1+x_{i}\right)
$$

3. For each integer $n \geqslant 0$, under the specialization

$$
p_{r} \mapsto\left(1-t^{n r}\right) /\left(1-t^{r}\right) \quad(r \geqslant 1)
$$

$Q_{\lambda}(x ; t)$ specializes to

$$
t^{n(\lambda)} \prod_{i=1}^{l(\lambda)}\left(1-t^{n-i+1}\right)
$$

( $\S 2$, Example 1). Since this is true for all $n \geqslant 0$, we may replace $t^{n}$ by an indeterminate $u$ : under the specialization

$$
p_{r} \mapsto\left(1-u^{r}\right) /\left(1-t^{r}\right) \quad(r \geqslant 1)
$$

$Q_{\lambda}(x ; t)$ specializes to

$$
t^{n(\lambda)} \prod_{i=1}^{l(\lambda)}\left(1-t^{1-i} u\right) .
$$

By applying this specialization to the $y$-variables in (4.4), we obtain another proof of the identity (3) of $\S 3$, Example 1.

## Notes and references

The identity (4.4) is equivalent to the orthogonality relations for Green's polynomials (\$7). The proof given here is due to Littlewood [L12].

## 5. Skew Hall-Littlewood functions

Since the symmetric functions $P_{\lambda}$ form a basis of $\Lambda[t]$, any symmetric function $u$ is uniquely determined by its scalar products with the $P_{\lambda}$ : for by (4.9) we have

$$
u=\sum_{\lambda}\left\langle u, P_{\lambda}\right\rangle Q_{\lambda}
$$

In particular, for each pair of partitions $\lambda, \mu$ we may define a symmetric function $Q_{\lambda / \mu}$ by

$$
\begin{equation*}
\left\langle Q_{\lambda / \mu}, P_{\nu}\right\rangle=\left\langle Q_{\lambda}, P_{\mu} P_{\nu}\right\rangle=f_{\nu \mu}^{\lambda}(t) \tag{5.1}
\end{equation*}
$$

or equivalently

$$
\begin{equation*}
Q_{\lambda / \mu}=\sum_{\nu} f_{\mu \nu}^{\lambda}(t) Q_{\nu} \tag{5.2}
\end{equation*}
$$

Since $f_{\mu \nu}^{\lambda}(t)=0$ unless $\mu \subset \lambda$ (3.7), it follows that
(5.3) $Q_{\lambda / \mu}=0$ unless $\mu \subset \lambda$.

From (5.1) we have $\left\langle Q_{\lambda / \mu}, u\right\rangle=\left\langle Q_{\lambda}, P_{\mu} u\right\rangle$ for any symmetric function $u$. In particular, when $\mu=0$ it follows that $Q_{\lambda / 0}=Q_{\lambda}$. When $t=0, Q_{\lambda / \mu}$ reduces to the skew Schur function $s_{\lambda / \mu}$.
Likewise we define $P_{\lambda / \mu}$ by interchanging the $P$ 's and $Q$ 's in (5.1):

$$
\begin{equation*}
\left\langle P_{\lambda / \mu}, Q_{\nu}\right\rangle=\left\langle P_{\lambda}, Q_{\mu} Q_{\nu}\right\rangle \tag{5.1'}
\end{equation*}
$$

for all partitions $\nu$. Since $Q_{\lambda}=b_{\lambda}(t) P_{\lambda}$ it follows that

$$
\begin{equation*}
Q_{\lambda / \mu}=b_{\lambda / \mu}(t) P_{\lambda / \mu} \tag{5.4}
\end{equation*}
$$

where $b_{\lambda / \mu}(t)=b_{\lambda}(t) / b_{\mu}(t)$.
From (5.2) it follows that

$$
\begin{aligned}
\sum_{\lambda} Q_{\lambda / \mu}(x ; t) P_{\lambda}(y ; t) & =\sum_{\lambda, \nu} f_{\mu \nu}^{\lambda}(t) Q_{\nu}(x ; t) P_{\lambda}(y ; t) \\
& =\sum_{\nu} Q_{\nu}(x ; t) P_{\mu}(y ; t) P_{\nu}(y ; t)
\end{aligned}
$$

and therefore by (4.4)

$$
\sum_{\lambda} Q_{\lambda / \mu}(x ; t) P_{\lambda}(y ; t)=P_{\mu}(y, t) \prod_{i, j} \frac{1-t x_{i} y_{j}}{1-x_{i} y_{j}}
$$

From this we have

$$
\begin{aligned}
\sum_{\lambda, \mu} & Q_{\lambda / \mu}(x ; t) P_{\lambda}(y ; t) Q_{\mu}(z ; t) \\
& =\sum_{\mu} P_{\mu}(y ; t) Q_{\mu}(z ; t) \prod_{i, j} \frac{1-t x_{i} y_{j}}{1-x_{i} y_{j}} \\
& =\prod_{i, j} \frac{1-t x_{i} y_{j}}{1-x_{i} y_{j}} \prod_{j, k} \frac{1-t y_{j} z_{k}}{1-y_{j} z_{k}}
\end{aligned}
$$

which by (4.4) again is equal to

$$
\sum_{\lambda} Q_{\lambda}(x, z ; t) P_{\lambda}(y ; t) .
$$

Consequently,

$$
\begin{equation*}
Q_{\lambda}(x, z ; t)=\sum_{\mu} Q_{\lambda / \mu}(x ; t) Q_{\mu}(z ; t) \tag{5.5}
\end{equation*}
$$

where by (5.3) the summation is over partitions $\mu \subset \lambda$. Likewise,

$$
P_{\lambda}(x, z ; t)=\sum_{\mu} P_{\lambda / \mu}(x ; t) P_{\mu}(z ; t) .
$$

Just as in Chapter I, §5, these formulas enable us to express the symmetric functions $P_{\lambda / \mu}$ and $Q_{\lambda / \mu}$ as sums of monomials. Since ( $m_{\nu}$ ) and ( $q_{\nu}$ ) are dual bases for the scalar product (4.8), it follows that

$$
\begin{align*}
Q_{\lambda / \mu} & =\sum_{\nu}\left\langle Q_{\lambda / \mu}, q_{\nu}\right\rangle m_{\nu}  \tag{5.6}\\
& =\sum_{\nu}\left\langle Q_{\lambda}, P_{\mu} q_{\nu}\right\rangle m_{\nu}
\end{align*}
$$

Now from (3.10) we have

$$
\begin{equation*}
P_{\mu} q_{r}=\sum_{\lambda} \varphi_{\lambda / \mu}(t) P_{\lambda} \tag{5.7}
\end{equation*}
$$

summed over all partitions $\lambda$ such that $\theta=\lambda-\mu$ is a horizontal $r$-strip, where

$$
\begin{equation*}
\varphi_{\lambda / \mu}(t)=\prod_{i \in I}\left(1-t^{m_{i}(\lambda)}\right) \tag{5.8}
\end{equation*}
$$

in which $I$ is the set of integers $i \geqslant 1$ such that $\theta_{i}^{\prime}>\theta_{i+1}^{\prime}$ (i.e. $\theta_{i}^{\prime}=1$ and $\theta_{i+1}^{\prime}=0$ ).

We shall use (5.7) to express $P_{\mu} q_{\nu}$, where $\mu$ and $\nu$ are any partitions, as a linear combination of the $P_{\lambda}$. Let $T$ be a tableau (Chapter I, $\S 1$ ) of shape $\lambda-\mu$ and weight $\nu$. Then $T$ determines (and is determined by) a sequence of partitions $\left(\lambda^{(0)}, \ldots, \lambda^{(r)}\right)$ such that $\mu=\lambda^{(0)} \subset \lambda^{(1)} \subset \ldots \subset \lambda^{(r)}=\lambda$ and such that each $\lambda^{(i)}-\lambda^{(i-1)}$ is a horizontal strip. Let

$$
\begin{equation*}
\varphi_{T}(t)=\prod_{i=1}^{r} \varphi_{\lambda^{(i)} / \lambda^{(l-1)}}(t) \tag{5.9}
\end{equation*}
$$

then we have

$$
\begin{equation*}
P_{\mu} q_{\nu}=\sum_{\lambda}\left(\sum_{T} \varphi_{T}(t)\right) P_{\lambda} \tag{5.10}
\end{equation*}
$$

summed over all partitions $\lambda \supset \mu$ such that $|\lambda-\mu|=|\nu|$, the inner sum being over all tableaux $T$ of shape $\lambda-\mu$ and weight $\nu$. This is a direct consequence of (5.7) and induction on the length of $\nu$.
From (5.6) and (5.10) it follows that

$$
\begin{equation*}
Q_{\lambda / \mu}=\sum_{T} \varphi_{T}(t) x^{T} \tag{5.11}
\end{equation*}
$$

summed over all tableaux $T$ of shape $\lambda-\mu$, where as in Chapter I, (5.13) $x^{T}$ is the monomial defined by the tableau $T$.

There is an analogous result for $P_{\lambda / \mu}$. First, when $\lambda-\mu=\theta$ is a horizontal strip, we define

$$
\psi_{\lambda / \mu}(t)=\prod_{j \in J}\left(1-t^{m_{j}(\mu)}\right)
$$

where $J$ is the set of integers $j \geqslant 1$ such that $\theta_{j}^{\prime}<\theta_{j+1}^{\prime}$ (i.e. $\theta_{j}^{\prime}=0$ and $\theta_{j+1}^{\prime}=1$ ), and then we define

$$
\psi_{T}(t)=\prod_{i=1}^{r} \psi_{\lambda^{(i)} / \lambda^{(i-1)}(t)}
$$

for a tableau $T$ as above. It is easily verified that

$$
\begin{equation*}
\varphi_{\lambda / \mu}(t) / \psi_{\lambda / \mu}(t)=b_{\lambda}(t) / b_{\mu}(t) \tag{5.12}
\end{equation*}
$$

and hence that

$$
\begin{equation*}
\varphi_{T}(t) / \psi_{T}(t)=b_{\lambda}(t) / b_{\mu}(t) \tag{5.13}
\end{equation*}
$$

if $T$ has shape $\lambda-\mu$. From (5.4), (5.11), and (5.13) it follows that

$$
\begin{equation*}
P_{\lambda / \mu}=\sum_{T} \psi_{T}(t) x^{T} \tag{5.11'}
\end{equation*}
$$

summed over all tableaux $T$ of shape $\lambda-\mu$.
Also, in place of (5.7) we have

$$
\begin{equation*}
Q_{\mu} q_{r}=\sum_{\lambda} \psi_{\lambda / \mu}(t) Q_{\lambda} \tag{5.7'}
\end{equation*}
$$

summed over all $\lambda \supset \mu$ such that $\lambda-\mu$ is a horizontal $r$-strip, by virtue of (5.7) and (5.12).

Remarks. 1. Whereas the skew Schur function $s_{\lambda / \mu}$ depends only on the difference $\lambda-\mu$, the symmetric functions $P_{\lambda / \mu}$ and $Q_{\lambda / \mu}$ depend on both $\lambda$ and $\mu$; this is clear from (5.11) and (5.11').
2. In the case where there is only one variable $x$, we have

$$
\begin{equation*}
Q_{\lambda / \mu}(x ; t)=\varphi_{\lambda / \mu}(t) x^{|\lambda-\mu|} \tag{5.14}
\end{equation*}
$$

if $\lambda-\mu$ is a horizontal strip, and $Q_{\lambda / \mu}(x ; t)=0$ otherwise. Similarly

$$
\begin{equation*}
P_{\lambda / \mu}(x ; t)=\psi_{\lambda / \mu}(t) x^{|\lambda-\mu|} \tag{5.14'}
\end{equation*}
$$

if $\lambda-\mu$ is a horizontal strip, and $P_{\lambda / \mu}(x ; t)=0$ otherwise.
These are special cases of (5.11) and (5.11').

## Examples

Several of the formal identities given in the Examples in Chapter I, $\S 5$ can be generalized.
1.

$$
\sum_{\lambda} P_{\lambda}(x ; t)=\prod_{i}\left(1-x_{i}\right)^{-1} \prod_{i<j}\left(1-t x_{i} x_{j}\right) /\left(1-x_{i} x_{j}\right),
$$

summed over all partitions $\lambda$.
It is enough to prove this identity when $x=\left\{x_{1}, \ldots, x_{n}\right\}$, the sum on the left being over all partitions of length $\leqslant n$. By induction on $n$, it is therefore enough to prove that

$$
\sum_{\lambda} P_{\lambda}(x, y ; t)=\frac{1}{1-y} \prod_{i=1}^{n} \frac{1-t x_{i} y}{1-x_{i} y} \sum_{\nu} P_{\nu}(x ; t)
$$

where we have written $y$ in place of $x_{n+1}$. Now by (5.5') and (5.14') we have

$$
\begin{aligned}
P_{\lambda}(x, y ; t) & =\sum_{\mu \subset \lambda} P_{\lambda / \mu}(y ; t) P_{\mu}(x ; t) \\
& =\sum_{\mu \subset \lambda} \psi_{\lambda / \mu}(t) y^{|\lambda-\mu|} P_{\mu}(x ; t),
\end{aligned}
$$

summed over partitions $\mu \subset \lambda$ such that $\lambda-\mu$ is a horizontal strip. On the other hand, by (2.9),

$$
\prod_{i=1}^{n} \frac{1-t x_{i} y}{1-x_{i} y} \sum_{\nu} P_{\nu}(x ; t)=\sum_{\nu, r} P_{\nu}(x ; t) q_{r}(x ; t) y^{r},
$$

and

$$
P_{\nu}(x ; t) q_{r}(x ; t) y^{r}=\sum_{\mu \supset \nu} \varphi_{\mu / \nu}(t) P_{\mu}(x ; t) y^{|\mu-\nu|},
$$

by (5.7), the summation being over all $\mu \supset \nu$ such that $\mu-\nu$ is a horizontal $r$-strip. Hence we are reduced to proving that

$$
\begin{equation*}
\sum_{\lambda \supset \mu} \psi_{\lambda / \mu}(t) y^{|\lambda-\mu|}=(1-y)^{-1} \sum_{\nu \subset \mu} \varphi_{\mu / \nu}(t) y^{|\mu-\nu|} \tag{1}
\end{equation*}
$$

for any partition $\mu$, where $\lambda-\mu$ and $\mu-\nu$ are horizontal strips.

For each subset $I$ of $\left[1, \mu_{1}\right]$ consider the partitions $\lambda \supset \mu$ and $\nu \subset \mu$ such that

$$
\begin{equation*}
\psi_{\lambda / \mu}(t)=\varphi_{\mu / \nu}(t)=\prod_{i \in I}\left(1-t^{m_{i}(\mu)}\right) \tag{2}
\end{equation*}
$$

Let $i_{1}, i_{1}+i_{2}, \ldots, i_{1}+\ldots+i_{r}$ be the elements of $I$ in ascending order. Then it is easily seen that the contribution to the left-hand side of (1) from the partitions $\lambda$ satisfying (2) is
(3) $\left(1+y+\ldots+y^{i_{1}-1}\right)\left(y+y^{2}+\ldots+y^{i_{2}-1}\right) \ldots\left(y+\ldots+y^{i_{r}-1}\right) \cdot y(1-y)^{-1}$
and likewise that the contribution to the right-hand side of (1) from the partitions $v$ satisfying (2) is

$$
(1-y)^{-1}\left(y+y^{2}+\ldots+y^{i_{1}}\right)\left(y+y^{2}+\ldots+y^{i_{2}-1}\right) \ldots\left(y+\ldots+y^{i_{r}-1}\right)
$$

which is visibly equal to (3). Hence the two sides of (1) are indeed equal, and the proof is complete.
When $t=0$, this identity reduces to that of Chapter I, §5, Example 4.
2.

$$
\sum_{\mu} P_{\mu}(x ; t)=\prod_{i}\left(1-x_{i}^{2}\right)^{-1} \prod_{i<j}\left(1-t x_{i} x_{j}\right) /\left(1-x_{i} x_{j}\right)
$$

summed over all partitions $\mu$ with all parts even.
In view of Example 1 it is enough to show that

$$
\sum_{\mu} P_{\mu}(x ; t) \sum_{m \geqslant 0} e_{m}(x)=\sum_{\lambda} P_{\lambda}(x ; t)
$$

where the sum on the right is over all partitions $\lambda$. Now each partition $\lambda$ determines uniquely an even partition $\mu$ by decreasing each odd part of $\lambda$ by 1 , so that $\lambda_{i}^{\prime}-\mu_{i}^{\prime}=0$ if $i$ is even and $=m_{i}(\lambda)$ if $i$ is odd. It follows from (3.2) that $f_{\mu\left(1^{m}\right)}^{\lambda}(t)=1$, where $m=|\lambda-\mu|$, and hence that the coefficient of $P_{\lambda}$ in $P_{\mu} e_{m}$ is 1 .
3.

$$
\sum_{\nu} c_{\nu}(t) P_{\nu}(x ; t)=\prod_{i<j}\left(1-x_{i} x_{j}\right) /\left(1-x_{i} x_{j}\right)
$$

where the sum is over all partitions $\nu$ with all columns of even length, and $c_{\nu}(t)=\Pi_{i>1}(1-t)\left(1-t^{3}\right) \ldots\left(1-t^{m_{i}-1}\right)$, where $m_{i}=m_{i}(\nu)$.

From Example 1 it follows that

$$
\begin{aligned}
\prod_{i<j}\left(1-t x_{i} x_{j}\right) /\left(1-x_{i} x_{j}\right) & =\left(\sum_{\lambda} P_{\lambda}(x ; t)\right)\left(\sum_{m}(-1)^{m} e_{m}(x)\right) \\
& =\sum_{\lambda, m}(-1)^{m} \sum_{\mu} f_{\lambda\left(1^{m}\right)}^{\mu}(t) P_{\mu}(x ; t)
\end{aligned}
$$

from which and (3.2) the coefficient of $P_{\mu}(x ; t)$ ( $\mu$ any partition) in $\Pi_{i<j}\left(1-t x_{i} x_{j}\right) /\left(1-x_{i} x_{j}\right)$ is equal to

$$
\prod_{i>1} \sum_{r_{i}=0}^{m_{i}(\mu)}(-1)^{r_{i}}\left[\begin{array}{c}
m_{i}(\mu) \\
r_{i}
\end{array}\right]
$$

Now (see [A2], Theorem 3.4) the inner sum is 0 if $m_{i}(\mu)$ is odd, and is equal to $(1-t)\left(1-t^{3}\right) \ldots\left(1-t^{m_{l}(\mu)-1}\right)$ if $m_{i}(\mu)$ is even. Hence the result.

Since $c_{\nu}(t)=b_{\nu}(t) / b_{\nu / 2}\left(t^{2}\right)$, where $\nu / 2$ is the partition defined by $m_{i}(\nu / 2)$ $=\frac{1}{2} m_{i}(\nu)$ for all $i$, the identity just proved can be restated in the form

$$
\sum_{\nu} b_{\nu / 2}\left(t^{2}\right)^{-1} Q_{\nu}(x ; t)=\prod_{i<j}\left(1-t x_{i} x_{j}\right) /\left(1-x_{i} x_{j}\right)
$$

again summed over partitions $\nu$ with all columns of even length, i.e. partitions in which each part occurs an even number of times.
4.

$$
\prod_{i} \frac{1-t x_{i}}{1-x_{i}} \prod_{i<j} \frac{1-t x_{i} x_{j}}{1-x_{i} x_{j}}=\sum_{\lambda} d_{\lambda}(t)^{-1} Q_{\lambda}(x ; t)
$$

summed over all partitions $\lambda$, where

$$
d_{\lambda}(t)=\prod_{i \geqslant 1} \prod_{j=1}^{\left[m_{i} / 2\right]}\left(1-t^{2 j}\right)
$$

in which $m_{i}=m_{i}(\lambda)$.
From Example 3 and (2.10) we have

$$
\begin{aligned}
\prod_{i} \frac{1-t x_{i}}{1-x_{i}} \prod_{i<j} \frac{1-t x_{i} x_{j}}{1-x_{i} x_{j}} & =\left(\sum_{r=0}^{\infty} q_{r}(x ; t)\right)\left(\sum_{\nu} b_{\nu / 2}\left(t^{2}\right)^{-1} Q_{\nu}(x ; t)\right) \\
& =\sum_{\lambda, \nu} \frac{\psi_{\lambda / \nu}(t)}{b_{\nu / 2}\left(t^{2}\right)} Q_{\lambda}(x ; t)
\end{aligned}
$$

by (5.7'), where the summation is over all $\nu$ with all columns even and all $\lambda \supset \nu$ such that $\lambda-\nu$ is a horizontal strip. Each partition $\lambda$ determines a unique such $\nu$, by removing the bottom square from each column of odd length in $\lambda$. If $\lambda-\nu=\theta$, this means that $\theta_{i}^{\prime}=1$ or 0 according as $\lambda_{i}^{\prime}$ is odd or even. We have $m_{i}(\nu)=$ $m_{i}(\lambda)-\theta_{i}^{\prime}+\theta_{i+1}^{\prime}$, and $\psi_{\lambda / \nu}(t)$ is the product $\Pi\left(1-t^{m_{i}(\lambda)-\theta_{i}^{\prime}+\theta_{i+1}^{\prime}}\right)$ taken over those $i \geqslant 1$ for which $\theta_{i}^{\prime}=0$ and $\theta_{i+1}^{\prime}=1$. It follows that $b_{\nu / 2}\left(t^{2}\right) / \psi_{\lambda / \nu}(t)=d_{\lambda}(t)$ as defined above.
5. Let

$$
\begin{aligned}
\Phi\left(x_{1}, \ldots, x_{n} ; t\right) & =\prod_{i=1}^{n}\left(1-x_{i}\right)^{-1} \prod_{i<j}\left(1-t x_{i} x_{j}\right) /\left(1-x_{i} x_{j}\right) \\
& =\sum_{\lambda} P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)
\end{aligned}
$$

(Example 1). Let $u$ be another indeterminate, then the formal power series

$$
S(u)=\sum P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right) u^{\lambda_{0}}
$$

where the sum is over all $\lambda_{0} \geqslant \lambda_{1} \geqslant \ldots \geqslant \lambda_{n} \geqslant 0$, and $\lambda=\left(\lambda_{1}, \ldots, \lambda_{n}\right)$, is equal to

$$
\sum_{\varepsilon} \frac{\Phi\left(x_{1}^{\varepsilon_{1}}, \ldots, x_{n}^{\varepsilon_{n}} ; t\right)}{1-u \Pi x_{i}^{\left(1-\varepsilon_{i}\right) / 2}}
$$

summed over all $\varepsilon=\left(\varepsilon_{1}, \ldots, \varepsilon_{n}\right)$ where each $\varepsilon_{i}$ is $\pm 1$ (hence a sum of $2^{n}$ terms).
Let $X$ denote the set of variables $x_{1}, \ldots, x_{n}$, and for any subset $E$ of $X$, let $p(E)$ denote the product of the elements of $E$. (In particular, $p(\varnothing)=1$.)
Suppose $\lambda=\left(\lambda_{1}, \ldots, \lambda_{n}\right)$ is of the form $\left(\mu_{1}^{r_{1}}, \mu_{2}^{r_{2}}, \ldots, \mu_{k}^{r_{k}}\right)$, where $\mu_{1}>\mu_{2}>\ldots>$ $\mu_{k} \geqslant 0$, and the $r_{i}$ are positive inegers whose sum is $n$. Then from (2.2) we have

$$
\begin{equation*}
P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)=\sum_{f} p\left(f^{-1}(1)\right)^{\mu_{1}} \ldots p\left(f^{-1}(k)\right)^{\mu_{k}} \prod_{f\left(x_{i}\right)<f\left(x_{j}\right)} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}} \tag{1}
\end{equation*}
$$

summed over all surjective mappings $f: X \rightarrow\{1,2, \ldots, k\}$ such that $\left|f^{-1}(i)\right|=r_{i}$ for $1 \leqslant i \leqslant k$.
Each such $f$ determines a filtration of $X$ :

$$
\mathscr{F}: \varnothing=F_{0} \subset F_{1} \subset \ldots \subset F_{k}=X
$$

(all inclusions strict) according to the rule

$$
x \in F_{r} \Leftrightarrow f(x) \leqslant r .
$$

Conversely, such a filtration $\mathscr{F}$ of length $k$ determines a surjection $f: X \rightarrow$ $(1,2, \ldots, k\}$ uniquely. From (1) it follows that

$$
\begin{equation*}
S(u)=\sum_{\mathscr{F}} \pi_{\mathscr{F}} \sum u^{\mu_{0}} \prod_{i=1}^{k} p\left(F_{i}-F_{i-1}\right)^{\mu_{i}} \tag{2}
\end{equation*}
$$

where the outer sum is over all filtrations $\mathscr{F}=\left(F_{0}, \ldots, F_{k}\right)$ of $X$ (with $k$ arbitrary) and the inner sum is over all integers $\mu_{0}, \mu_{1}, \ldots, \mu_{k}$ such that $\mu_{0} \geqslant \mu_{1}>\mu_{2}>$ ... $>\mu_{k} \geqslant 0$, and finally

$$
\pi_{\mathscr{g}}=\prod_{f\left(x_{i}\right)<f\left(x_{j}\right)} \frac{x_{i}-t x_{j}}{x_{i}-x_{j}}
$$

where $f$ is the function $X \rightarrow\{1,2, \ldots, k\}$ defined by $\mathscr{F}$.
Now let $\nu_{i}=\mu_{i}-\mu_{i+1}(0 \leqslant i \leqslant k-1), \nu_{k}=\mu_{k}$, so that $\nu_{0} \geqslant 0, \nu_{k} \geqslant 0$ and $\nu_{i}>0$ for $1 \leqslant i \leqslant k-1$. Then the inner sum in (2) is

$$
\begin{aligned}
\sum_{\nu_{0}, \ldots, \nu_{k}} u^{\nu_{0}+\ldots+v_{k}} \prod_{i=1}^{k} p\left(F_{i}\right)^{\nu_{l}} & =\frac{1}{1-u} \prod_{i=1}^{k-1} \frac{p\left(F_{i}\right) u}{1-p\left(F_{i}\right) u} \frac{1}{1-p(X) u} \\
& =(1-u)^{-1} A_{g}(u), \mathrm{say}
\end{aligned}
$$

and hence from (2) we have

$$
\begin{equation*}
S(u)=(1-u)^{-1} \sum_{\mathscr{F}} \pi_{\mathscr{F}} A_{\mathscr{F}}(u), \tag{3}
\end{equation*}
$$

summed over all filtrations $\mathscr{F}$ of $X$ as before.
Observe that

$$
S(u)(1-u)=\sum_{\lambda} P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right) u^{\lambda_{1}}
$$

and hence that $\left.S(u)(1-u)\right|_{u-1}$ is equal to $\Phi\left(x_{1}, \ldots, x_{n} ; t\right)$, so that

$$
\begin{equation*}
\Phi\left(x_{1}, \ldots, x_{n} ; t\right)=\sum_{\mathcal{F}} \pi_{F} A_{g}(1) \tag{4}
\end{equation*}
$$

The formula (3) shows that $S(u)$ is a rational function of $u$ (with coefficients in $\mathrm{Q}\left(x_{1}, \ldots, x_{n}, t\right)$ ). The denominators on the right-hand side of (3) are products of factors of the form $(1-p(Y) u$ ), where $Y \subset X$. We may therefore express $S(u)$ as a sum of partial fractions: say

$$
\begin{equation*}
S(u)=\sum_{Y \subset X} \frac{a(Y)}{1-p(Y) u} \tag{5}
\end{equation*}
$$

To compute $a(Y)$, we have to decompose ( $1-u)^{-1} A_{g}(u)$ into a sum of partial fractions in the usual way, for each filtration $\mathscr{F}$ which contains $Y$, and then add together the results. The reader will not find it difficult to verify, using (4), that for each $Y \subset X$ we have

$$
\begin{equation*}
a(Y)=\Phi\left(x_{1}^{\varepsilon_{1}}, \ldots, x_{n}^{\varepsilon_{n}} ; t\right) \tag{6}
\end{equation*}
$$

where $\varepsilon_{i}=-1$ or +1 according as $x_{i} \in Y$ or $x_{i} \notin Y$. Since

$$
p(Y)=\prod_{x_{i} \in Y} x_{i}=\prod_{i=1}^{n} x_{i}^{\left(1-\varepsilon_{i}\right) / 2}
$$

this gives the stated result.
6. Show that

$$
\begin{aligned}
\sum_{\lambda} \frac{q^{n(\lambda)}}{\left|\operatorname{Aut} M_{\lambda}\right|} & =\left(1-q^{-1}\right) \prod_{i>1} \frac{1+q^{-i}}{1-q^{-i}} \\
\sum_{\mu \mathrm{even}} \frac{q^{n(\mu)}}{\left|\operatorname{Aut} M_{\mu}\right|} & =\prod_{i>2} \frac{1}{1-q^{-i}}
\end{aligned}
$$

where (as in Chapter II) $M_{\lambda}$ is a finite 0 -module of type $\lambda$, and $q$ is the cardinality of the residue field of 0 . (Apply the specialization $x_{i} \mapsto q^{-i}(i \geqslant 1)$ to the identities of Examples 1 and 2 above, bearing in mind §3, Example 2(a).)
7. (a) Let $Q_{\lambda}^{\prime}(x ; t)=Q_{\lambda}\left(x^{\prime} ; t\right)$ where the $x^{\prime}$ variables are the products $x_{i} t^{j-1}(i, j \geqslant$ 1). (In $\lambda$-ring notation, $Q_{\lambda}^{\prime}(x ; t)=Q_{\lambda}(x /(1-t) ; t)$. From (4.4) it follows that

$$
\begin{equation*}
\sum_{\lambda} P_{\lambda}(x ; t) Q_{\lambda}^{\prime}(y ; t)=\prod_{i, j}\left(1-x_{i} y_{j}\right)^{-1} \tag{1}
\end{equation*}
$$

equivalently that $\left(Q_{\lambda}^{\prime}\right)$ is the basis of $\Lambda[t]$ dual to $\left(P_{\lambda}\right)$, relative to the scalar product of Chapter I, $\S 4$.
Now let $n$ be a positive integer and $\zeta=\exp 2 \pi i / n$, and set $x_{j}=\zeta^{j-1}(1 \leqslant j \leqslant$ n), $x_{j}=0$ for $j>n$. From $\S 2$, Example 1, if $\lambda$ is a partition of length $\leqslant n$ we have
(2)

$$
P_{\lambda}\left(1, \zeta, \ldots, \zeta^{n-1} ; \zeta\right)=\zeta^{n(\lambda)} \varphi_{n}(\zeta) / \prod_{i \geqslant 0} \varphi_{m_{j}}(\zeta)
$$

where $m_{j}=m_{j}(\lambda)$ for $j \geqslant 1$, and $m_{0}=n-l(\lambda)$. The right-hand side of (2) will contain $1-\zeta^{n}$ in the numerator, and hence will vanish, unless $m_{s}=n$ for some $s$, that is to say unless $\lambda=\left(s^{n}\right.$; and in that case, since $n(\lambda)=\frac{1}{2} n(n-1) s$, we have

$$
\begin{equation*}
P_{\lambda}\left(1, \zeta, \ldots, \zeta^{n-1} ; \zeta\right)=\zeta^{n(\lambda)}=(-1)^{s(n-1)} \tag{3}
\end{equation*}
$$

From (1), (2), and (3) it follows that

$$
\sum_{s>0}(-1)^{s(n-1)} Q_{\left(s^{n}\right)}^{\prime}(y ; \zeta)=\prod_{j>1}\left(1-y_{j}^{n}\right)^{-1}
$$

so that

$$
\begin{equation*}
Q_{\left(s^{n}\right)}^{\prime}(y ; \zeta)=(-1)^{s(n-1)} h_{s}\left(y^{n}\right) \tag{4}
\end{equation*}
$$

where $y^{n}=\left(y_{1}^{n}, y_{2}^{n}, \ldots\right)$.
(b) From (5.7') we have

$$
\begin{equation*}
Q_{\mu}^{\prime}(x ; \zeta) q_{r}^{\prime}(x ; \zeta)=\sum_{\lambda} \psi_{\lambda / \mu}(\zeta) Q_{\lambda}^{\prime}(x ; \zeta) \tag{5}
\end{equation*}
$$

(where $q_{r}^{\prime}=Q_{(r)}^{\prime}$ ) summed over partitions $\lambda \supset \mu$ such that $\lambda-\mu$ is a horizontal strip, where $\psi_{\lambda / \mu}$ is given by ( $5.8^{\prime}$ ). It follows that, for each $s \geqslant 1$,

$$
\begin{equation*}
Q_{\mu \cup\left(s^{n}\right)}^{\prime}(x ; \zeta) q_{r}^{\prime}(x ; \zeta)=\sum_{\lambda} \psi_{\lambda / \mu}(\zeta) Q_{\lambda \cup\left(s^{n}\right)}^{\prime}(x ; \zeta) \tag{6}
\end{equation*}
$$

with the same coefficients $\psi_{\lambda / \mu}$ as before.
Let $\varphi_{s}: \Lambda_{\mathbf{C}} \rightarrow \Lambda_{\mathbf{C}}$ denote the linear mapping defined by

$$
\varphi_{s}\left(Q_{\mu}^{\prime}(x ; \zeta)\right)=Q_{\mu \cup\left(s^{n}\right)}^{\prime}(x ; \zeta) .
$$

From (4) we have $\varphi_{s}(1)=(-1)^{s(n-1)} h_{s}\left(x^{n}\right)$. The equations (5) and (6) show that $\varphi_{s}$ commutes with multiplication by $q_{r}^{\prime}$, for each $r \geqslant 1$, and hence that $\varphi_{s}$ is $\Lambda_{\mathbf{c}}$-linear. It follows that $\varphi_{s}(f)=f \varphi_{s}(1)$ for all $f \in \Lambda_{C}$, i.e. that

$$
\begin{equation*}
Q_{\mu \cup\left(s^{n}\right)}^{\prime}(x ; \zeta)=(-1)^{s(n-1)} Q_{\mu}^{\prime}(x ; \zeta) h_{s}\left(x^{n}\right) \tag{7}
\end{equation*}
$$

(c) Deduce that the symmetric functions $Q_{\lambda}^{\prime}(x ; \zeta)$ enjoy the following factorization
property: let $m_{i}(\lambda)=n q_{i}+r_{i}$ where $0 \leqslant r_{i} \leqslant n-1$, and let $\mu=\left(1^{q_{1}} 2^{q_{2}} \ldots\right), \rho=$ ( $1^{r_{1} 2^{r_{2}} \ldots}$ ). Then

$$
Q_{\lambda}^{\prime}(x ; \zeta)=(-1)^{(n-1)|\mu|} Q_{\rho}^{\prime}(x ; \zeta) h_{\mu}\left(x^{n}\right) .
$$

In particular, when $n=1$ (so that $\zeta=1$ ) we have $P_{\lambda}(x ; \zeta)=m_{\lambda}$, and $\rho=0, \mu=\lambda$ : so we recover the fact that ( $h_{\lambda}$ ) is the basis of $\Lambda$ dual to ( $m_{\lambda}$ ).
8. As in Chapter I, $\S 5$, Example 25 , let $\Delta$ denote the diagonal map $(\Delta f=f(x, y)$ ). Also, for each $f \in \Lambda[t]$, let $f^{\perp}$ denote the adjoint of multiplication of $f$, relative to the scalar product (4.8), so that $\left\langle f^{\perp} g, h\right\rangle=\langle g, f h\rangle$ for all $g, h \in \Lambda[t]$.
(a) Show that $\Delta$ is the adjoint of the product map, i.e. that

$$
\begin{equation*}
\langle\Delta f, g \otimes h\rangle=\langle f, g h\rangle \tag{1}
\end{equation*}
$$

for all $f, g, h \in \Lambda[t]$. (Use (5.5) and (5.1).)
(b) We have

$$
\begin{equation*}
\Delta q_{n}=\sum_{r+s=n} q_{r} \otimes q_{s} \tag{2}
\end{equation*}
$$

and hence by (a) above

$$
\left\langle q_{n}, g h\right\rangle=\sum_{r+s=n}\left\langle q_{r}, g\right\rangle\left\langle q_{s}, h\right\rangle
$$

for all $g, h \in \Lambda[t]$. By taking $g=q_{m}$ deduce that

$$
q_{m}^{\perp} q_{n}= \begin{cases}(1-t) q_{n-m} & \text { if } m \geqslant 1, \\ q_{n} & \text { if } m=0 .\end{cases}
$$

If we define

$$
Q^{\perp}(u)=\sum_{m>0} q_{m}^{\perp} u^{m}, \quad Q(v)=\sum_{n \geqslant 0} q_{n} v^{n}
$$

where $u, v$ are indeterminates, this last relation may be written in the form

$$
\begin{equation*}
Q^{\perp}(u)(Q(v))=Q(v) F(u v)^{-1} \tag{3}
\end{equation*}
$$

where $F(u v)=(1-u v) /(1-t u v)$ as in $\S 2$.
(c) Show that $Q^{\perp}(u): \Lambda[t] \rightarrow \Lambda[t, u]$ is a ring homomorphism. (We have

$$
\begin{aligned}
\left\langle q_{n}^{\perp}(f g), h\right\rangle & =\left\langle f g, q_{n} h\right\rangle \\
& =\left\langle f \otimes g, \Delta\left(q_{n}\right) \Delta(h)\right\rangle
\end{aligned}
$$

by (1) and the fact that $\Delta$ is a ring homomorphism,

$$
\begin{aligned}
& =\sum_{r+s=n}\left\langle\left(q_{r}^{\perp} f\right) \otimes\left(q_{s}^{\perp} g\right), \Delta h\right\rangle \\
& =\sum_{r+s=n}\left\langle\left(q_{r}^{\perp} f\right)\left(q_{s}^{\perp} g\right), h\right\rangle
\end{aligned}
$$

by (2) and (1) again.
Hence

$$
\left.q_{n}^{\perp}(f g)=\sum_{r+s=n}\left(q_{r}^{\perp} f\right)\left(q_{s}^{\perp} g\right) .\right)
$$

It now follows from (3) that

$$
\begin{equation*}
Q^{\perp}(u) \circ Q(v)=F(u v)^{-1} Q(v) \circ Q^{\perp}(u) \tag{4}
\end{equation*}
$$

as operators on $\Lambda[t]$, where $Q(v)$ is regarded as a multiplication operator, i.e. $Q(v) f=\Sigma_{n>0} q_{n} f v^{n}$.
(d) Let $Q(u)^{-1}=\Sigma r_{n} u^{n}=R(u)$ and let

$$
R^{\perp}(u)=\sum r_{n}^{\perp} u^{n}
$$

From (4) we have

$$
R(v) \circ Q^{\perp}(u)=F(u v)^{-1} Q^{\perp}(u) \circ R(v)
$$

and hence, on taking adjoints,

$$
\begin{equation*}
R^{\perp}(v) \circ Q(u)=F(u v) Q(u) \circ R^{\perp}(v) \tag{5}
\end{equation*}
$$

(e) Now define operators $B_{n}(n \in \mathbf{Z})$ by

$$
B_{n}=\sum_{i>0} q_{n+i} r_{i}^{\perp}
$$

or collectively

$$
\begin{equation*}
B(u)=\sum_{n} B_{n} u^{n}=Q(u) \circ R^{\perp}\left(u^{-1}\right) . \tag{6}
\end{equation*}
$$

Since

$$
Q(u)=\exp \left(\sum_{n \geqslant 1} \frac{1-t^{n}}{n} p_{n} u^{n}\right)
$$

it follows that

$$
B(u)=\exp \left(\sum_{n>1} \frac{1-t^{n}}{n} p_{n} u^{n}\right) \cdot \exp \left(-\sum_{n>1} \frac{1-t^{n}}{n} p_{n}{ }^{1} u^{-n}\right) .
$$

Also define

$$
B\left(u_{1}, \ldots, u_{n}\right)=Q\left(u_{1}\right) \ldots Q\left(u_{n}\right) R^{\perp}\left(u_{1}^{-1}\right) \ldots R^{\perp}\left(u_{n}^{-1}\right)
$$

where $u_{1}, \ldots, u_{n}$ are independent indeterminates. Deduce from (5) that

$$
\begin{equation*}
B(u) B(v)=B(u, v) F\left(u^{-1} v\right) \tag{8}
\end{equation*}
$$

and hence by iteration that

$$
\begin{equation*}
B\left(u_{1}\right) \ldots B\left(u_{n}\right)=B\left(u_{1}, \ldots, u_{n}\right) \prod_{i<j} F\left(u_{i}^{-1} u_{j}\right) . \tag{9}
\end{equation*}
$$

From (9) it follows that

$$
\begin{aligned}
B\left(u_{1}\right) \ldots B\left(u_{n}\right)(1) & =Q\left(u_{1}\right) \ldots Q\left(u_{n}\right) \prod_{i<j} F\left(u_{i}^{-1} u_{j}\right) \\
& =Q\left(u_{1}, \ldots, u_{n}\right)
\end{aligned}
$$

in the notation of (2.15). Hence for all partitions $\lambda=\left(\lambda_{1}, \ldots, \lambda_{n}\right)$ of length $\leqslant n$ we have

$$
Q_{\lambda}(x ; t)=B_{\lambda_{1}} \ldots B_{\lambda_{n}}(1) .
$$

(f) Deduce from (8) that

$$
B(u) B(v)(u-t v)=B(v) B(u)(t u-v)
$$

and hence that

$$
B_{m-1} B_{n}-t B_{m} B_{n-1}=t B_{n} B_{m-1}-B_{n-1} B_{m}
$$

for all $m, n \in \mathbf{Z}$.

## Notes and references

Example 7 is due to Lascoux, Leclerc, and Thibon [L6].
Example 8. The expression $B(u)$ is a 'vertex operator': see Jing [J12].

## 6. Transition matrices

We have met various (integral or rational) bases for the ring $\Lambda[t]$ of symmetric functions with coefficients in $\mathbf{Z}[t]$ : in particular ( $\S 4$ )
$\left(P_{\lambda}\right),\left(Q_{\lambda}\right)$ are dual bases, $\left(q_{\lambda}\right),\left(m_{\lambda}\right)$ are dual bases, $\left(S_{\lambda}\right),\left(s_{\lambda}\right)$ are dual bases,
with respect to the scalar product of $\S 4$.

By (2.6) the transition matrix

$$
K(t)=M(s, P)
$$

from the Schur functions $S_{\lambda}(x)$ to the Hall-Littlewood functions $P_{\mu}(x ; t)$ is strictly upper unitriangular. For any $t, u$ we have

$$
\begin{equation*}
M(P(x ; t), P(x ; u))=K(t)^{-1} K(u) \tag{6.2}
\end{equation*}
$$

Chapter I, §6. Also from (6.1), (6.2), and Chapter I, (6.1) we have

$$
M(Q, q)=M(P, m)^{*}=\left(K(t)^{-1} K\right)^{*}=K(t)^{\prime} K^{*}
$$

where * denotes transposed inverse. Since (Chapter I, §6) $K^{*}$ is the matrix of the operator $\Pi_{i<j}\left(1-R_{i j}\right)$, it follows from (2.15) that
(6.3) $K(t)^{\prime}$ is the matrix of the operator $\Pi_{i<j}\left(1-t R_{i j}\right)^{-1}$.

Moreover, the rule (5.11') for expressing $P_{\lambda}(x ; t)$ as a sum of monomials shows that

$$
\begin{equation*}
\left(K(t)^{-1} K\right)_{\lambda \mu}=\sum_{T} \psi_{T}(t) \tag{6.4}
\end{equation*}
$$

summed over all tableaux $T$ of shape $\lambda$ and weight $\mu$.
The table of transition matrices between the six bases listed in (6.1) is now easily calculated, and is as shown on p. 241 ( $b(t)$ denotes the diagonal matrix whose entries are the $b_{\lambda}(t)$ ).
For $n \leqslant 6$ the matrices $K(t)$ are given below.

|  |  |  |  |  |  |  | 31 | $2^{2}$ | $21^{2}$ | $1^{4}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
|  |  |  |  |  |  | 4 1 | 到 | $t^{2}$ | $t^{3}$ | $t^{6}$ |
|  |  |  | 3 | $211^{3}$ | $1^{3}$ | 31 | 1 | $t$ | $t+t^{2}$ | $t^{3}+t^{4}+t^{5}$ |
| $2 \quad 1^{2}$ |  | 3 | 1 | t | $t^{3}$ | $2^{2}$ |  | 1 | $t$ | $t^{2}+t^{4}$ |
| ![](https://cdn.mathpix.com/cropped/2024_12_08_1df2f08562f6a73c5373g-250.jpg?height=48&width=167&top_left_y=1493&top_left_x=160) |  | 21 |  | 1 \| 1 | $t+t^{2}$ | $21^{2}$ |  |  | 1 | $t+t^{2}+t^{3}$ |
| 124 |  | $1^{3}$ |  |  | 1 | $1^{4}$ |  |  |  | 1 |
|  | 5 | 41 | 32 | $31^{2}$ | $2^{2} 1$ | $21^{3}$ |  |  | $1^{5}$ |  |
| 5 | 1 | $t$ | $t^{2}$ | $t^{3}$ | $t^{4}$ | $t^{6}$ |  |  | $t^{10}$ |  |
| 41 |  | 1 | t | $t+t^{2}$ | $t^{2}+t^{3}$ | $t^{3}+t^{4}+t^{5}$ |  | $t^{6}+$ | $7^{7}+t^{8}+$ |  |
| 32 |  |  | 1 | $t$ | $t+t^{2}$ | $t^{2}+t^{3}+t^{4}$ |  | ${ }^{4}+t^{5}$ | + $t^{6}+t^{7}$ | + $t^{8}$ |
| $31^{2}$ |  |  |  | 1 | $t$ | $t+t^{2}+t^{3}$ |  | $+t^{4}$ | $+2 t^{5}+$ | $t^{6}+t^{7}$ |
| $2^{2} 1$ |  |  |  |  | 1 | $t+t^{2}$ |  | ${ }^{2}+t^{3}$ | $+t^{+}+t^{5}$ | ![](https://cdn.mathpix.com/cropped/2024_12_08_1df2f08562f6a73c5373g-250.jpg?height=49&width=75&top_left_y=1833&top_left_x=1105) |
| $21^{3}$ |  |  |  |  |  | 1 |  | $t+t^{2}$ | ${ }^{2}+t^{3}+$ |  |
| $1^{5}$ |  |  |  |  |  |  |  |  | 1 |  |


|  | 6 | 51 | 42 | $41^{2}$ | $3^{2}$ | 321 | $31^{3}$ | $2^{3}$ | $2^{2} 1^{2}$ | $21^{4}$ | $1^{6}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| 6 | 1 | $t$ | $t^{2}$ | $t^{3}$ | $t^{3}$ | $t^{4}$ | $t^{6}$ | $t^{6}$ | $t^{7}$ | $t^{10}$ | $t^{15}$ |
| 51 |  | 1 | $t$ | $t+t^{2}$ | $t^{2}$ | $t^{2}+t^{3}$ | $t^{3}+t^{4}+t^{5}$ | $t^{4}+t^{5}$ | $t^{4}+t^{5}+t^{6}$ | $t^{6}+t^{7}+t^{8}+t^{9}$ | $t^{10}+t^{11}+t^{12}+t^{13}+t^{14}$ |
| 42 |  |  | 1 | $t$ | $t$ | $t+t^{2}$ | $t^{2}+t^{3}+t^{4}$ | $t^{2}+t^{3}+t^{4}$ | $2 t^{3}+t^{4}+t^{5}$ | $t^{4}+t^{5}+2 t^{6}+t^{7}+t^{8}$ | $t^{7}+t^{8}+2 t^{9}+t^{10}+2 t^{11}+t^{12}+t^{13}$ |
| $41^{2}$ |  |  |  | 1 | 0 | $t$ | $t+t^{2}+t^{3}$ | $t^{3}$ | $t^{2}+t^{3}+t^{4}$ | $t^{3}+t^{4}+2 t^{5}+t^{6}+t^{7}$ | $t^{6}+t^{7}+2 t^{8}+2 t^{9}+2 t^{10}+t^{11}+t^{12}$ |
| $3^{2}$ |  |  |  |  | 1 | t | $t^{3}$ | $t^{3}$ | $t^{2}+t^{4}$ | $t^{4}+t^{5}+t^{7}$ | $t^{6}+t^{8}+t^{9}+t^{10}+t^{12}$ |
| 321 |  |  |  |  |  | 1 | $t+t^{2}$ | $t+t^{2}$ | $t+2 t^{2}+t^{3}$ | $t^{2}+2 t^{3}+2 t^{4}+2 t^{5}+t^{6}$ | $t^{4}+2 t^{5}+2 t^{6}+3 t^{7}+3 t^{8}+2 t^{9}+2 t^{10}+t^{11}$ |
| $31^{3}$ |  |  |  |  |  |  | 1 | 0 | t | $t+t^{2}+t^{3}+t^{4}$ | $t^{3}+t^{4}+2 t^{5}+2 t^{6}+2 t^{7}+t^{8}+t^{9}$ |
| $2^{3}$ |  |  |  |  |  |  |  | 1 | t | $t^{2}+t^{4}$ | $t^{3}+t^{5}+t^{6}+t^{7}+t^{9}$ |
| $2^{2} 1^{2}$ |  |  |  |  |  |  |  |  | 1 | $t+t^{2}+t^{3}$ | $t^{2}+t^{3}+2 t^{4}+t^{5}+2 t^{6}+t^{7}+t^{8}$ |
| $21^{4}$ |  |  |  |  |  |  |  |  |  | 1 | $t+t^{2}+t^{3}+t^{4}+t^{5}$ |
| $1^{6}$ |  |  |  |  |  |  |  |  |  |  | 1 |


|  | m | q | Q |  | $s$ | S |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| m | 1 | $K^{-1} K(t) b(t)^{-1} K(t)^{\prime} K^{*}$ | $K^{-1} K(t)$ | $K^{-1} K(t) b(t)^{-1}$ | $K^{-1}$ | $K^{-1} K(t) b(t)^{-1} K(t)^{\prime}$ |
| q | $K^{\prime} K(t)^{*} b(t) K(t)^{-1} K$ | 1 | $K^{\prime} K(t) * b(t)$ | $K^{\prime} K(t)^{*}$ | $K^{\prime} K(t)^{*} b(t) K(t)^{-1}$ | $K^{\prime}$ |
| $P$ | $K(t)^{-1} K$ | $b(t)^{-1} K(t)^{\prime} K^{*}$ | 1 | $b(t)^{-1}$ | $K(t)^{-1}$ | $b(t)^{-1} K(t)^{\prime}$ |
| Q | $b(t) K(t)^{-1} K$ | $K(t)^{\prime} K^{*}$ | $b(t)$ | 1 | $b(t) K(t)^{-1}$ | $K(t){ }^{\prime}$ |
| s | K | $K(t) b(t)^{-1} K(t)^{\prime} K^{*}$ | K(t) | $K(t) b(t)^{-1}$ | 1 | $K(t) b(t)^{-1} K(t)^{\prime}$ |
| s | $K(t)^{*} b(t) K(t)^{-1} K$ | $K^{*}$ | $K(t) * b(t)$ | $K(t)^{*}$ | $K(t)^{*} b(t) K(t)^{-1}$ | 1 |

These tables suggest that the polynomials $K_{\lambda \mu}(t)$ have all their coefficients $\geqslant 0$. Since $K_{\lambda \mu}(1)=K_{\lambda \mu}$ is (Chapter I, (6.4)) the number of tableaux of shape $\lambda$ and weight $\mu$, Foulkes [F7] conjectured that it should be possible to attach to each such tableau a positive integer $c(T)$ such that

$$
K_{\lambda \mu}(t)=\sum_{T} t^{c(T)}
$$

the sum being over all tableaux $T$ of shape $\lambda$ and weight $\mu$. Such a rule has been found by Lascoux and Schützenberger ([LA]; see also [B10]), and goes as follows.

We consider words (or sequences) $w=a_{1} \ldots a_{n}$ in which each $a_{i}$ is a positive integer. The weight of $w$ is the sequence $\mu=\left(\mu_{1}, \mu_{2}, \ldots\right)$, where $\mu_{i}$ is the number of $a_{j}$ equal to $i$. Assume that $\mu_{1} \geqslant \mu_{2} \geqslant \ldots$, i.e. that $\mu$ is a partition. If $\mu=\left(1^{n}\right)$ (so that $w$ is a derangement of $12 \ldots n$ ) we call $w$ a standard word.
(i) Suppose first that $w$ is a standard word. Attach an index to each element of $w$ as follows: the number 1 has index 0 , and if $r$ has index $i$, then $r+1$ has index $i$ or $i+1$ according as it lies to the right or left of $r$. The charge $c(w)$ of $w$ is defined to be the sum of the indices.
(ii) Now let $w$ be any word, subject only to the condition that its weight should be a partition $\mu$. We extract a standard word from $w$ as follows. Reading from the left, choose the first 1 that occurs in $w$, then the first 2 to the right of the 1 chosen, and so on. If at any stage there is no $s+1$ to the right of the $s$ chosen, go back to the beginning. This procedure selects a standard subword $w_{1}$ of $w$, of length $\mu_{1}^{\prime}$. Now erase $w_{1}$ from $w$ and repeat the procedure to obtain a standard subword $w_{2}$ (of length $\mu_{2}^{\prime}$ ), and so on. (For example, if $w=32214113$, the subword $w_{1}$ is 2143 , consisting of the underlined symbols in $w: 32214113$. When $w_{1}$ is erased, we are left with 3211 , so that $w_{2}=321$ and $w_{3}=1$.)

The charge of $w$ is defined to be the sum of the charges of the standard subwords: $c(w)=\Sigma c\left(w_{i}\right)$. (In the example above, the indices (attached as subscripts) are $2_{1} 1_{0} 4_{2} 3_{1}$ for $w_{1}$, so that $c\left(w_{1}\right)=4 ; 3_{2} 2_{1} 1_{0}$ for $w_{2}$, so that $c\left(w_{2}\right)=3$; and $1_{0}$ for $w_{3}$, so that $c\left(w_{3}\right)=0$ : hence $c(w)=4+3+0=7$.)
(iii) Finally, if $T$ is a tableau, by reading $T$ from right to left in consecutive rows, starting from the top (as in Chapter I, §9), we obtain a word $w(T)$, and the charge $c(T)$ of $T$ is defined to be $c(w(T))$.

The theorem of Lascoux and Schützenberger now states that
(6.5) (i) We have

$$
K_{\lambda \mu}(t)=\sum_{T} t^{c(T)}
$$

summed over all tableaux $T$ of shape $\lambda$ and weight $\mu$;
(ii) If $\lambda \geqslant \mu, K_{\lambda \mu}(t)$ is monic of degree $n(\mu)-n(\lambda)$. (If $\lambda \ngtr \mu$, we know already (2.6) that $K_{\lambda \mu}(t)=0$.)

For the proof of (6.5) we refer to [L4], [B10]. (6.5)(ii) is an easy consequence of (6.3) (see Example 4).

## Examples

1. $K_{(n) \mu}(t)=t^{n(\mu)}$ for any partition $\mu$ of $n$. This follows from the identity

$$
h_{n}=\sum_{|\mu|=n} t^{n(\mu)} P_{\mu}
$$

(§3, Example 1; §4, Example 1). Alternatively, use (6.5).
2. $K_{\lambda\left(1^{n}\right)}(t)=t^{n\left(\lambda^{\prime}\right)} \varphi_{n}(t) H_{\lambda}(t)^{-1}$ for any partition $\lambda$ of $n$, where

$$
H_{\lambda}(t)=\prod_{x \in \lambda}\left(1-t^{h(x)}\right)
$$

is the hook-length polynomial. This follows from $\S 4$, Example 2, since $K_{\lambda\left(\left(^{n}\right)\right.}(t)$ is the coefficient of $S_{\lambda}(x ; t)$ in $Q_{\left(t^{n}\right)}(x ; t)=\varphi_{n}(t) e_{n}(x)$.
From Chapter I, §5, Example 14, it follows that

$$
K_{\lambda\left(I^{\prime \prime}\right)}(t)=\sum_{T} t^{c^{\prime}(T)}
$$

summed over all standard tableaux $T$ of shape $\lambda$, where $c^{\prime}(T)$ is the sum of the positive integers $i<n$ such that $i+1$ lies in a column to the right of $i$ in $T$.
3. Tables of the polynomials $K_{\lambda \mu}(t)$ suggest the following conjecture: if the lowest power of $t$ which is present in $K_{\lambda \mu}(t)$ is $t^{a(\lambda, \mu)}$, then $a(\lambda, \mu)=a\left(\mu^{\prime}, \lambda^{\prime}\right)$.
4. Let $\varepsilon_{1}, \ldots, \varepsilon_{n}$ be the standard basis of $\mathbf{Z}^{n}$ and let $R^{+}$denote the set of vectors $\varepsilon_{i}-\varepsilon_{j}$ such that $1 \leqslant i<j \leqslant n$. For any $\xi=\left(\xi_{1}, \ldots, \xi_{n}\right) \in \mathbf{Z}^{n}$ such that $\sum \xi_{i}=0$, let

$$
P(\xi ; t)=\sum_{\left(m_{\alpha}\right)} t^{\Sigma m_{\alpha}},
$$

summed over all families ( $\left.m_{\alpha}\right)_{\alpha \in R^{+}}$of non-negative integers such that $\xi=\sum m_{\alpha} \alpha$. The polynomial $P(\xi ; t)$ is non-zero if and only if $\xi=\sum_{1}^{n-1} \eta_{i}\left(\varepsilon_{i}-\varepsilon_{i+1}\right)$, where the $\eta_{i}$ are $\geqslant 0$, and then it is monic of degree $\sum \eta_{i}$. Since $\eta_{i}=\xi_{1}+\ldots+\xi_{i}(1 \leqslant i \leqslant n-$ 1 ), the degree of $P(\xi ; t)$ is

$$
\sum(n-i) \xi_{i}=\langle\xi, \delta\rangle
$$

where as usual $\delta=(n-1, n-2, \ldots, 1,0)$ and the scalar product is the standard one.

Now by (6.3), $K(t)_{\lambda \mu}$ is the coefficient of $s_{\lambda}$ in

$$
\prod_{1<i<j<n}\left(1+t R_{i j}+t^{2} R_{i j}^{2}+\ldots\right) s_{\mu}
$$

hence is the coefficient of $a_{\lambda+\delta}$ in

$$
\sum_{\left(m_{\alpha}\right)} t^{\Sigma m_{\alpha}} a_{\mu+\delta+\Sigma m_{\alpha} a}
$$

or equivalently the coefficient of $x^{\lambda+\delta}$ in

$$
\sum_{w \in S_{n}} \varepsilon(w) \sum_{\left(m_{\alpha}\right)} t^{\Sigma m_{\alpha}} x^{w\left(\mu+\delta+\sum m_{\alpha} \alpha\right)}
$$

It follows from this that

$$
\begin{equation*}
K(t)_{\lambda \mu}=\sum_{w \in S_{n}} \varepsilon(w) P\left(w^{-1}(\lambda+\delta)-(\mu+\delta) ; t\right) \tag{1}
\end{equation*}
$$

Now

$$
\begin{aligned}
\left\langle w^{-1}(\lambda+\delta)-(\mu+\delta), \delta\right\rangle & =\langle\lambda+\delta, w \delta\rangle-\langle\mu+\delta, \delta\rangle \\
& \leqslant\langle\lambda+\delta, \delta\rangle-\langle\mu+\delta, \delta\rangle \\
& =n(\mu)-n(\lambda)
\end{aligned}
$$

and equality holds if and only if $w=1$. Hence the dominant term in the sum (1) is that corresponding to $w=1$, and therefore $K(t)_{\lambda \mu}$ is monic of degree $n(\mu)-n(\lambda)$.

From (1) it follows that $K_{\lambda \mu}(t)$ is equal to the coefficient of $x^{\mu}$ in $\operatorname{det}\left(x_{j}^{\lambda_{i}-i+j}\right) / \Pi_{i<j}\left(1-t x_{i}^{-1} x_{j}\right)$ (P. Hoffman).
5. From the tables of this section and Chapter I, §6, we have

$$
M(e, P)=M(e, s) M(s, P)=K^{\prime} J K(t)
$$

or equivalently

$$
\begin{equation*}
M(e, P)_{\lambda \mu}=\sum_{\nu} K(t)_{\nu \mu} K_{\nu^{\prime} \lambda} \tag{1}
\end{equation*}
$$

On the other hand, the formula (1) in the Appendix to Chapter II shows that

$$
\begin{equation*}
M(e, P)_{\lambda \mu}=\sum_{A} t^{\tilde{d}(A)} \tag{2}
\end{equation*}
$$

where the sum is over all row-strict arrays of shape $\mu$ and weight $\lambda$, and $\tilde{d}(A)$ is defined in Chapter II, Appendix (AZ.5).

From (1) and (2) we conclude that Foulkes's conjecture is equivalent to the following combinatorial statement: for any two partitions $\lambda, \mu$ there exists a bijection $\varphi$ between pairs of tableaux ( $T, T^{\prime}$ ) of conjugate shapes and respective weights $\mu$ and $\lambda$, and row-strict arrays of shape $\mu$ and weight $\lambda$, such that $\tilde{d}\left(\varphi\left(T, T^{\prime}\right)\right)$ does not depend on $T^{\prime}$.

Indeed, letting $c(T)=\tilde{d}\left(\varphi\left(T, T^{\prime}\right)\right)$, we have

$$
K(t)_{\lambda \mu}=\sum_{T} t^{c(T)}
$$

summed over all tableaux $T$ of shape $\lambda$ and weight $\mu$. It would be interesting to give an explicit construction of such a bijection $\varphi$.
6. The polynomials $K_{\lambda \mu}(t)$ have the following geometrical interpretation, due to $G$. Lusztig [L15]. Let $V$ be an $n$-dimensional vector space over an algebraically closed field $k$. The conjugacy classes of unipotent operators on $V$ are parametrized by the partitions of $n$ : the class $c_{\lambda}$ consists of operators with Jordan blocks of sizes $\lambda_{1}, \lambda_{2}, \ldots$ The closure $\bar{c}_{\lambda}$ of $c_{\lambda}$ is an algebraic variety (singular, in general) of dimension $2 n\left(\lambda^{\prime}\right)$, and we have

$$
\bar{c}_{\lambda}=\bigcup_{\mu<\lambda} c_{\mu} .
$$

Let $x \in c_{\mu} \subset \bar{c}_{\lambda}$, let $H^{i}\left(\bar{c}_{\lambda}\right)$ denote the Deligne-Goreski-MacPherson cohomology sheaves on $\bar{c}_{\lambda}$ (see, for example, [L15]), and let $H^{i}\left(\bar{c}_{\lambda}\right)_{x}$ be the stalk of $H^{i}\left(\bar{c}_{\lambda}\right)$ at $x$. Then $H^{i}\left(\bar{c}_{\lambda}\right)=0$ for $i$ odd, and

$$
\sum_{i \geqslant 0} t^{i} \operatorname{dim} H^{2 i}\left(\bar{c}_{\lambda}\right)_{x}=t^{n(\mu)-n(\lambda)} K_{\lambda \mu}\left(t^{-1}\right) .
$$

This gives another proof of (6.5) (ii) and of the fact that all coefficients of $K_{\lambda \mu}(t)$ are $\geqslant 0$. It would be interesting to give a geometrical interpretation of the Lascoux-Schützenberger theorem (6.5) (i).
7. If $\alpha=\left(\alpha^{(0)}, \alpha^{(1)}, \alpha^{(2)}, \ldots\right)$ is any finite sequence of partitions, let

$$
P_{n}^{k}(\alpha)=\sum_{i=1}^{n}\left(\alpha_{i}^{(k-1)}-2 \alpha_{i}^{(k)}+\alpha_{i}^{(k+1)}\right)
$$

for $k, n \geqslant 1$, and

$$
C(\alpha)=\sum_{k, n \geqslant 1}\binom{\alpha_{n}^{(k-1)}-\alpha_{n}^{(k)}}{2} .
$$

Also let $[a, b]$ denote the Gaussian polynomial $\left[\begin{array}{c}a+b \\ b\end{array}\right]$. Then

$$
K_{\lambda \mu}(t)=\sum_{\alpha} t^{C(\alpha)} \prod_{k, n \geqslant 1}\left[P_{n}^{k}(\alpha), \alpha_{n}^{(k)}-\alpha_{n}^{(k H)}\right]
$$

where $\alpha$ runs through all sequences of partitions such that $\alpha^{(0)}=\mu^{\prime}$ and $\left|\alpha^{(k)}\right|=$ $\lambda_{k+1}+\lambda_{k+2}+\ldots$ for $k \geqslant 1$. (This is a consequence of (6.5)(i); for the proof, see [K9].)
8. Let $N_{\lambda}(\mathfrak{o})$ denote the number of submodules of a finite $\mathfrak{0}$-module of type $\lambda$, where (as in Chapter II) $\mathfrak{o}$ is a discrete valuation ring with finite residue field $k$. Then

$$
N_{\lambda}(\mathfrak{D})=q^{n(\lambda)} \sum_{\mu}\left(\mu_{1}-\mu_{2}+1\right) K_{\mu \lambda}\left(q^{-1}\right)
$$

summed over partitions $\mu \geqslant \lambda$ of length $\leqslant 2$, where $q$ is the cardinality of $k$.
(We have

$$
\begin{aligned}
N_{\lambda}(\mathfrak{o}) & =\sum_{\mu, \nu} g_{\mu \nu}^{\lambda}(\mathfrak{o}) \\
& =q^{n(\lambda)} \sum_{\mu, \nu} q^{-n(\mu)-n(\nu)} f_{\mu \nu}^{\lambda}\left(q^{-1}\right) \\
& =q^{n(\lambda)} \sum_{\mu, \nu} q^{-n(\mu)-n(\nu)}\left\langle Q_{\lambda}\left(q^{-1}\right), P_{\mu}\left(q^{-1}\right) P_{\nu}\left(q^{-1}\right)\right\rangle \\
& =q^{n(\lambda)}\left\langle Q_{\lambda}\left(q^{-1}\right),\left(\sum h_{n}\right)^{2}\right\rangle .
\end{aligned}
$$

Now

$$
\begin{aligned}
\left(\sum h_{n}\right)^{2} & =\prod\left(1-x_{i}\right)^{-2}=\sum_{\mu} s_{\mu}(x) s_{\mu}(1,1) \\
& =\sum_{\mu}\left(\mu_{1}-\mu_{2}+1\right) s_{\mu}(x)
\end{aligned}
$$

summed over partitions $\mu$ of length $\leqslant 2$. Hence

$$
\begin{aligned}
N_{\lambda}(\mathfrak{o}) & =q^{n(\lambda)} \sum_{\mu}\left(\mu_{1}-\mu_{2}+1\right)\left\langle Q_{\lambda}\left(q^{-1}\right), s_{\mu}\right\rangle \\
& \left.=q^{n(\lambda)} \sum_{\mu}\left(\mu_{1}-\mu_{2}+1\right) K_{\mu \lambda}\left(q^{-1}\right) .\right)
\end{aligned}
$$

Notes and references
Examples 5 and 6 were contributed by A. Zelevinsky. Example 7 is due to Kirillov and Reshetikhin [K9].

## 7. Green's polynomials

Let $X(t)$ denote the transition matrix $M(p, P)$ between the power-sum products $p_{\rho}$ and the Hall-Littlewood functions $P_{\lambda}$ :

$$
\begin{equation*}
p_{\rho}(x)=\sum_{\lambda} X_{\rho}^{\lambda}(t) P_{\lambda}(x ; t) \tag{7.1}
\end{equation*}
$$

(so that $\rho$ is the row-index and $\lambda$ the column-index). By (2.7), $X_{\rho}^{\lambda}(t) \in \mathbf{Z}[t]$, and is zero unless $|\lambda|=|\rho|$. When $t=0$ we have $P_{\lambda}(x ; 0)=s_{\lambda}(x)$, so that by Chapter I, (7.8)

$$
\begin{equation*}
X_{\rho}^{\lambda}(0)=\chi_{\rho}^{\lambda} \tag{7.2}
\end{equation*}
$$

the value of the irreducible character $\chi^{\lambda}$ of $S_{n}$ at elements of cycle-type $\rho$.

From (4.1) and (4.4) we have

$$
\sum_{|\rho|=n} z_{\rho}(t)^{-1} p_{\rho}(x) p_{\rho}(y)=\sum_{|\lambda|=n} b_{\lambda}(t) P_{\lambda}(x ; t) P_{\lambda}(y ; t) .
$$

Substituting (7.1) in this relation, we obtain

$$
\begin{equation*}
X^{\prime}(t) z(t)^{-1} X(t)=b(t) \tag{7.3}
\end{equation*}
$$

where $X^{\prime}(t)$ is the transpose of $X(t)$, and $b(t)$ (resp. $z(t)$ ) is the diagonal matrix with entries $b_{\lambda}(t)$ (resp. $z_{\lambda}(t)$ ). An equivalent form of (7.3) is

$$
\begin{equation*}
X(t) b(t)^{-1} X^{\prime}(t)=z(t) \tag{7.4}
\end{equation*}
$$

In other words we have the orthogonality relations

$$
\sum_{|\rho|=n} z_{\rho}(t)^{-1} X_{\rho}^{\lambda}(t) X_{\rho}^{\mu}(t)=\delta_{\lambda \mu} b_{\lambda}(t)
$$

$$
\begin{equation*}
\sum_{|\lambda|=n} b_{\lambda}(t)^{-1} X_{\rho}^{\lambda}(t) X_{\sigma}^{\lambda}(t)=\delta_{\rho \sigma} z_{\rho}(t) \tag{7.4'}
\end{equation*}
$$

which when $t=0$ reduce to the orthogonality relations for the characters of the symmetric group $S_{n}$.
Since $X(t)^{-1}=b(t)^{-1} X^{\prime}(t) z(t)^{-1}$ by (7.3), we can solve the equations (7.1) to give

$$
\begin{equation*}
Q_{\lambda}(x ; t)=\sum_{\rho} z_{\rho}(t)^{-1} X_{\rho}^{\lambda}(t) p_{\rho}(x) . \tag{7.5}
\end{equation*}
$$

Next, since $M(s, P)=M(p, s)^{-1} M(p, P)$, we have $K(t)=X(0)^{-1} X(t)$, so that

$$
\begin{equation*}
X(t)=X(0) K(t) \tag{7.6}
\end{equation*}
$$

or more explicitly, using (7.2),

$$
X_{\rho}^{\mu}(t)=\sum_{\lambda} \chi_{\rho}^{\lambda} K_{\lambda \mu}(t)
$$

Since $K_{\lambda \mu}(t)$ is monic of degree $n(\mu)-n(\lambda) \leqslant n(\mu)(6.5)$, it follows that the dominant term on the right-hand side of $\left(7.6^{\prime}\right)$ is $\chi_{\rho}^{(n)} K_{(n) \mu}(t)=t^{n(\mu)}$ (§6, Example 1), so that
(7.7) $X_{\rho}^{\mu}(t)$ is monic of degree $n(\mu)$.

Green's polynomials $Q_{\rho}^{\lambda}(q)$ are defined by

$$
\begin{equation*}
Q_{\rho}^{\lambda}(q)=q^{n(\lambda)} X_{\rho}^{\lambda}\left(q^{-1}\right) \tag{7.8}
\end{equation*}
$$

In terms of these polynomials, the orthogonality relations (7.3') and (7.4') take the forms

$$
\begin{equation*}
\sum_{|\rho|=n} y_{\rho}(q)^{-1} Q_{\rho}^{\lambda}(q) Q_{\rho}^{\mu}(q)=\delta_{\lambda \mu} a_{\lambda}(q) \tag{7.9}
\end{equation*}
$$

$$
\begin{equation*}
\sum_{|\lambda|=n} a_{\lambda}(q)^{-1} Q_{\rho}^{\lambda}(q) Q_{\sigma}^{\lambda}(q)=\delta_{\rho \sigma} y_{\rho}(q) \tag{7.10}
\end{equation*}
$$

where $a_{\lambda}(q)=q^{|\lambda|+2 n(\lambda)} b_{\lambda}\left(q^{-1}\right), y_{\rho}(q)=q^{-|\rho|} z_{\rho}\left(q^{-1}\right)$ (Chapter II, (1.6)).
Also (7.6') now becomes

$$
\begin{equation*}
Q_{\rho}^{\mu}(q)=\sum_{\lambda} \chi_{\rho}^{\lambda} \tilde{K}_{\lambda \mu}(q) \tag{7.11}
\end{equation*}
$$

where $\tilde{K}_{\lambda \mu}(q)=q^{n(\mu)} K_{\lambda \mu}\left(q^{-1}\right)=q^{n(\lambda)}+$ terms of higher degree by (6.5).

## Examples

1. $X_{\rho}^{(n)}(t)=1$ for all partitions $\rho$ of $n$. This is a particular case of (7.7). Equivalently, $Q_{\rho}^{(n)}(q)=1$.
2. $X_{(n)}^{\lambda}(t)=t^{n(\lambda)} \varphi_{l(\lambda)-1}\left(t^{-1}\right)$, or equivalently $Q_{(n)}^{\lambda}(q)=\varphi_{l(\lambda)-1}(q)$. This follows from the identity (3) of $\S 3$, Example 1:

$$
\prod_{i \geqslant 1}\left(1-x_{i} y\right) /\left(1-x_{i}\right)=\sum_{\lambda} t^{n(\lambda)} \prod_{j=1}^{l(\lambda)}\left(1-t^{1-j} y\right) . P_{\lambda}(x ; t) .
$$

Divide both sides by $1-y$ and let $y \rightarrow 1$ : since

$$
\lim _{y \rightarrow 1} \frac{1}{1-y}\left(\prod_{i} \frac{1-x_{i} y}{1-x_{i}}-1\right)=\sum_{i} \frac{x_{i}}{1-x_{i}}=\sum_{n \geqslant 1} p_{n}(x)
$$

we obtain

$$
p_{n}(x)=\sum_{|\lambda|=n} t^{n(\lambda)} \prod_{1}^{l(\lambda)-1}\left(1-t^{-i}\right) P_{\lambda}(x ; t)
$$

which gives the result.
3. $X_{\rho}^{\left(1^{n}\right)}(t)=\Pi_{i-1}^{n}\left(t^{i}-1\right) / \Pi_{j>1}\left(t \rho_{j}-1\right)$, or equivalently $Q_{\rho}^{\left(1_{n}\right)}(q)=\varphi_{n}(q) /$ $\Pi_{j>1}\left(1-q^{\left.\rho_{j}\right)}\right.$. This follows from (7.5) with $\lambda=\left(1^{n}\right)$ : since $Q_{\left(1^{n}\right)}(x ; t)=\varphi_{n}(t) e_{n}(x)$ we have

$$
\begin{aligned}
\sum_{\rho} z_{\rho}(t)^{-1} X_{\rho}^{\left(1^{n}\right)}(t) p_{\rho}(x) & =\varphi_{n}(t) e_{n}(x) \\
& =\varphi_{n}(t) \sum_{\rho} \varepsilon_{\rho} z_{\rho}^{-1} p_{\rho}(x)
\end{aligned}
$$

so that $X_{\rho}^{\left(1^{n}\right)}(t)=\varepsilon_{\rho} z_{\rho}^{-1} z_{\rho}(t) \varphi_{n}(t)$, which is equivalent to the result stated.
$X_{\left(^{\lambda}\right)}^{\lambda}(t)=(1-t)^{-n} \Sigma_{T} \varphi_{T}(t)$, summed over all standard tableaux $T$ of shape $\lambda$. $\varphi_{T}(t)$ was defined in (5.9).)
For by (7.1) we have

$$
\begin{aligned}
X_{\left(\mathbf{l}^{n}\right)}^{\lambda}(t) & =\left\langle Q_{\lambda}, p_{1}^{n}\right\rangle=(1-t)^{-n}\left\langle Q_{\lambda}, q_{1}^{n}\right\rangle \\
& =(1-t)^{-n} \sum_{T} \varphi_{T}(t)
\end{aligned}
$$

(4.8) and (5.11).

By taking $x_{i}=t^{i-1}$ in (7.5) we obtain by $\S 2$, Example 1

$$
t^{n(\lambda)}=\sum_{\rho} z_{\rho}^{-1} X_{\rho}^{\lambda}(t)
$$

or, in terms of Green's polynomials,

$$
\sum_{|\rho|=n} z_{\rho}^{-1} Q_{\rho}^{\lambda}(q)=1
$$

for all partitions $\lambda$ of $n$.
6. $X_{\rho}^{\lambda}(1)=\left\langle p_{\rho}, h_{\lambda}\right\rangle$ (for the scalar product of Chapter I), hence is the value of the induced character ind $\mathcal{S}_{\lambda}^{S_{n}}(1)$ at elements of type $\rho$.

Let $\omega$ be a primitive $r$ th root of unity ( $r \geqslant 2$ ), and consider the effect of replacing the parameter $t$ by $\omega$. Let $K_{r}=\mathbf{Q}(\omega)$ be the $r$ th cyclotomic field, $\mathbb{O}_{r}=\mathrm{Z}[\omega]$ its ring of integers. By (2.7) the $P_{\lambda}(x ; \omega)$ form an $\mathfrak{D}_{r}$-basis of $\Lambda \otimes_{2} \mathfrak{D}_{r}$. On the other hand, the definition (2.12) of $b_{\lambda}(t)$ shows that $b_{\lambda}(\omega)$ and therefore also $Q_{\lambda}(x ; \omega)$ is zero if $m_{i}(\lambda) \geqslant r$ for some $i$, that is to say if the partition $\lambda$ has $r$ or more equal parts. Let $\mathscr{P}_{(r)}$ denote the set of partitions $\lambda$ such that $m_{i}(\lambda)<r$ for all $i$, and let $\Lambda_{(r)}$ denote the $\mathscr{D}_{r}$-submodule of $\Lambda \otimes_{2} \mathfrak{D}_{r}$ generated by the $P_{\lambda}(x ; \omega)$ with $\lambda \in \mathscr{P}_{(r)}$. Then $\Lambda_{(r)}$ is an $\mathscr{D}_{r}$-subalgebra of $\Lambda \otimes_{2} \mathfrak{D}_{r}$.
Let $A_{(r)}=\Lambda_{(r)} \otimes_{D_{r}}, K_{r}$, which is the $K_{r}$-vector space generated freely by the $\ell_{\lambda}(x ; \omega)$ such that $\lambda \in \mathscr{P}_{(r)}$. Since $z_{\rho}(\omega)^{-1}=z_{\rho}^{-1} \Pi_{j>1}\left(1-\omega^{\rho_{i}}\right)$ is zero if any $\rho_{i}$ is divisible by $r$, it follows from (7.5) that $A_{(r)}$ is contained in the $K_{r}$-algebra $B_{(r)}$ generated by the power sums $p_{n}$ such that $n$ is not divisible by $r$. Now if $A_{(r)}^{n}, B_{(r)}^{n}$ are the components of degree $n$ of $A_{(r)}, B_{(r)}$ respectively, it follows that $\Sigma_{n>0} \operatorname{dim} A_{(r)}^{n} \cdot u^{n}$ is the generating function for partitions $\lambda$ with no part repeated more than $r-1$ times, so that

$$
\begin{align*}
\sum_{n>0} \operatorname{dim} A_{(r)}^{n} \cdot u^{n} & =\prod_{i \gg 1}\left(1+u^{i}+\ldots+u^{(r-1) i}\right) \\
& =\prod_{i \gg 1}\left(1-u^{r i}\right) /\left(1-u^{i}\right),
\end{align*}
$$

and $\Sigma_{n>0} \operatorname{det} B_{(r)}^{n} . u^{n}$ is the generating function for partitions $\rho$ none of whose parts is divisible by $r$, so that

$$
\begin{equation*}
\sum_{n \geqslant 0} \operatorname{dim} B_{(r)}^{n} \cdot u^{n}=\prod_{\substack{i>1 \\ i \neq 0(r)}}\left(1-u^{i}\right)^{-1} \tag{2}
\end{equation*}
$$

From (1) and (2) it follows that $\operatorname{dim} A_{(r)}^{n}=\operatorname{dim} B_{(r)}^{n}$ and hence that $A_{(r)}=B_{(r)}$, hence $A_{(r)}$ is a $K_{r}$-algebra and therefore $\Lambda_{(r)}$ is an $\mathfrak{D}_{r}$-algebra, as asserted.

The scalar product defined in $\S 4$ is non-degenerate on $\Lambda_{(r)}$, and the orthogonal. ity relations $\left(7.3^{\prime}\right),\left(7.4^{\prime}\right)$ are now orthogonality relations for the matrix $X_{\rho}^{\lambda}(\omega)$, where $\lambda$ runs through partitions of $n$ which have no part repeated $r$ times or more, and $\rho$ through partitions of $n$ which have no part divisible by $r$.
8. Let us write

$$
\begin{equation*}
Q_{\rho}^{\mu}(q)=\sum_{i} \psi^{\mu, i}(\rho) q^{i} \quad(|\mu|=|\rho|=n) \tag{1}
\end{equation*}
$$

where the coefficients $\psi^{\mu, i}$ may be regarded as class-functions on $S_{n}$. Hotta and Springer [H9] have shown that $\psi^{\mu, i}$ is a character of $S_{n}$, for each partition $\mu$ of $n$ : they define an action of $S_{n}$ on the rational cohomology $H^{*}\left(X_{\mu}\right)$ of the variety $X_{\mu}$ (Chapter II, §3, Example) and show that

$$
\psi^{\mu, i}(w)=\varepsilon(w) \operatorname{trace}\left(w^{-1}, H^{2 i}\left(X_{\mu}\right)\right)
$$

where as usual $\varepsilon(w)$ is the sign of $w \in S_{n}$.
If

$$
\begin{equation*}
\psi^{\mu, i}=\sum_{\lambda} k_{\lambda \mu}^{(i)} \chi^{\lambda} \tag{2}
\end{equation*}
$$

is the decomposition of $\psi^{\mu, i}$ as a sum of irreducible characters, it follows from (1) and (2) and (7.11) that

$$
\tilde{K}_{\lambda \mu}(q)=\sum_{i} k_{\lambda \mu}^{(i)} q^{i}
$$

with coefficients $k_{\lambda \mu}^{(i)}$ integers $\geqslant 0$.
When $\rho=\left(1^{n}\right), Q_{\left(1^{n}\right)}^{\mu}(q)$ is the Poincaré polynomial of the variety $X_{\mu}$. When $q$ is a prime-power, we have $Q_{\left(\mu^{n}\right)}^{\mu}(q)=\left|X_{\mu}(q)\right|$, the number of $\mathbf{F}_{q}$-rational points of $X_{\mu}$.
The representations $\psi^{\mu, i}$ and their generalizations are studied in a number of recent papers. We mention the paper of W. Borho and R. MacPherson [B6], where is explained their relationship with the Deligne-Goreski-MacPherson sheaves on closures of unipotent classes ( $\S 6$, Example 6).

## Notes and references

The polynomials $Q_{\rho}^{\lambda}(q)$ were introduced by Green [G11], who proved the orthogonality relations (7.9), (7.10). For tables of these polynomials see Green (loc. cit.) for $n \leqslant 5$, and Morris [M12] for $n=6,7$.

## 8. Schur's $Q$-functions

We have seen in $\S 2$ that when $t=0$ the Hall-Littlewood function $P_{\lambda}(x ; t)$ reduces to the Schur function $s_{\lambda}$, and when $t=1$ to the monomial symmetric function $m_{\lambda}$; and in $\S 3$ that when $t=q^{-1}, q$ a prime power, the $P_{\lambda}(x ; t)$ have a combinatorial significance via the Hall algebra. There is at
least one other value of $t$ that is of particular interest, namely $t=-1$ : the simmetric functions $Q_{\lambda}(x ;-1)$ were introduced in Schur's 1911 paper [S5] on the projective representations of the symmetric and alternating groups, where they play a role analogous to that of the Schur functions in connection with the linear representations of the symmetric groups (Chapter I, §7).
To simplify notation, we shall write $q_{r}, P_{\lambda}, Q_{\lambda}$ for $q_{r}(x ;-1)$, $p_{\lambda}(x ;-1), Q_{\lambda}(x ;-1)$, respectively. As in $\S 2$, let

$$
Q(t)=\sum_{r \geqslant 0} q_{r} r^{r}
$$

(the symbol $t$ now being available again), then from (2.10) we have

$$
\begin{equation*}
Q(t)=\prod_{i} \frac{1+t x_{i}}{1-t x_{i}}=E(t) H(t) \tag{8.1}
\end{equation*}
$$

from which it follows that

$$
Q(t) Q(-t)=1
$$

that is to say

$$
\begin{equation*}
\sum_{r+s=n}(-1)^{r} q_{r} q_{s}=0 \tag{8.2}
\end{equation*}
$$

for all $n \geqslant 1$. When $n$ is odd, (8.2) tells us nothing. When $n$ is even, say $n=2 m$, it becomes

$$
q_{2 m}=\sum_{r=1}^{m-1}(-1)^{r-1} q_{r} q_{2 m-r}+\frac{1}{2}(-1)^{m-1} q_{m}^{2}
$$

which shows that $q_{2 m} \in \mathrm{Q}\left[q_{1}, q_{2}, \ldots, q_{2 m-1}\right]$ and hence (by induction on m) that

$$
\begin{equation*}
q_{2 m} \in \mathbf{Q}\left[q_{1}, q_{3}, q_{5}, \ldots, q_{2 m-1}\right] \tag{8.3}
\end{equation*}
$$

Another consequence of ( $8.2^{\prime}$ ) is the following. Recall (Chapter I, §1, Example 9) that a partition is strict if all its parts are distinct.
(8.4) Let $\lambda$ be a partition of $n$. Either $\lambda$ is strict, or $q_{\lambda}=q_{\lambda_{1}} q_{\lambda_{2}} \ldots$ is a Z-linear combination of the $q_{\mu}$ such that $\mu$ is strict and $\mu>\lambda$.

Proof. We proceed by induction, assuming the result true for all $\mu>\lambda$. (The induction starts at $\lambda=(n)$, which is strict.) If $\lambda$ is not strict then for some pair $i<j$ we have $\lambda_{i}=\lambda_{j}=m$, say. The relation (8.2') then shows that $q_{\lambda}$ is a Z-linear combination of the $q_{\mu}$ where $\mu=R_{i j}^{r} \lambda, 1 \leqslant r \leqslant m$. By Chapter I, (1.14) each such $\mu$ is $>\lambda$, and so (8.3) is true for $\mu$. This completes the induction step. |

Let $\Gamma$ denote the subring of $\Lambda$ generated by the $q_{r}$ :

$$
\Gamma=\mathbf{Z}\left[q_{1}, q_{2}, q_{3}, \ldots\right]
$$

$\Gamma$ is a graded ring: $\Gamma=\oplus_{n \geqslant 0} \Gamma^{n}$, where $\Gamma^{n}=\Gamma \cap \Lambda^{n}$ is spanned by the $q_{\lambda}$ such that $|\lambda|=n$.

Also let $\Gamma_{\mathbf{Q}}=\Gamma \otimes \mathbf{Q}=\mathbf{Q}\left[q_{1}, q_{2}, q_{3}, \ldots\right]$. From (8.3) it follows that $\Gamma_{\mathrm{Q}}$ is generated over $\mathbf{Q}$ by the $q_{r}$ with $r$ odd. In fact these elements are algebraically independent. For from (8.1) we have

$$
\begin{aligned}
\frac{Q^{\prime}(t)}{Q(t)} & =\frac{E^{\prime}(t)}{E(t)}+\frac{H^{\prime}(t)}{H(t)}=P(t)+P(-t) \\
& =2 \sum_{r \geqslant 0} p_{2 r+1} t^{2 r}
\end{aligned}
$$

and therefore

$$
r q_{r}=2\left(p_{1} q_{r-1}+p_{3} q_{r-3}+\ldots\right)
$$

The series on the right terminates with $p_{r-1} q_{1}$ if $r$ is even, and with $p_{r}$ if $r$ is odd. Hence these equations enable us to express the odd power sums in terms of the $q$ 's, and vice versa. Since (Chapter I, §2) $p_{1}, p_{3}, \ldots$ are algebraically independent over $\mathbf{Q}$, it follows that
(8.5) We have

$$
\Gamma_{\mathbf{Q}}=\mathbf{Q}\left[p_{r}: r \text { odd }\right]=\mathbf{Q}\left[q_{r}: r \text { odd }\right]
$$

and the $q_{r}$ ( $r$ odd ) are algebraically independent over $\mathbf{Q}$.
A partition $\lambda$ is odd if all its parts are odd. For each $n \geqslant 1$, the number $N_{n}$ of odd partitions of $n$ is equal to the number of strict partitions of $n$, because the generating function for odd partitions is

$$
\sum_{\lambda \text { odd }} t^{|\lambda|}=\prod_{r \geqslant 1} \frac{1}{1-t^{2 r-1}}=\prod_{r \geqslant 1} \frac{1-t^{2 r}}{1-t^{r}}=\prod_{r \geqslant 1}\left(1+t^{r}\right),
$$

which is the generating function for strict partitions.
(8.6) (i) The $q_{\lambda}, \lambda$ odd, form a $\mathbf{Q}$-basis of $\Gamma_{\mathbf{Q}}$.
(ii) The $q_{\lambda}, \lambda$ strict, form a Z-basis of $\Gamma$.

Proof. (i) follows from (8.5), and shows that the dimension of $\Gamma_{\mathrm{Q}}^{n}$ is $N_{n}$. From (8.4) it follows that the $q_{\lambda}$, where $\lambda$ is a strict partition of $n$, span $\Gamma^{n}$ and hence also $\Gamma_{Q}^{n}$. Since there are $N_{n}$ of them, they form a $\mathbf{Q}$-basis of $\Gamma_{Q}^{n}$. Hence they are linearly independent over $\mathbf{Q}$, and therefore also over $\mathbf{Z}$, which proves (ii).

Consider now $P_{\lambda}=P_{\lambda}(x ;-1)$ and $Q_{\lambda}=Q_{\lambda}(x ;-1)$. The symmetric functions $P_{\lambda}$ are well-defined and non-zero for all partitions $\lambda$, and since the transition matrix $M(P, m)$ is unitriangular, it follows that the $P_{\lambda}$ form a Z-basis of $\Lambda$. On the other hand, $b_{\lambda}(-1)=\prod_{i>1} \varphi_{m_{i}(\lambda)}(-1)$ will vanish if any $m_{i}(\lambda)>1$, that is to say if the partition $\lambda$ is not strict. If $\lambda$ is strict, we have $b_{\lambda}(-1)=2^{l(\lambda)}$, and hence

$$
Q_{\lambda}= \begin{cases}2^{l(\lambda)} P_{\lambda} & \text { if } \lambda \text { is strict }  \tag{8.7}\\ 0 & \text { otherwise. }\end{cases}
$$

From (2.15), with $t=-1$, we have
(8.8) Let $\lambda$ be a strict partition of length $\leqslant n$. Then $Q_{\lambda}$ is equal to the coefficient of $t^{\lambda}=t_{1}^{\lambda_{1}} t_{2}^{\lambda_{2}} \ldots$ in

$$
Q\left(t_{1}, \ldots, t_{n}\right)=\prod_{i=1}^{n} Q\left(t_{i}\right) \prod_{i<j} F\left(t_{i}^{-1} t_{j}\right)
$$

where

$$
F(y)=\frac{1-y}{1+y}=1+2 \sum_{r \geqslant 1}(-1)^{r} y^{r} .
$$

As in $\S 2,(8.8)$ is equivalent to the raising operator formula

$$
Q_{\lambda}=\prod_{i<j} \frac{1-R_{i j}}{1+R_{i j}} q_{\lambda} .
$$

From (8.8') it follows that $Q_{\lambda}$ is of the form

$$
Q_{\lambda}=q_{\lambda}+\sum_{\mu>\lambda} a_{\lambda \mu} q_{\mu}
$$

with coefficients $a_{\lambda \mu} \in \mathbf{Z}$. If $\lambda$ is strict, it follows from (8.4) that we have

$$
Q_{\lambda}=q_{\lambda}+\sum_{\mu>\lambda} a_{\lambda \mu}^{\prime} q_{\mu}
$$

where now the sum on the right is restricted to strict partitions $\mu>\lambda$. From (8.6) (ii) it now follows that
(8.9) The $Q_{\lambda}, \lambda$ strict, form a Z-basis of $\Gamma$.

We come next to Schur's definition of $Q_{\lambda}$. From (8.8) it follows that
$Q_{(r, s)}$ (where $r>s \geqslant 0$ ) is the coefficient of $t^{r} u^{s}$ in $Q(t, u)=$ $Q(t) Q(u) F\left(t^{-1} u\right)$, so that

$$
\begin{equation*}
Q_{(r, s)}=q_{r} q_{s}+2 \sum_{i=1}^{s}(-1)^{i} q_{r+i} q_{s-i} \tag{8.10}
\end{equation*}
$$

If $r \leqslant s$ we define $Q_{(r, s)}$ by this formula. Then it follows from (8.2) that $Q_{(s, r)}=-Q_{(r, s)}$.

Now let $\lambda$ be a strict partition, which we may write in the form $\lambda=\left(\lambda_{1}, \lambda_{2}, \ldots, \lambda_{2 n}\right)$ where $\lambda_{1}>\ldots>\lambda_{2 n} \geqslant 0$. Then the $2 n \times 2 n$ matrix

$$
M_{\lambda}=\left(Q_{\left(\lambda_{i}, \lambda_{j}\right)}\right)
$$

is skew-symmetric, and Schur's definition of $Q_{\lambda}$ (which for us is a theorem) reads:

$$
\begin{equation*}
Q_{\lambda}=\operatorname{Pf}\left(M_{\lambda}\right) \tag{8.11}
\end{equation*}
$$

where $\operatorname{Pf}\left(M_{\lambda}\right)$ is the Pfaffian of the skew-symmetric matrix $M_{\lambda}$. (We recall that if $A=\left(a_{i j}\right)$ is a skew symmetric matrix of even size $2 n \times 2 n$, its determinant is a perfect square: $\operatorname{det}(A)=\operatorname{Pf}(A)^{2}$, where

$$
\operatorname{Pf}(A)=\sum_{w} \varepsilon(w) \cdot a_{w(1) w(2)} \ldots a_{w(2 n-1) w(2 n)}
$$

summed over $w \in S_{2 n}$ such that $w(2 r-1)<w(2 r)$ for $1 \leqslant r \leqslant n$, and $w(2 r-1)<w(2 r+1)$ for $1 \leqslant r \leqslant n-1$.

Proof of (8.11). From above, $\operatorname{Pf}\left(M_{\lambda}\right)$ is a sum of terms of the form

$$
\pm Q_{\left(\mu_{1}, \mu_{2}\right)} \ldots Q_{\left(\mu_{2 n-1}, \mu_{2 n}\right)}
$$

where $\left(\mu_{1}, \ldots, \mu_{2 n}\right)=\left(\lambda_{i_{1}}, \ldots, \lambda_{i_{2 n}}\right)$ is a derangement of $\left(\lambda_{1}, \ldots, \lambda_{2 n}\right)$. By (8.8) the term just written is equal to the coefficient of $t^{\lambda}=t_{1}^{\lambda_{1}} t_{2}^{\lambda_{2}} \ldots$ in

$$
\pm Q\left(t_{1}\right) \ldots Q\left(t_{2 n}\right) F\left(t_{i_{1}}^{-1} t_{i_{2}}\right) \ldots F\left(t_{i_{2 n-1}}^{-1} t_{i_{2 n}}\right)
$$

and consequently $\operatorname{Pf}\left(M_{\lambda}\right)$ is the coefficient of $t^{\lambda}$ in

$$
\begin{equation*}
Q\left(t_{1}\right) \ldots Q\left(t_{2 n}\right) \operatorname{Pf}\left(\left(F\left(t_{i}^{-1} t_{j}\right)\right)\right) \tag{1}
\end{equation*}
$$

Now $F\left(t_{i}^{-1} t_{j}\right)=\left(t_{i}-t_{j}\right) /\left(t_{i}+t_{j}\right)$, and it is well-known that

$$
\begin{equation*}
\operatorname{Pf}\left(\frac{t_{i}-t_{j}}{t_{i}+t_{j}}\right)=\prod_{i<j}\left(\frac{t_{i}-t_{j}}{t_{i}+t_{j}}\right) . \tag{2}
\end{equation*}
$$

From (1) and (2) it follows that $\operatorname{Pf}\left(M_{\lambda}\right)$ is the coefficient of $t^{\lambda}$ in

$$
Q\left(t_{1}\right) \ldots Q\left(t_{2 n}\right) \prod_{i<j} F\left(t_{i}^{-1} t_{j}\right)=Q\left(t_{1}, \ldots, t_{2 n}\right)
$$

hence by (8.8) is equal to $Q_{\lambda}$. I
(For a proof of (2) (which is a classical result) see Example 5 below; and for an extension of (8.11) to skew $Q$-functions $Q_{\lambda / \mu}$, see Example 9.)

Next, the scalar product of $\S 4$ is not well-defined on all of $\Lambda$ when $t=-1$, because $z_{\lambda}(t)$ has a pole at $t=-1$ if any part of $\lambda$ is even. But if $\lambda$ is odd it follows from the definition of $z_{\lambda}(t)$ that $z_{\lambda}(-1)=2^{-l(\lambda)} z_{\lambda}$, and hence the restriction to $\Gamma$ of the scalar product is well defined and positive definite. We have
(8.12) (i) $\left\langle Q_{\lambda}, Q_{\mu}\right\rangle=2^{l(\lambda)} \delta_{\lambda \mu}$ if $\lambda, \mu$ are strict.
(ii) $\left\langle p_{\lambda}, p_{\mu}\right\rangle=2^{-l(\lambda)} z_{\lambda} \delta_{\lambda \mu}$ if $\lambda, \mu$ are odd.

These correspond to the series expansions

$$
\begin{align*}
\prod_{i, j} \frac{1+x_{i} y_{j}}{1-x_{i} y_{j}} & =\sum_{\lambda \text { strict }} 2^{-l(\lambda)} Q_{\lambda}(x) Q_{\lambda}(y)  \tag{8.13}\\
& =\sum_{\lambda \text { odd }} 2^{l(\lambda)} z_{\lambda}^{-1} p_{\lambda}(x) p_{\lambda}(y)
\end{align*}
$$

obtained by setting $t=-1$ in (4.4) and (4.1).
Let $\lambda, \mu$ be partitions such that $\mu$ is strict, $\lambda \supset \mu$ and $\lambda-\mu$ is a horizontal strip. Then $m_{i}(\lambda) \leqslant 2$ for each $i \geqslant 1$, and hence the formula (5.8) shows that

$$
\varphi_{\lambda / \mu}(-1)= \begin{cases}2^{a(\lambda-\mu)} & \text { if } \lambda \text { is strict }  \tag{8.14}\\ 0 & \text { otherwise }\end{cases}
$$

where $a(\lambda-\mu)$ is the number of integers $i \geqslant 1$ such that $\lambda-\mu$ has a square in the $i$ th column but not in the $(i+1)$ st column. Hence from (5.7) we have

$$
\begin{equation*}
P_{\mu} q_{r}=\sum_{\lambda} 2^{a(\lambda-\mu)} P_{\lambda} \tag{8.15}
\end{equation*}
$$

for a strict partition $\mu$, where the sum is over strict $\lambda \supset \mu$ such that $\lambda-\mu$ is a horizontal strip.

This result may be more conveniently rephrased in terms of shifted diagrams. As in Chapter I, $\S 1$, Example 9 , let $S(\lambda)$ be the shifted diagram of a strict partition $\lambda$, obtained from the usual diagram by shifting the $i$ th row ( $i-1$ ) squares to the right, for each $i>1$. The effect of replacing
$\lambda-\mu$ by $S(\lambda-\mu)=S(\lambda)-S(\mu)$ is to convert the horizontal strip into a disjoint union of border strips, and $a(\lambda-\mu)$ is just the number of connected components of $S(\lambda-\mu)$, i.e. the number of border strips of which it is composed.

We are therefore led to define a shifted tableau $T$ of shape $S(\lambda-\mu)=$ $S(\lambda)-S(\mu)$, where $\lambda$ and $\mu$ are strict partitions, to be a sequence of strict partitions $\left(\lambda^{(0)}, \lambda^{(1)}, \ldots, \lambda^{(r)}\right.$ ) such that $\mu=\lambda^{(0)} \subset \lambda^{(1)} \subset \ldots \subset \lambda^{(r)}=\lambda$, and such that each $S\left(\lambda^{(i)}-\lambda^{(i-1)}\right)$ is a disjoint union of border strips; or, equivalently, as a labelling of the squares of $S(\lambda-\mu)$ with the integers $1,2, \ldots, r$ which is weakly increasing along rows and down columns and is such that no $2 \times 2$ block of squares bears the same label, so that for each $i$ the set of squares labelled $i$ is a disjoint union of border strips. If we denote by $b(T)$ the number of border strips of which $T$ is composed, then it follows from (8.14) and (5.11) that, for $\lambda$ and $\mu$ strict partitions, we have

$$
\begin{equation*}
Q_{\lambda / \mu}=\sum_{T} 2^{b(T)} x^{T} \tag{8.16}
\end{equation*}
$$

summed over shifted tableaux of shape $S(\lambda-\mu)$, where as usual $x^{T}$ is the monomial defined by the tableau $T$.

Remarks. 1. The diagonal squares $(i, i)$ in $S(\lambda)-S(\mu)$ must all lie in distinct border strips, so that $b(T) \geqslant l(\lambda)-l(\mu)$ for each tableau $T$ of shape $S(\lambda)-S(\mu)$.
2. The formula (8.16) shows that $Q_{\lambda / \mu}$, like $s_{\lambda / \mu}$ but unlike $Q_{\lambda / \mu}(x ; t)$ for arbitrary $t$, depends only on the skew diagram $\lambda-\mu$.

For later purposes it will be convenient to rephrase (8.16). Let $\mathbf{P}^{\prime}$ denote the ordered alphabet $\left\{1^{\prime}<1<2^{\prime}<2<\ldots\right\}$. The symbols $1^{\prime}, 2^{\prime}, \ldots$ are said to be marked, and we shall denote by $|a|$ the unmarked version of any $a \in \mathbf{P}^{\prime}$. Let $\lambda$ and $\mu$ again be strict partitions such that $\lambda \supset \mu$. A marked shifted tableau $T$ of shape $S(\lambda-\mu)$ is a labelling of the squares of $S(\lambda-\mu)$ with symbols from $\mathbf{P}^{\prime}$ such that (compare Chapter I, §5, Example 23):
(M1) The labels increase (in the weak sense) along each row and down each column.
(M2) Each column contains at most one $k$, for each $k \geqslant 1$.
(M3) Each row contains at most one $k^{\prime}$, for each $k \geqslant 1$.
The conditions (M2) and (M3) say that for each $k \geqslant 1$, the set of squares labelled $k$ (resp. $k^{\prime}$ ) is a horizontal (resp. vertical) strip.

The weight (or content) of $T$ is the sequence ( $\alpha_{1}, \alpha_{2}, \ldots$ ) where $\alpha_{k}$, for each $k \geqslant 1$, is the number of squares in $T$ labelled either $k$ or $k^{\prime}$.

Let $|T|$ be the (unmarked) shifted tableau obtained from $T$ by deleting all the marks, i.e., by replacing each $a \in \mathbf{P}^{\prime}$ by its unmarked version $|a|$. The conditions (M1)-(M3) ensure that no $2 \times 2$ block of squares can bear
the same label in $|T|$, so that $|T|$ is a shifted tableau as defined above. Moreover, in each border strip $\beta$ in $|T|$, each square of which is labelled $k$, it is easy to see that the conditions (M1)-(M3) uniquely determine the assignment of marked and unmarked symbols ( $k^{\prime}$ or $k$ ) to the squares of $\beta$, with the exception of the square $(i, j) \in \beta$ nearest the diagonal (i.e. such that $(i+1, j) \notin \beta$ and $(i, j-1) \notin \beta)$, which can be marked or unmarked. Call this square the free square of $\beta$.
From this discussion it follows that the number of free squares in $|T|$ is $b(|T|)$, and hence that the number of marked shifted tableaux $T$ arising from a given (unmarked) shifted tableau $|T|$ is $2^{b(|T|)}$. Consequently (8.16) may be restated as

$$
\begin{equation*}
Q_{\lambda / \mu}=\sum_{T} x^{|T|} \tag{8.16'}
\end{equation*}
$$

summed over marked shifted tableaux of shape $S(\lambda-\mu)$.
Equivalently:

$$
Q_{\lambda / \mu}=\sum_{\nu} K_{\lambda-\mu, \nu}^{\prime} m_{\nu}
$$

where $K_{\lambda-\mu, \nu}^{\prime}$ is the number of marked shifted tableaux $T$ of shape $\lambda-\mu$ and weight $\nu$.

Remarks. 1. From (5.2) we have

$$
Q_{\lambda / \mu}=\sum_{\nu} f_{\mu \nu}^{\lambda}(-1) Q_{\nu}
$$

Since $f_{\mu \nu}^{\lambda}(t) \in \mathbf{Z}[t]$, this shows that $Q_{\lambda / \mu}$ is a $\mathbf{Z}$-linear combination of the $Q_{\nu}$ (where we may assume $\nu$ strict, otherwise $Q_{\nu}=0$ ). Hence it follows from (8.8) that $Q_{\lambda / \mu} \in \Gamma$ for all $\lambda, \mu$.
2. The formula ( 8.16 ) or ( $8.16^{\prime}$ ) may be taken as a combinatorial definition of the $Q$-functions, and the same remarks apply as in the case of the Schur functions (Chapter I, §5). In particular, it is not at all obvious from this definition that $Q_{\lambda / \mu}$ is in fact a symmetric function of the $x_{i}$.

To conclude, we shall mention without proof two positivity results, and their combinatorial interpretations.
(8.17) (i) If $\mu, \nu$ are strict partitions and

$$
P_{\mu} P_{\nu}=\sum_{\lambda} f_{\mu \nu}^{\lambda} P_{\lambda}
$$

then $f_{\mu \nu}^{\lambda} \geqslant 0$ for all $\lambda$.
(ii) If $\lambda$ is a strict partition and

$$
P_{\lambda}=\sum_{\mu} g_{\lambda \mu} s_{\mu}
$$

then $g_{\lambda \mu} \geqslant 0$ for all $\mu$.
Since the $P_{\lambda}$ (for all partitions $\lambda$ ) form a $\mathbf{Z}$-basis of $\Lambda$, the coefficients $f_{\mu \nu}^{\lambda}\left(=f_{\mu \nu}^{\lambda}(-1)\right.$, in the notation of §3) are integers; and since $P_{\mu}, P_{\nu} \in \Gamma_{\mathrm{Q}}$ by virtue of (8.7) and (8.9), we have $f_{\mu \nu}^{\lambda}=0$ if $\lambda$ is not strict.

In (8.17)(ii), the matrix ( $g_{\lambda \mu}$ ) is strictly upper unitriangular, and is the inverse of the matrix $K(-1)(\S 6)$. Hence (8.17)(ii) says that the matrix $K(-1)^{-1}$ has non-negative (integer) entries; or again, in the notation of Chapter I, §7, Example 9, that $P_{\lambda} \in \Lambda_{+}$for all strict partitions $\lambda$.

There are at least three ways of proving both parts of (8.17). One is to interpret the coefficients $f_{\mu \nu}^{\lambda}$ and $g_{\lambda \mu}$ in terms of the projective representations of the symmetric groups, in the same sort of way that the Little-wood-Richardson coefficients $c_{\mu \nu}^{\lambda}$ can be shown to be non-negative by reference to the linear representations of the symmetric groups. Another way is to interpret the $Q_{\lambda}$ as cohomology classes dual to Schubert cycles in the Grassmannian of maximal isotropic subspaces in $\mathbf{C}^{2 n}$ relative to a skew-symmetric bilinear form of rank $n$. The third method, which we shall describe below, provides a shifted analogue of the Littlewood-Richardson rule for $f_{\mu \nu}^{\lambda}$, and likewise for $g_{\lambda \mu}$. A fourth possibility, which as far as I know has not been investigated, would be to interpret the $P_{\lambda}$ ( $\lambda$ strict) as traces of polynomial functors on an appropriate category, in analogy with Schur's theory (Chapter I, Appendix A).

Let $T$ be a marked (shifted or unshifted) tableau, that is to say a labelling of the shape of $T$ with symbols from the alphabet $\mathbf{P}^{\prime}$, satisfying the conditions (M1)-(M3) above. As in Chapter I, §9, $T$ gives rise to a word $w=w(T)$ by reading the symbols in $T$ from right to left in successive rows, starting with the top row. Let $\hat{w}$ be the word obtained from $w$ by reading $w$ from right to left, and then replacing each $k$ by $(k+1)^{\prime}$ and each $k^{\prime}$ by $k$, for all $k \geqslant 1$. For example, if $w=11^{\prime} 2^{\prime} 12^{\prime} 2$, then $\hat{w}=$ 3'22'212'.

Suppose $T$ contains altogether $n$ symbols, so that $w$ is of length $n$; then $w \hat{w}$ is of length $2 n$, say $w \hat{w}=a_{1} a_{2} \ldots a_{2 n}$. For each $k \geqslant 1$ and $0 \leqslant p \leqslant 2 n$, let $m_{k}\left(a_{1} \ldots a_{p}\right)$ denote the number of $k$ 's among $a_{1}, \ldots, a_{p}$. The word $w=w(T)$ is said to have the lattice property if, for each $k$ and $p$ as above, whenever $m_{k+1}\left(a_{1} \ldots a_{p}\right)=m_{k}\left(a_{1} \ldots a_{p}\right)$, we have $\left|a_{p+1}\right| \neq k+1$ (i.e. $a_{p+1}$ is neither $k+1$ nor $\left.(k+1)^{\prime}\right)$.

With this explained we can now state
(8.18) (i) Let $\lambda, \mu, \nu$ be strict partitions. Then the coefficient $f_{\mu \nu}^{\lambda}$ of $P_{\lambda}$ in $P_{\mu} P_{\nu}$ is equal to the number of marked shifted tableaux $T$ of shape $S(\lambda-\mu)$ ad weight $\nu$ such that
(a) $w(T)$ has the lattice property;
(b) for each $k \geqslant 1$, the last (i.e. rightmost) occurrence of $k^{\prime}$ in $w(T)$ precedes the last occurrence of $k$.
(ii) Let $\lambda, \mu$ be partitions, $\lambda$ strict. Then the coefficient $g_{\lambda \mu}$ of $s_{\mu}$ in $P_{\lambda}$ is equal to the number of (unshifted) marked tableaux $T$ of shape $\mu$ and weight $\lambda$ satisfying (a) and (b) above.

These theorems are due to J. Stembridge [S28].

## Examples

1. The formula (2.1) for $P_{\lambda}\left(x_{1}, \ldots, x_{n} ; t\right)$ no longer makes sense at $t=-1$, even if $\lambda$ is strict (unless $l(\lambda)=n$ or $n-1$ ), because $v_{\lambda}(t)$ vanishes at $t=-1$ if $l(\lambda)<n-1$. But the alternative formula (2.2) does make sense at $t=-1$, and for a strict partition $\lambda$ of length $l \leqslant n$ it gives

$$
P_{\lambda}\left(x_{1}, \ldots, x_{n}\right)=\sum_{w \in S_{n} / S_{n-1}} w\left(x^{\lambda} \Pi \frac{x_{i}+x_{j}}{x_{i}-x_{j}}\right),
$$

where $S_{n-l}$ acts on $x_{l+1}, \ldots, x_{n}$, and the product on the right is over pairs ( $i, j$ ) such that $1 \leqslant i \leqslant l$ and $1 \leqslant i<j \leqslant n$. This leads to the following expression for $Q_{\lambda}\left(x_{1}, \ldots, x_{n}\right)$ let $\pi_{n}$ denote the linear operator on the ring $L_{n}=\mathbf{Z}\left[x_{1}^{ \pm 1}, \ldots, x_{n}^{ \pm 1}\right]$ of Laurent polynomials defined by

$$
\pi_{n} f=\sum_{w \in S_{n}} w\left(f x^{\delta} / a_{\delta}\right)
$$

where $\delta=(n-1, n-2, \ldots, 1,0)$ and $a_{\delta}=\Pi_{i<j}\left(x_{i}-x_{j}\right)$. Then we have, for a strict partition $\lambda$ of length $l \leqslant n$,

$$
Q_{\lambda}\left(x_{1}, \ldots, x_{n}\right)=2^{l} \pi_{n}\left(x^{\lambda} f_{l}\right),
$$

where $f_{l}=\Pi\left(1+x_{i}^{-1} x_{j}\right)$, the product being taken over pairs $(i, j)$ such that $1 \leqslant i \leqslant l$ and $j>i$.
2. Suppose $\lambda$ is a strict partition of length $n$ or $n-1$. Then in $n$ variables $x_{1}, \ldots, x_{n}$ we have $P_{\lambda}=s_{\lambda-\delta} s_{\delta}$, where $\delta=(n-1, n-2, \ldots, 1,0)$. (Use (2.1) with $t=-1$, and observe that $\Pi_{i<j}\left(x_{i}+x_{j}\right)=\Pi_{i<j}\left(x_{i}^{2}-x_{j}^{2}\right) /\left(x_{i}-x_{j}\right)=s_{\delta}$.)
3. (a) Let $\omega$ be the involution on $\Lambda$ defined in Chapter I, §2. From (8.1) we have $\omega q_{n}=q_{n}$ for all $n \geqslant 1$, hence $\omega$ fixes each element of the ring $\Gamma$, and in particular $\omega Q_{\lambda}=Q_{\lambda}$ and $\omega P_{\lambda}=P_{\lambda}$ for each strict partition $\lambda$.
(b) We have $P_{\delta}=s_{\delta}$ for any 'staircase' partition $\delta=(n-1, n-2, \ldots, 1,0)$. (For $P_{\delta}$ is of the form

$$
P_{\delta}=\sum_{\mu<\delta} g_{\delta \mu} s_{\mu}
$$

with $g_{\delta \delta}=1$; from (a) above it follows that $g_{\delta \mu}=g_{\delta \mu^{\prime}}$, and since $\mu \leqslant \delta$ implies $\mu^{\prime} \geqslant \delta$ (Chapter I, (1.11)) it follows that $g_{\delta \mu}=0$ unless $\mu=\delta$.
4. Let $A=\left(a_{i j}\right)$ be a 'marked matrix', i.e. with entries $a_{i j} \in \mathbf{P}^{\prime} \cup\{0\}$. The matrix $|A|=\left(\left|a_{i j}\right|\right)$ obtained by deleting the marks is a matrix of non-negative integers. Deduce from (8.13) and (8.16) that for any two partitions $\mu$ and $\nu$ the number of marked matrices $A$ such that $|A|$ has row sums $\mu_{i}$ and column sums $\nu_{i}$ is equal to the number of pairs ( $S, T$ ) of marked shifted tableaux of the same (shifted) shape, such that $S$ has weight $\mu, T$ has weight $\nu$, and the main diagonal in $T$ is unmarked.
5. Let $P\left(t_{1}, \ldots, t_{m}\right)$, where $m$ is even, denote the Pfaffian of the $m \times m$ matrix $M$ whose $(i, j)$ element is $\left(t_{i}-t_{j}\right) /\left(t_{i}+t_{j}\right)$. From the definition of the Pfaffian it follows that

$$
\begin{equation*}
P\left(t_{1}, \ldots, t_{m}\right)=\sum_{i=2}^{m}(-1)^{i} P\left(t_{1}, t_{i}\right) P\left(t_{2}, \ldots, \hat{t}_{i}, \ldots, t_{m}\right) \tag{1}
\end{equation*}
$$

Also it is clear that

$$
U\left(t_{1}, \ldots, t_{m}\right)=P\left(t_{1}, \ldots, t_{m}\right) \prod_{i<j}\left(t_{i}+t_{j}\right)
$$

is a homogeneous polynomial in the $t_{i}$, of degree $\frac{1}{2} m(m-1)$. Now $P^{2}=\operatorname{det} M$ vanishes whenever two of the $t_{i}$ are equal, hence the same is true of the polynomial $U$, and therefore $U$ is divisible by $V=\Pi_{i<j}\left(t_{i}-t_{j}\right)$. Since $U$ and $V$ have the same degree, we conclude that $U=c_{m} V$ for some constant $c_{m}$ depending only on $m$, and hence that

$$
\operatorname{Pf}\left(\frac{t_{i}-t_{j}}{t_{i}+t_{j}}\right)=c_{m} \prod_{i<j} \frac{t_{i}-t_{j}}{t_{i}+t_{j}}
$$

It remains to show that $c_{m}=1$. From the relation (1), on multiplying both sides by $\Pi_{i<j}\left(t_{i}+t_{j}\right)$ and then comparing the coefficients of $t_{1}^{m-1} t_{2}^{m-2} \ldots t_{m-1}$ on either side, we obtain

$$
c_{m}=\sum_{i=2}^{m}(-1)^{i} c_{m-2}=c_{m-2}
$$

and hence $c_{m}=c_{m-2}=\ldots=c_{2}=1$.
6. (a) Show that

$$
Q(t)=\exp \left(\sum_{r \text { odd }} 2 p_{r} t^{r} / r\right)
$$

and hence that

$$
q_{n}=\sum_{\rho \text { odd }} z_{\rho}^{-1} 2^{l(\rho)} p_{\rho}
$$

(b) Let $V$ be a vector space (over a field of characteristic zero) with basis $\dot{v}_{1}, \ldots, v_{n}$, and let $S_{n}$ act on $V$ by permuting the $v_{i}$. Then $S_{n}$ acts on the exterior Igebra $\wedge V$ : if the character of this representation is $\varphi_{n}$, then

$$
\operatorname{ch}\left(\varphi_{n}\right)=q_{n}
$$

(We have $\varphi_{n}(w)=\Pi_{i-1}^{n}\left(1+\xi_{i}\right)$, where the $\xi_{i}$ are the eigenvalues of $w \in S_{n}$ acting on $V$ (i.e. of the permutation matrix corresponding to $w$ ). To each $r$-cycle in $w$ there correspond $r$ eigenvalues $\xi_{i}$, namely the $r$ th roots of unity. The corresponding product $\Pi\left(1+\xi_{i}\right)$ is zero if $r$ is even, and is equal to 2 if $r$ is odd. It follows that $\varphi_{n}(w)=0$ if $w$ has any cycles of even length, and that $\varphi_{n}(w)=2^{l}$ if $w$ consists of $l$ cycles of odd length. The result now follows from (a) above.)
(c) From (8.1) we have

$$
q_{n}=\sum_{r+s=n} e_{r} h_{s}=\sum_{a+b=n-1} 2 s_{(a \mid b)}
$$

by Pieri's formula (Chapter I, (5.16)).
7. (a) Let

$$
S_{\lambda}=S_{\lambda}(x ;-1)=\operatorname{det}\left(q_{\lambda_{i}-i+j}\right)
$$

as in (4.5). In the notation of Chapter I, §5, Example 23, $S_{\lambda}=s_{\lambda}(x /-x)$. Hence (loc. cit.) we have

$$
S_{\lambda}=\sum_{T} x^{T}
$$

summed over all (unshifted) marked tableaux of shape $\lambda$.
(b) From the definition, $S_{\lambda}$ is of the form

$$
\begin{equation*}
S_{\lambda}=q_{\lambda}+\sum_{\mu>\lambda} c_{\lambda \mu} q_{\mu} \tag{1}
\end{equation*}
$$

with integer coefficients $c_{\lambda \mu}$. (The transition matrix $M(S, q)$ is the same as $M(s, h)$, hence is the transposed inverse of the Kostka matrix $K$ (Chapter I, §6).) Hence $S_{\lambda} \in \Gamma$ for all partitions $\lambda$, and if $\lambda$ is strict it follows from (8.4) that

$$
\begin{equation*}
S_{\lambda}=q_{\lambda}+\sum_{\mu>\lambda} c_{\lambda \mu}^{\prime} q_{\mu} \tag{2}
\end{equation*}
$$

where the sum is now over strict partitions $\mu>\lambda$. Hence from (8.6) (ii) it follows that the $S_{\lambda}, \lambda$ strict, form another $\mathbf{Z}$-basis of the ring $\Gamma$.
(c) Show that

$$
\begin{aligned}
S_{\lambda} & =\sum_{\rho \text { odd }} z_{\rho}^{-1} 2^{l(\rho)} \chi_{\rho}^{\lambda} p_{\rho} \\
& =s_{\lambda} * q_{n}=\operatorname{ch}\left(\chi^{\lambda} \varphi_{n}\right)
\end{aligned}
$$

where (Example 4 (b)) $\varphi_{n}$ is the character of the exterior algebra representation of $S_{n}$.
8. For each $f \in \Gamma$, let $f^{\perp}: \Gamma \rightarrow \Gamma$ denote the adjoint of multiplication by $f$, so that

$$
\left\langle f^{\perp} g, h\right\rangle=\langle g, f h\rangle
$$

for all $g, h \in \Gamma$. Let

$$
Q^{\perp}(t)=\sum_{n \geqslant 0} q_{n}^{\perp} t^{n}
$$

then (\$5, Example 8) we have

$$
\begin{equation*}
Q^{\perp}(t) Q(u)=F(-t u) Q(u) Q^{\perp}(t) \tag{1}
\end{equation*}
$$

as operators on $\Gamma$, where $t$ and $u$ are commuting indeterminates, $Q(u)$ is the operator of multiplication by $Q(u)$, and $F(y)=(1-y) /(1+y)$ as in (8.8).
(a) Define operators $B_{m}: \Gamma \rightarrow \Gamma$ for each $m \in \mathbf{Z}$ by

$$
B_{m}=q_{m}-q_{m+1} q_{1}^{\perp}+q_{m+2} q_{2}^{\perp}-\ldots
$$

(where $q_{m}=0$ if $m<0$, and $q_{0}=0$ ). Collectively we have

$$
B(t)=\sum_{m \in \mathbf{Z}} B_{m} t^{m}=Q(t) Q^{\perp}\left(-t^{-1}\right)
$$

More generally, if $t_{1}, \ldots, t_{n}$ are commuting indeterminates, let

$$
\begin{equation*}
B\left(t_{1}, \ldots, t_{n}\right)=\prod_{i=1}^{n} Q\left(t_{i}\right) \prod_{i=1}^{n} Q^{\perp}\left(-t_{i}^{-1}\right) \tag{2}
\end{equation*}
$$

From (1) it follows that

$$
\begin{equation*}
B(t) B(u)=F\left(t^{-1} u\right) B(t, u) \tag{3}
\end{equation*}
$$

and hence by iteration that

$$
\begin{equation*}
B\left(t_{1}\right) \ldots B\left(t_{n}\right)=B\left(t_{1}, \ldots, t_{n}\right) \prod_{i<j} F\left(t_{i}^{-1} t_{j}\right) \tag{4}
\end{equation*}
$$

Since $Q^{\perp}(t)(1)=1$, it follows from (2) and (4) that

$$
B\left(t_{1}\right) \ldots B\left(t_{n}\right)(1)=Q\left(t_{1}, \ldots, t_{n}\right)
$$

in the notation of (8.8), and hence that

$$
\begin{equation*}
Q_{\lambda}=B_{\lambda_{1}} \ldots B_{\lambda_{t}}(1) \tag{5}
\end{equation*}
$$

if $\lambda$ is a strict partition of length $l$.
(b) Let

$$
\begin{aligned}
\varphi(t, u) & =\varphi(u, t)=F\left(t^{-1} u\right)+F\left(t u^{-1}\right) \\
& =2 \sum_{n \in \mathbf{Z}}(-1)^{n} t^{-n} u^{n}
\end{aligned}
$$

a formal Laurent series in $t$ and $u$.

Show that
(6)

$$
Q(t) Q(u) \varphi(t, u)=\varphi(t, u)
$$

(The coefficient of $t^{r} u^{s}$ on the left-hand side is

$$
a_{r s}=\sum(-1)^{c} q_{a} q_{b}
$$

summed over $a, b \in \mathbf{N}$ and $c \in \mathbf{Z}$ such that $a+c=r$ and $b-c=s$, so that $a+b=r+s$; hence

$$
(-1)^{r} a_{r s}=\sum_{a+b-r+s}(-1)^{a} q_{a} q_{b}=\delta_{0, r+s}
$$

since $Q(t) Q(-t)=1$.)
From (6) it follows by taking adjoints that

$$
Q^{\perp}(t) Q^{\perp}(u) \varphi(t, u)=\varphi(t, u)
$$

and hence that

$$
\begin{equation*}
B(t, u) \varphi(t, u)=\varphi(t, u) . \tag{7}
\end{equation*}
$$

Finally, from (3) and (7) we have

$$
\begin{equation*}
B(t, u)+B(u, t)=B(t, u) \varphi(t, u)=\varphi(t, u) \tag{8}
\end{equation*}
$$

Explicitly, (8) says that for all $r, s \in \mathbf{Z}$ :
(C1) $B_{r} B_{s}=-B_{s} B_{r}$ if $r+s \neq 0$, and in particular $B_{r}^{2}=0$ if $r \neq 0$;
(C2) $B_{r} B_{-r}+B_{-r} B_{r}=2(-1)^{r}$ if $r \neq 0$, and $B_{0}^{2}=1$.
(c) Let $\alpha=\left(\alpha_{1}, \ldots, \alpha_{n}\right) \in \mathbf{Z}^{n}$ be any sequence of $n$ integers. We define $Q_{\alpha}$ to be the coefficient of $t^{\alpha}=t_{1}^{\alpha_{1}} \ldots t_{n}^{\alpha_{n}}$ in the Laurent series $Q\left(t_{1}, \ldots, t_{n}\right)$, or equivalently

$$
Q_{\alpha}=B_{\alpha_{1}} \ldots B_{\alpha_{n}}(1)
$$

Use the commutation rules (C1), (C2) to show that
(i) if $\left|\alpha_{1}\right|, \ldots,\left|\alpha_{n}\right|$ are all distinct, then $Q_{\alpha}$ is skew-symmetric in $\alpha$ (i.e. $Q_{w \alpha}=$ $\varepsilon(w) Q_{\alpha}$ for all $w \in S_{n}$ ), and $Q_{\alpha}=0$ if any $\alpha_{i}$ is negative.
(ii) If $\alpha_{i}=\alpha_{i+1}$ for some $i$, then $Q_{\alpha}=0$.
(iii) If $\alpha_{i}=-\alpha_{i+1}=r \neq 0$, then $Q_{\alpha}=0$ if $r>0$, and $Q_{\alpha}=2(-1)^{r} Q_{\beta}$ if $r<0$, where $\beta$ is the sequence obtained from $\alpha$ by deleting $\alpha_{i}$ and $\alpha_{i+1}$.

Deduce that, for each $\alpha \in \mathbf{Z}^{n}, Q_{\alpha}$ is either zero or is equal to $\pm 2^{r} Q_{\lambda}$ for some integer $r \geqslant 0$ and strict partition $\lambda$ [H7].
9. Let $\lambda=\left(\lambda_{1}, \ldots, \lambda_{m}\right)$ and $\mu=\left(\mu_{1}, \ldots, \mu_{n}\right)$ be strict partitions such that $\lambda_{1}>$ $\ldots>\lambda_{m}>0$ and $\mu_{1}>\ldots>\mu_{n} \geqslant 0$. Since we allow $\mu_{n}=0$ we may assume that $m+n$ is even. Then we have

$$
Q_{\lambda / \mu}=\operatorname{Pf}\left(M_{\lambda, \mu}\right)
$$

where $M_{\lambda, \mu}$ is the skew-symmetric matrix of $m+n$ rows and columns

$$
M_{\lambda, \mu}=\left(\begin{array}{cc}
M_{\lambda} & N_{\lambda, \mu} \\
-N_{\lambda, \mu} & 0
\end{array}\right)
$$

in which $M_{\lambda}=\left(Q_{\left(\lambda_{i}, \lambda_{j}\right)}\right)$ as in (8.11), and $N_{\lambda, \mu}$ is the $m \times n$ matrix $\left(q_{\lambda_{i}-\mu_{j}}\right)$.
(With the notation of Example 8, we have

$$
Q_{\lambda / \mu}=2^{-l(\mu)} Q_{\mu}^{\perp}\left(Q_{\lambda}\right)
$$

and by (8.8) $Q_{\mu}^{\perp}\left(Q_{\lambda}\right)$ is the coefficient of $t^{\lambda} u^{\mu}$ in

$$
\prod_{k} Q^{\perp}\left(u_{k}\right)\left(\prod_{i} Q\left(t_{i}\right)\right) \prod_{i<j} F\left(t_{i}^{-1} t_{j}\right) \prod_{k<l} F\left(u_{k}^{-1} u_{l}\right)
$$

which by use of Example 8, formula (1) is equal to

$$
\begin{equation*}
\prod_{i} Q\left(t_{i}\right) \prod_{i<j} F\left(t_{i}^{-1} t_{j}\right) \prod_{k<l} F\left(u_{k}^{-1} u_{l}\right) \prod_{i, k} F\left(-t_{i} u_{k}\right) . \tag{1}
\end{equation*}
$$

The product of all the $F$ 's in this expression can be written in the form

$$
\prod_{r<s} F\left(v_{r}^{-1} v_{s}\right)
$$

where $\left(v_{1}, v_{2}, \ldots, v_{m+n}\right)=\left(-u_{n}^{-1}, \ldots,-u_{2}^{-1},-u_{1}^{-1}, t_{1}, \ldots, t_{m}\right)$. Hence the same argument as in the proof of (8.11) shows that the expression (1) is the Pfaffian of the matrix

$$
\left(a_{r} a_{s} F\left(v_{r}^{-1} v_{s}\right)\right)
$$

of $m+n$ rows and columns, where $a_{r}=1$ if $r \leqslant n$, and $a_{r}=Q\left(v_{r}\right)$ if $r>n$. On picking out the coefficient of $t^{\lambda} u^{\mu}$, we obtain the result.)
10. Define a ring homomorphism $\varphi: \Lambda \rightarrow \Gamma$ by

$$
\varphi\left(e_{n}\right)=q_{n} \quad(n \geqslant 1) .
$$

(a) Show that
(i) $\varphi\left(h_{n}\right)=q_{n}$,
(ii) $\varphi\left(p_{n}\right)=2 p_{n}$ if $n$ is odd, and $\varphi\left(p_{n}\right)=0$ if $n$ is even,
(iii) $\varphi$ commutes with the involution $\omega$,
(iv) $\varphi\left(s_{(a \mid b-1)}\right)=\frac{1}{2}\left(q_{a} q_{b}+Q_{(a, b)}\right)$.
(b) Let $\lambda, \mu$ be strict partitions of lengths $m, n$ respectively, such that $\lambda \supset \mu$. Let $D(\lambda)=\left(\lambda_{1}, \ldots, \lambda_{m} \mid \lambda_{1}-1, \ldots, \lambda_{m}-1\right)$ be the 'double' of $\lambda$ (Chapter I, §1, Example 9 ), and define $D(\mu)$ similarly as the double of $\mu$. Then we have

$$
\varphi\left(s_{D(\lambda) / D(\mu)}\right)=2^{n-m} Q_{\lambda / \mu}^{2}
$$

(From Chapter I, §5, Example 22 we have

$$
s_{D(\lambda) / D(\mu)}=(-1)^{n} \operatorname{det}\left(\begin{array}{cc}
C_{\lambda} & H_{\lambda, \mu} \\
-E_{\lambda, \mu} & 0
\end{array}\right)
$$

where $C_{\lambda}=\left(s_{\left(\lambda_{i} \mid \lambda_{j}-1\right)}\right), H_{\lambda, \mu}=\left(h_{\lambda_{i}-\mu_{j}}\right)$ and $E_{\lambda, \mu}=\left(e_{\lambda_{j}-\mu_{l}}\right)$. By use of (a) it follows that

$$
\varphi\left(s_{D(\lambda) / D(\mu)}\right)=2^{n-m} \operatorname{det}\left(M_{\lambda, \mu}+B\right)
$$

where $M_{\lambda, \mu}$ is the matrix defined in Example 9, and $B=\left(b_{i j}\right)$ is given by

$$
b_{i j}= \begin{cases}q_{\lambda_{i}} q_{\lambda_{j}} & \text { if } 1 \leqslant i, j \leqslant m, \\ 0 & \text { otherwise. }\end{cases}
$$

From Example 9 it now follows that

$$
\varphi\left(s_{D(\lambda) / D(\mu)}\right)=2^{n-m} Q_{\lambda / \mu}^{2} \operatorname{det}\left(1+B M_{\lambda, \mu}^{-1}\right)
$$

and since $\operatorname{rank}(B)=1$,

$$
\operatorname{det}\left(1+B M_{\lambda, \mu}^{-1}\right)=1+\operatorname{trace}\left(B M_{\lambda, \mu}^{-1}\right)=1
$$

because $M_{\lambda, \mu}^{-1}$ is skew-symmetric.)
(c) By applying $\varphi$ to both sides of the identity of Chapter I, §5, Example $9(b)$, we obtain

$$
\sum_{\lambda} 2^{-l(\lambda)} Q_{\lambda}(x)^{2}=\prod_{i, j}\left(1+x_{i} x_{j}\right) /\left(1-x_{i} x_{j}\right)
$$

(i.e. (8.13) with $x_{i}=y_{i}$ for each $i$ ).
11. (a) With the notation of Example 8, show that for $r$ odd

$$
\begin{equation*}
p_{r}^{\perp}=\frac{1}{2} r \frac{\partial}{\partial p_{r}} \tag{1}
\end{equation*}
$$

(Use (8.12) (ii).)
From Example 6(a) we have

$$
\begin{equation*}
q_{n}=\sum_{\rho} 2^{l(\rho)} z_{\rho}^{-1} p_{\rho} \tag{2}
\end{equation*}
$$

summed over odd partitions $\rho$ of $n$. Deduce from (1) and (2) that

$$
\begin{equation*}
p_{r}^{\perp} q_{n}=q_{n-r} \tag{3}
\end{equation*}
$$

for all $n \geqslant 1$; equivalently,

$$
p_{r}^{\perp} Q(t)=t^{r} Q(t) .
$$

Deduce that

$$
\begin{equation*}
p_{r}^{\perp} Q\left(t_{1}, \ldots, t_{n}\right)=p_{r}\left(t_{1}, \ldots, t_{n}\right) Q\left(t_{1}, \ldots, t_{n}\right) . \tag{4}
\end{equation*}
$$

(Observe that $p_{r}{ }^{\perp}$ is a derivation, by (1) above.) More generally, for any odd partition $\rho$,

$$
\begin{equation*}
p_{\rho}^{\perp} Q\left(t_{1}, \ldots, t_{n}\right)=p_{\rho}\left(t_{1}, \ldots, t_{n}\right) Q\left(t_{1}, \ldots, t_{n}\right) . \tag{5}
\end{equation*}
$$

Hence $p_{\rho}^{\perp} Q_{\lambda}$ ( $\lambda$ a strict partition) is equal to the coefficient of $t^{\lambda}$ in the right-hand side of (5).
(b) Let $\lambda$ be a strict partition of length $l$ and let $r \geqslant 1$ be odd. From (4) above we have

$$
\begin{equation*}
p_{r}^{\perp} Q_{\lambda}=\sum_{i=1}^{l} Q_{\lambda-r \varepsilon_{i}} \tag{6}
\end{equation*}
$$

where $\lambda-r \varepsilon_{i}=\left(\lambda_{1}, \ldots, \lambda_{i}-r, \ldots, \lambda_{l}\right)$. From Example 8(c) it follows that $Q_{\lambda-r \varepsilon_{i}}=0$ unless either (i) $\lambda_{i} \geqslant r$ and the numbers $\lambda_{1}, \ldots, \lambda_{i}-r, \ldots, \lambda_{l}$ are all distinct, or (ii) $r=\lambda_{i}+\lambda_{j}$ for some $j>i$.

In case (i), either $\lambda_{j}>\lambda_{i}-r>\lambda_{j+1}$ for some $j<m$, or else $\lambda_{m}>\lambda_{i-r}$, and $Q_{\lambda-r \varepsilon_{i}}=(-1)^{j-i} Q_{\mu}$ where $\mu=\left(\lambda_{1}, \ldots, \lambda_{i-1}, \lambda_{i+1}, \ldots, \lambda_{j}, \lambda_{i}-r, \ldots\right)$. The shifted diagram $S(\mu)$ of $\mu$ is obtained from $S(\lambda)$ by removing a border strip $\beta$ of length $r$, starting in the $i$ th row and ending in the $j$ th row, and hence of height (Chapter I , §1) $\mathrm{ht}(\beta)=j-i$. Define $\varepsilon(\beta)=(-1)^{\mathrm{ht}(\beta)}$.
In case (ii) we have

$$
Q_{\lambda-r \varepsilon_{i}}=(-1)^{j-i-1+\lambda_{j}} 2 Q_{\mu}
$$

where now $\mu$ is the strict partition obtained from $\lambda$ by deleting $\lambda_{i}$ and $\lambda_{j}$. To express this in terms of shifted diagrams, we define a double strip $\delta$ to be a skew diagram formed by the union of two border ships which both end on the main diagonal. A double strip $\delta$ can be cut into two non-empty connected pieces, one piece $\alpha$ consisting of the diagonals in $\delta$ of length 2 , and the other piece $\beta$ consisting of the border strip formed by the diagonals of length 1 . Define $\varepsilon(\delta)=$ $(-1)^{d}$, where $d=\frac{1}{2}|\alpha|+h t(\beta)$. From (6) and (7) we now have

$$
\begin{equation*}
p_{r}^{\perp} Q_{\lambda}=\sum \varepsilon(\gamma) Q_{\mu} \tag{8}
\end{equation*}
$$

summed over strict partitions $\mu \subset \lambda$ such that $|\lambda|-|\mu|=r$ and $\gamma=S(\lambda-\mu)$ is either a border strip (case (i)) or a double strip (case (ii)).
(c) From (8) we obtain the following combinatorial rule for computing $X_{\rho}^{\lambda}(-1)=$ $\left\langle Q_{\lambda}, p_{\rho}\right\rangle$, where $\lambda$ is strict and $\rho$ is odd:

$$
X_{\rho}^{\lambda}(-1)=\sum_{S} \varepsilon(S)
$$

summed over all sequences of strict partitions $S=\left(\lambda^{(0)}, \lambda^{(1)}, \ldots, \lambda^{(m)}\right)$ such that $m=l(\rho), 0=\lambda^{(0)} \subset \lambda^{(1)} \subset \ldots \subset \lambda^{(m)}=\lambda$, and such that each $S\left(\lambda^{(i)}-\lambda^{(i-1)}\right)=\gamma_{i}$ is a border strip or double strip of length $\rho_{i}$, and $\varepsilon(S)=\prod_{i=1}^{m} \varepsilon\left(\gamma_{i}\right)$. (Compare Chapter I, §7, Example 5.)
12. From Example 11(c) (or from §7, Example 4) it follows that if $\lambda$ is a strict partition of $n$, then $X_{\left(1^{n}\right)}^{\lambda}(-1)$ is equal to the number $g^{\lambda}$ of shifted standard tableaux of shape $S(\lambda)$, obtained by labelling the squares of $S(\lambda)$ with the numbers $1,2, \ldots, n$, with strict increase along each row and down each column.
Just as in the case of ordinary standard tableaux (Chapter I, $\S 5$, Example 2) there is a formula for $g^{\lambda}$ in terms of hook-lengths. For each square $x$ in $S(\lambda)$, the
hook-length $h(x)$ is defined to be the hook-length at $x$ in the double diagram $D(\lambda)=\left(\lambda_{1}-1, \lambda_{2}-1, \ldots \mid \lambda_{1}, \lambda_{2}, \ldots\right)$. Then we have

$$
\begin{equation*}
g^{\lambda}=n!/ \prod_{x \in S(\lambda)} h(x) \tag{1}
\end{equation*}
$$

This formula is equivalent to one due to Schur [S5]:

$$
\begin{equation*}
g^{\lambda}=\frac{n!}{\lambda!} \prod_{i<j} \frac{\lambda_{i}-\lambda_{j}}{\lambda_{i}+\lambda_{j}} \tag{2}
\end{equation*}
$$

where $\lambda!=\lambda_{1}!\lambda_{2}!\ldots$. The equivalence of (1) and (2) follows from the fact that the numbers $h(x)$ for $x$ in the $i$ th row of $S(\lambda)$ are $\lambda_{i}+\lambda_{i+1}, \lambda_{i}+\lambda_{i+2}, \ldots$ and $\lambda_{i}, \lambda_{i}-1, \ldots, 2,1$ with the exception of $\lambda_{i}-\lambda_{i+1}, \lambda_{i}-\lambda_{i+2}, \ldots$.
Since the $g^{\lambda}$ clearly satisfy the recurrence relation

$$
g^{\lambda}=\sum_{i>1} g^{\lambda^{(i)}}
$$

where $\lambda^{(i)}$ is the partition obtained from $\lambda$ by replacing $\lambda_{i}$ by $\lambda_{i}-1$, the proof of (2) reduces to verifying the identity

$$
\sum_{i} \lambda_{i}=\sum_{i} \lambda_{i} \prod_{j \neq i} \frac{\lambda_{i}+\lambda_{j}}{\lambda_{i}+\lambda_{j}-1} \cdot \frac{\lambda_{i}-\lambda_{j}-1}{\lambda_{i}-\lambda_{j}}
$$

which may be proved by considering the expansion into partial fractions of the function

$$
(2 t-1) \prod_{i} \frac{\left(t+\lambda_{i}\right)\left(t-\lambda_{i}-1\right)}{\left(t+\lambda_{i}-1\right)\left(t-\lambda_{i}\right)} .
$$

13. Let $A$ denote the skew-symmetric matrix

$$
\left(\left(x_{i}-x_{j}\right) /\left(x_{i}+x_{j}\right)\right)_{1<i, j<i}
$$

and for each strict partition $\lambda=\left(\lambda_{1}, \ldots, \lambda_{l}\right)$ of length $l \leqslant n$ let $B_{\lambda}$ denote the $n \times l$ natrix $\left(x_{i}^{\lambda^{\prime}}\right)$. Let

$$
A_{\lambda}\left(x_{1}, \ldots, x_{n}\right)=\left(\begin{array}{cc}
A & B_{\lambda} \\
-B_{\lambda}^{\prime} & 0
\end{array}\right)
$$

which is a skew-symmetric matrix of $n+l$ rows and columns.
Now define

$$
\mathrm{Pf}_{\lambda}\left(x_{1}, \ldots, x_{n}\right)
$$

o be the Pfaffian of $A_{\lambda}\left(x_{1}, \ldots, x_{n}\right)$ if $n+l$ is even, and to be the Pfaffian of $1_{\lambda}\left(x_{1}, \ldots, x_{n}, 0\right)$ if $n+l$ is odd. (In the latter case, the effect of introducing the extra variable $x_{n+1}=0$ is to border $A$ with a column of 1 's and a row of -1 's. show that

$$
P_{\lambda}\left(x_{1}, \ldots, x_{n}\right)=\mathrm{Pf}_{\lambda}\left(x_{1}, \ldots, x_{n}\right) / \mathrm{Pf}_{0}\left(x_{1}, \ldots, x_{n}\right) .
$$

(Multiply both sides of the formula (1) of Example 1 by

$$
\mathrm{Pf}_{0}\left(x_{1}, \ldots, x_{n}\right)=\prod_{i<j}\left(x_{i}-x_{j}\right) /\left(x_{i}+x_{j}\right)
$$

This formula for $P_{\lambda}$ may be regarded as an analogue of the definition (Chapter I, (3.1)) of the Schur function $s_{\lambda}\left(x_{1}, \ldots, x_{n}\right)$ as a quotient of alternants.

## Notes and references

As explained in the preface, we have stopped short of describing the rôle played by Schur's $Q$-functions in the construction of the projective representations of the symmetric groups. Apart from Schur's original paper [S5] of 1911, there are several recent accounts available: the monograph [H7] of Hoffman and Humphreys, and the papers of Józefiak [J15] and Stembridge [S28].

It has become clear in recent years that Schur's $Q$-functions arise naturally in other contexts: as (up to scalar factors) the characters of certain irreducible representations of the Lie superalgebra $Q(n)$ [S11]; as the cohomology classes dual to Schubert cycles in isotropic Grassmannians [J16], [P2]; as the polynomial solutions of the BKP hierarchy of partial differential equations [Y1]; and as generating functions for the zonal spherical functions (Chapter VII, §1) of the twisted Gelfand pair $\left(S_{2 n}, H_{n}, \zeta\right)$, where $H_{n}$ is the hyperoctahedral group, embedded in the symmetric group $S_{2 n}$ as the centralizer of a fixed-point free involution, as in Chapter VII, §2, and $\zeta$ is the composition of the sign character of $S_{n}$ with the projection $H_{n} \rightarrow S_{n}$ [S29].

A combinatorial theory of shifted tableaux, parallel to that for ordinary (unshifted) tableaux, has been developed independently by Sagan [S1] and Worley [W4]; it includes shifted versions of the Robinson-Schensted-Knuth correspondence, Knuth's relations, jeu de taquin, etc. In particular, (8.17) (ii) (originally conjectured by R. Stanley) is due to Sagan and Worley (independently), and Stembridge's proof of (8.18) relies on their theory. Finally, we may remark that setting $t=-1$ in Chapter II, (4.11) will provide another expression for $f_{\mu \nu}^{\lambda}=f_{\mu \nu}^{\lambda}(-1)$.

Example 3(b) is due to R. Stanley.
Example 8. The operators $B_{n}$ are the analogues, for Schur's $Q$-functions, of Bernstein's operators (Chapter I, §5, Example 29). See [H7] and [J11].

Examples 9 and 10. These results are due to Józefiak and Pragacz [J17]. Our proof of the Pfaffian formula for $Q_{\lambda / \mu}$ (Example 9) is somewhat different from theirs.

Example 13 is due to Nimmo [N2].

## IV

## THE CHARACTERS OF $G L_{n}$ OVER A FINITE FIELD

## 1. The groups $L$ and $M$

Let $k$ be a finite field with $q$ elements, $\bar{k}$ an algebraic closure of $k$. Let

$$
F: x \mapsto x^{q}
$$

be the Frobenius automorphism of $\bar{k}$ over $k$. For each $n \geqslant 1$, the set $k_{n}$ of fixed points of $F^{n}$ in $\bar{k}$ is the unique extension of $k$ of degree $n$ in $\bar{k}$.

Let $M$ denote the multiplicative group of $\bar{k}$, and $M_{n}$ the multiplicative group of $k_{n}$, so that $M_{n}=M^{F^{n}}$.
If $m$ divides $n$, the norm map $N_{n, m}: M_{n} \rightarrow M_{m}$ defined by

$$
N_{n, m}(x)=x^{\left(q^{n}-1\right) /\left(q^{m}-1\right)}=\prod_{i=0}^{d-1} F^{m i} x
$$

where $d=n / m$, is a surjective homomorphism. The groups $M_{n}$ and the homomorphisms $N_{n, m}$ form an inverse system. Let

$$
K=\lim _{\leftarrow} M_{n}
$$

be their inverse limit, which is a profinite group. The character group of $K$ is therefore a discrete group

$$
\hat{K}=L=\lim _{\rightarrow} \hat{M}_{n}
$$

where $\hat{M}_{n}$ is the character group of $M_{n}$. Whenever $m$ divides $n, \hat{M}_{m}$ is embedded in $\hat{M}_{n}$ by the transpose of the norm homomorphism $N_{n, m}$.
Both groups $L$ and $M$ are (non-canonically) isomorphic to the group of roots of unity in $\mathbf{C}$ of order prime to $p=$ char. $k$.

The Frobenius map $F: \xi \mapsto \xi^{q}$ acts on $L$. For each $n \geqslant 1$ let $L_{n}=L^{F^{n}}$ be the group of elements $\xi \in L$ fixed by $F^{n}$, so that $L=U_{n \geqslant 1} L_{n}$, and $L_{m} \subset L_{n}$ if and only if $m$ divides $n$. The canonical mapping of $\hat{M}_{n}$ into $L$ is an isomorphism of $\hat{M}_{n}$ onto $L_{n}$. By identifying $\hat{M}_{n}$ with $L_{n}$ by means of this isomorphism, we define a pairing of $L_{n}$ with $M_{n}$ :

$$
\langle\xi, x\rangle_{n}=\xi(x)
$$

for $\xi \in L_{n}$ and $x \in M_{n}$. (The suffix $n$ is necessary because these pairings
(for different $n$ ) are not coherent: if $m$ divides $n$ and $\xi \in L_{m}, x \in M_{m}$ we have $\langle\xi, x\rangle_{n}=\left(\langle\xi, x\rangle_{m}\right)^{n / m}$.)

Finally, let $\Phi$ denote the set of $F$-orbits in $M$. Each such orbit is of the form $\left\{x, x^{q}, \ldots, x^{q^{d-1}}\right\}$ where $x^{q^{d}}=x$, and the polynomial

$$
f=\prod_{i=0}^{d-1}\left(t-x^{q^{\prime}}\right)
$$

belongs to $k[t]$ and is irreducible over $k$. Conversely, each irreducible monic polynomial $f \in k[t]$, with the single exception of the polynomial $t$, determines in this way an $F$-orbit in $M$. We shall therefore use the same letter $f$ to denote the polynomial and the orbit consisting of its roots in $\bar{k}$, and the letter $\Phi$ to denote the set of these irreducible polynomials.
Remark. For each $n \geqslant 1$ let $\mu_{n}=(\mathbf{Z} / n \mathbf{Z})(1)(\bar{k})$ be the group of $n$th roots of unity in $\bar{k}$, and let

$$
\hat{\mathbf{Z}}(1)(\bar{k})=\lim _{\leftarrow} \mu_{n}
$$

with respect to the homomorphisms $\mu_{n} \rightarrow \mu_{m}: x \rightarrow x^{n / m}$ whenever $m$ divides $n$ ([D2], §2). We have

$$
\hat{\mathbf{Z}}(1)(\bar{k})=K=\hat{L},
$$

the character group of $L$, so that $\hat{L}$ is a $\hat{\mathbf{Z}}$-module, where

$$
\hat{\mathbf{z}}=\lim _{\leftarrow}(\mathbf{Z} / n \mathbf{Z})=\prod_{p} \mathbf{Z}_{p}
$$

(direct product over all primes $p$ ).
Let $\hat{M}$ be the character group of $M$. Then we have

$$
\begin{aligned}
\hat{M} & \cong \operatorname{Hom}_{\hat{\mathbf{z}}}(\hat{L}, \hat{\mathbf{Z}}), \\
\hat{L} & \cong \operatorname{Hom}_{\hat{\mathbf{z}}}(\hat{M}, \hat{\mathbf{Z}})
\end{aligned}
$$

and therefore $\hat{M}=\hat{\mathbf{Z}}(-1)(\vec{k})$.
Moreover,

$$
\begin{aligned}
M & \cong(\mathbf{Q} / \mathbf{Z}) \otimes_{\mathbf{Z}} \hat{L} \\
L & =(\mathbf{Q} / \mathbf{Z})(1)(\bar{k}), \\
\mathbf{Q} / \mathbf{Z}) \otimes_{\mathbf{Z}} \hat{M} & =(\mathbf{Q} / \mathbf{Z})(-1)(\bar{k}) .
\end{aligned}
$$

## 2. Conjugacy classes

Let $G_{n}$ denote the group $G L_{n}(k)$ of invertible $n \times n$ matrices over the finite field $k$. Each $g \in G_{n}$ acts on the vector space $k^{n}$ and hence defines a $k[t]$-module structure on $k^{n}$, such that $t . v=g v$ for $v \in k^{n}$. We shall denote this $k[t]$-module by $V_{g}$. Clearly, two elements $g, h \in G_{n}$ are conjugate in $G_{n}$ if and only if $V_{g}$ and $V_{h}$ are isomorphic $k[t]$-modules. We may therefore write $V_{c}$ in place of $V_{g}$, where $c$ is the conjugacy class of $g$ in
$G_{n}$. The conjugacy classes of $G_{n}$ are thus in one-one correspondence with the isomorphism classes of $k[t]$-modules $V$ such that (i) $\operatorname{dim}_{k} V=n$, (ii) $w=0$ implies $v=0$.

Since $k[t]$ is a principal ideal domain, $V=V_{c}$ is a direct sum of cyclic modules of the form $k[t] /(f)^{m}$, where $m \geqslant 1, f \in \Phi$ and $(f)$ is the ideal in $k[t]$ generated by the polynomial $f$. Hence $V$ assigns to each $f \in \Phi$ a partition $\boldsymbol{\mu}(f)=\left(\mu_{1}(f), \mu_{2}(f), \ldots\right)$ such that

$$
\begin{equation*}
V \cong \underset{f, i}{\oplus} k[t] /(f)^{\mu_{i}(f)} \tag{2.1}
\end{equation*}
$$

In other words, $V$ determines a partition-valued function $\boldsymbol{\mu}$ on $\Phi$. Since $\operatorname{dim}_{k} k[t] /(f)^{\mu_{l}(f)}=d(f) \mu_{i}(f)$, where $d(f)$ is the degree of $f$, it follows that $\boldsymbol{\mu}$ must satisfy

$$
\begin{equation*}
\|\boldsymbol{\mu}\|=\sum_{f \in \Phi} d(f)|\boldsymbol{\mu}(f)|=n . \tag{2.2}
\end{equation*}
$$

Conversely, each function $\mu: \Phi \rightarrow \mathscr{P}$, where $\mathscr{P}$ is the set of all partitions, which satisfies (2.2) determines a $k[t]$-module $V$ of dimension $n$ by (2.1), and hence a conjugacy class $c_{\mu}$ in $G_{n}$. We shall write $V_{\mu}$ in place of $V_{c_{\mu}}$.

For each $f \in \Phi$ let $V_{(f)}$ denote the $f$-primary component of $V=V_{\mu}$, i.e. the submodule consisting of all $v \in V$ annihilated by some power of $f$. In the notation of (2.1),

$$
\begin{equation*}
V_{(f)} \cong \underset{i}{\oplus} k[t] /(f)^{\mu_{i}(f)} \tag{2.3}
\end{equation*}
$$

The $V_{(f)}$ are characteristic submodules of $V$, and $V$ is their direct sum. Hence if Latt $(M)$ denotes the lattice of submodules of a module $M$, and Aut $(M)$ the automorphism group, we have

$$
\begin{align*}
& \operatorname{Latt}(V) \cong \prod_{f \in \Phi} \operatorname{Latt}\left(V_{(f)}\right),  \tag{2.4}\\
& \operatorname{Aut}(V) \cong \prod_{f \in \Phi} \operatorname{Aut}\left(V_{(f)}\right) \tag{2.5}
\end{align*}
$$

Let $k[t]_{(f)}$ denote the localization of $k[t]$ at the prime ideal $(f)$, i.e. the ring of fractions $u / v$ where $u, v \in k[t]$ and $v \notin(f)$. Then $k[t]_{(f)}$ is a discrete valuation ring with residue field $k_{f}=k[t] /(f)$, of degree $d(f)$ over $k$, and $V_{(f)}$ is a finite $k[t]_{(f)}$-module of type $\boldsymbol{\mu}(f)$, by (2.3). Hence from Chapter II, (1.6) we have

$$
\begin{equation*}
\left|\operatorname{Aut}\left(V_{(f)}\right)\right|=a_{\mu(f)}\left(q_{f}\right) \tag{2.6}
\end{equation*}
$$

where $q_{f}=\operatorname{Card}\left(k_{f}\right)=q^{d(f)}$, and for any partition $\lambda$

$$
a_{\lambda}(q)=q^{|\lambda|+2 n(\lambda)} b_{\lambda}\left(q^{-1}\right)
$$

For any $g \in G_{n}$, the automorphisms of the $k[t]$-module $V_{g}$ are precisely the elements $h \in G_{n}$ which commute with $g$, i.e. Aut $\left(V_{g}\right)$ is the centralizer of $g$ in $G_{n}$. Hence, from (2.5) and (2.6), the centralizer of each $g \in c_{\mu}$ in $G_{n}$ has order

$$
\begin{equation*}
a_{\mu}=\prod_{f \in \Phi} a_{\mu(f)}\left(q_{f}\right) \tag{2.7}
\end{equation*}
$$

## Examples

1. For each $f \in \Phi$, say $f=t^{d}-\sum_{i=1}^{d} a_{i} t^{i-1}$, let $J(f)$ denote the 'companion matrix' for the polynomial $f$ :

$$
J(f)=\left(\begin{array}{cccc}
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
\ldots & & & \ldots \\
0 & 0 & 0 & 1 \\
a_{1} & a_{2} & a_{3} & a_{d}
\end{array}\right),
$$

and for each integer $m \geqslant 1$ let

$$
J_{m}(f)=\left(\begin{array}{cccc}
J(f) & 1_{d} & 0 & 0 \\
0 & J(f) & 1_{d} & 0 \\
\ldots & & & \ldots \\
0 & 0 & 0 & J(f)
\end{array}\right)
$$

with $m$ diagonal blocks $J(f)$. Then the Jordan canonical form for elements of the conjugacy class $c_{\boldsymbol{\mu}}$ is the diagonal sum of the matrices $J_{\boldsymbol{\mu}_{i}(f)}(f)$ for all $i \geqslant 1$ and $f \in \Phi$.
2. Sometimes it is more convenient to regard $\boldsymbol{\mu}: \Phi \rightarrow \mathscr{P}$ as a function on $M$, i.e. we define $\boldsymbol{\mu}(x)$ for each $x \in M$ to be the partition $\boldsymbol{\mu}(f)$, where $f$ is the $F$-orbit of $x$ (or the minimal polynomial of $x$ over $k$ ). We have then

$$
\|\boldsymbol{\mu}\|=\sum_{f \in \Phi} d(f)|\boldsymbol{\mu}(f)|=\sum_{x \in M}|\boldsymbol{\mu}(x)|
$$

and $\boldsymbol{\mu} \circ \boldsymbol{F}=\boldsymbol{\mu}$. With this notation, the characteristic polynomial of any element $g \in c_{\mu}$ is

$$
\prod_{f \in \Phi} f^{|\mu(f)|}=\prod_{x \in M}(t-x)^{|\mu(x)|}
$$

so that in particular

$$
\begin{aligned}
\operatorname{trace}(g) & =\sum_{x \in M}|\mu(x)| x \\
\operatorname{det}(g) & =\prod_{x \in M} x^{|\mu(x)|}
\end{aligned}
$$

3. The support $\operatorname{Supp}(\boldsymbol{\mu})$ of $\boldsymbol{\mu}: \Phi \rightarrow \mathscr{P}$ is the set of $f \in \Phi$ such that $\boldsymbol{\mu}(f) \neq 0$. Let $g \in c_{\mu}$. Then
(i) $g$ is unipotent $\Leftrightarrow \operatorname{Supp}(\mu)$ is the polynomial $t-1$.
(ii) $g$ is primary $\Leftrightarrow \operatorname{Supp}(\mu)=\{f\}$ for some $f \in \Phi$.
(iii) $g$ is regular $\Leftrightarrow \mu(f)$ has length $\leqslant 1$, for each $f \in \Phi$.
(iv) $g$ is semisimple $\Leftrightarrow \mu(f)^{\prime}$ has length $\leqslant 1$, for each $f \in \Phi$.
(v) $g$ is regular semisimple $\Leftrightarrow \mu(f)=0$ or (1) for each $f \in \Phi$.
4. Let $k_{n}$ be the unique extension of $k$ of degree $n$, and let $\alpha: k_{n} \rightarrow k^{n}$ be an isomorphism of $k$-vector spaces. For each $x \in M_{n}$, multiplication by $x$ defines an invertible $k$-linear map $k_{n} \rightarrow k_{n}$, hence an element $\tau(x) \in G_{n}$ : namely $\tau(x) v=$ $\alpha\left(x\left(\alpha^{-1} v\right)\right.$ ) for $v \in k^{n}$. The mapping $\tau: M_{n} \rightarrow G_{n}$ so defined is an injective homomorphism, so that $T_{n}=\tau\left(M_{n}\right)$ is a subgroup of $G_{n}$ isomorphic to $M_{n}$. If we change the isomorphism $\alpha$, we replace $T_{n}$ by a conjugate subgroup. Each $\tau(x) \in T_{n}$ is semisimple, with eigenvalues $F^{i} x(0 \leqslant i \leqslant n-1)$. Hence if $f_{x}$ is the minimal polynomial of $x$, the conjugacy class of $\tau(x)$ in $G_{n}$ is $c_{\mu}$, where $\mu\left(f_{x}\right)=\left(1^{n / d}\right)$ and $\mu(f)=0$ for $f \neq f_{x}$, and $d=d\left(f_{x}\right)$.
Now let $\nu=\left(\nu_{1}, \ldots, \nu_{r}\right)$ be any partition of $n$. Then $T_{\nu}=T_{\nu_{1}} \times \ldots \times T_{\nu_{r}}$ is a subgroup of $G_{\nu_{1}} \times \ldots \times G_{\nu}$, hence of $G_{n}$, and is well-defined up to conjugacy in $G_{n}$. Let $N_{\nu}$ be the normalizer of $T_{\nu}$, and $W_{\nu}=N_{\nu} / T_{\nu}$. Then $W_{\nu}$ is isomorphic to the centralizer of an element of cycle-type $\nu$ in the symmetric group $S_{n}$. In particular, $W_{n}$ is cyclic of order $n$, and is obtained by transporting $\operatorname{Gal}\left(k_{n} / k\right)$ via the isomorphism $\alpha$.

The groups $T_{\nu}$ (up to conjugacy in $G_{n}$ ) are the 'maximal tori' in $G_{n}$. Every semisimple element of $G_{n}$ lies in at least one such group.
5. Let $W_{\nu} \backslash T_{\nu}$ be the set of orbits of $W_{\nu}$ in $T_{\nu}$. Then the number of conjugacy classes in $G_{n}$ is equal to

$$
\sum_{|\nu|=n}\left|W_{\nu} \backslash T_{\nu}\right| .
$$

We may identify $T_{\nu}$ with $M_{\nu_{1}} \times \ldots \times M_{\nu_{r}}$, and hence an element $t \in T_{\nu}$ with a sequence $\left(x_{1}, \ldots, x_{r}\right)$, where $x_{i} \in M_{\nu_{1}}(1 \leqslant i \leqslant r)$. Given $t$, we define a function $\boldsymbol{\rho}=\boldsymbol{\rho}(t): \Phi \rightarrow \mathscr{P}$ as follows: for each $f \in \Phi$, the parts of $\boldsymbol{\rho}(f)$ are the numbers $\nu_{i} / d(f)$ for all $i$ such that $x_{i}$ is a root of $f$. We have $\|\rho(t)\|=n$, and $\boldsymbol{\rho}(t)$ depends only on the $W_{\nu}$-orbit of $t$ in $T_{\nu}$. Conversely, given $\mu: \Phi \rightarrow \mathscr{P}$ such that $\|\mu\|=n$, let $\nu$ be the partition of $n$ whose parts are the non-zero numbers $d(f)|\mu(f)|, f \in \Phi$. Then $\mu$ determines a unique $W_{\nu}$-orbit in $T_{\nu}$.

## 3. Induction from parabolic subgroups

Let $n=n_{1}+\cdots+n_{r}$, where the $n_{i}$ are positive integers, and let $V^{(i)}$ be the subspace of $V=k^{n}$ spanned by the first $n_{1}+\ldots+n_{i}$ basis vectors. Let $F$ denote the flag

$$
0=V^{(0)} \subset V^{(1)} \subset \ldots \subset V^{(r)}=V
$$

The parabolic subgroup $P$ of elements $g \in G_{n}$ which fix $F$ consists of all matrices of the form

$$
g=\left(\begin{array}{ccc}
g_{11} & g_{12} & g_{1 r} \\
0 & g_{22} & g_{2 r} \\
\ldots & & \ldots \\
0 & 0 & g_{r r}
\end{array}\right)
$$

where $g_{i i} \in G_{n_{i}}(1 \leqslant i \leqslant r)$.
Let $u_{i}$ be a class-function on $G_{n_{i}}(1 \leqslant i \leqslant r)$. Then the function $u$ defined by

$$
u(g)=\prod_{i=1}^{r} u_{i}\left(g_{i i}\right)
$$

is a class function on $P$. Let $u_{1}{ }^{\circ} u_{2} \circ \ldots \circ u_{r}$ denote the class-function on $G_{n}$ obtained by inducing $u$ from $P$ to $G_{n}$ :

$$
u_{1} \circ \ldots \circ u_{r}=\operatorname{ind}_{P}^{G_{n}}(u) .
$$

If each $u_{i}$ is a character of $G_{n_{i}}$, then $u_{1}{ }^{\circ} \ldots \circ u_{r}$ is a character of $G_{n}$.
Let $G_{n}=\cup_{i} t_{i} P$ be a left coset decomposition for $P$ in $G_{n}$. For any $x \in G_{n}$ we have

$$
\left(u_{1} \circ \ldots \circ u_{r}\right)(x)=\sum_{i} u\left(t_{i}^{-1} x t_{i}\right)
$$

with the understanding that $u$ vanishes outside $P$. Now $t^{-1} x t$ belongs to $P$ if and only if it fixes the flag $F$, i.e. if and only if $x$ fixes the flag $t F$, or equivalently $t F$ is a flag of submodules of the $k[t]$-module $V_{x}$. If we put $t V^{(i)}=W^{(i)}$ and

$$
t^{-1} x t=\left(\begin{array}{cccc}
h_{11} & h_{12} & \ldots & h_{1 r} \\
0 & h_{22} & \ldots & h_{2 r} \\
\ldots & & & \ldots \\
0 & 0 & & h_{r r}
\end{array}\right)
$$

then the module $W^{(i)} / W^{(i-1)}$ is isomorphic to $V_{h_{i i}}(1 \leqslant i \leqslant r)$. Hence
(3.1) Let $u_{i}$ be a class function on $G_{n_{i}}(1 \leqslant i \leqslant r)$. Then the value of the class function $u_{1} \circ \ldots \circ u_{r}$ at a class $c_{\mu}$ in $G_{n}$ is given by

$$
\left(u_{1} \circ \ldots \circ u_{r}\right)\left(c_{\mu}\right)=\sum g_{\mu^{(i)} \ldots \mu^{(r)}}^{\mu} u_{1}\left(c_{\mu^{(1)}}\right) \ldots u_{r}\left(c_{\mu^{(r)}}\right)
$$

summed over all sequences $\left(\mu^{(1)}, \ldots, \mu^{(r)}\right)$, where $c_{\mu^{(i)}}$ is a conjugacy class in $G_{n_{i}}(1 \leqslant i \leqslant r)$, and $g_{\mu^{(1)} \ldots \mu^{(r)}}^{\mu}$ is the number of sequences

$$
0=W^{(0)} \subset W^{(1)} \subset \ldots \subset W^{(r)}=V_{\mu}
$$

![](https://cdn.mathpix.com/cropped/2024_12_08_1df2f08562f6a73c5373g-286.jpg?height=59&width=909&top_left_y=114&top_left_x=172)
In particular, let $\pi_{\mu}$ be the characteristic function of the class $c_{\mu}$, which takes the value 1 at elements of $c_{\mu}$, and 0 elsewhere. Then from (3.1) we have

$$
\begin{equation*}
\pi_{\mu^{(1)}} \circ \ldots \circ \pi_{\mu^{(r)}}=\sum_{\mu} g_{\mu^{(1)} \ldots \mu^{(r)}} \pi_{\mu} \tag{3.2}
\end{equation*}
$$

Also from (2.7) it follows that

$$
\begin{equation*}
\left.g_{\mu^{(1)} \ldots \mu^{(r)}}^{\mu}=\prod_{f \in \Phi} G_{\mu^{\prime}}^{\mu}(f) f_{f}\right) \ldots \mu^{(r)}(f)\left(k[t]_{(f)}\right) \tag{3.3}
\end{equation*}
$$

where the $G$ 's on the right have the same meaning as in Chapter II.
Now let $A_{n}$ denote the space of complex-valued class functions on $G_{n}$ : this is a finite-dimensional complex vector space having the characteristic functions $\pi_{\mu}$ such that $\|\mu\|=n$ as a basis. It carries a hermitian scalar product:

$$
\langle u, v\rangle=\frac{1}{\left|G_{n}\right|} \sum_{g \in G_{n}} u(g) \overline{v(g)}
$$

Let

$$
A=\underset{n \geqslant 0}{\oplus} A_{n}
$$

(with the understanding that $G_{0}$ is a one-element group, so that $A_{0}=\mathbf{C}$ ). The induction product $u \circ v$ defined above defines a multiplication on $A$, and we extend the scalar product to the whole of $A$ by requiring that the components $A_{n}$ be mutually orthogonal.

From (3.2), (3.3), and Chapter II, §2 it follows that

$$
\begin{equation*}
A=H \otimes_{\mathbf{Z}} \mathbf{C} \tag{3.4}
\end{equation*}
$$

where $H$ is the tensor product (over $\mathbf{Z}$ ) of the Hall algebras $H\left(k[t]_{(f)}\right)$ for all $f \in \Phi$. In particular, $A$ is a commutative and associative graded ring, with identity element the characteristic function $\pi_{0}$ of $G_{0}$.

Next let $R_{n} \subset A_{n}$ be the Z-module generated by the characters of $G_{n}$. The irreducible characters of $G_{n}$ form an orthonormal basis of $R_{n}$, and $A_{n}=R_{n} \otimes_{z}$ C. Let

$$
R=\underset{n \geqslant 0}{\oplus} R_{n}
$$

since the induction product of characters is a character, $R$ is a subring of $A$, and we have $A=R \otimes_{Z} \mathbf{C}$.

## 4. The characteristic map

Let $X_{i, f}(i \geqslant 1, f \in \Phi)$ be independent variables over C. If $u$ is any symmetric function, we denote by $u(f)$ the symmetric function $u\left(X_{f}\right)=$ $u\left(X_{1, f}, X_{2, f}, \ldots\right)$. For example, $e_{n}(f)$ is the $n$th elementary symmetric function of the variables $X_{i, f}(i \geqslant 1, f$ fixed $)$, and $p_{n}(f)=\Sigma_{i} X_{i, f}^{n}$.

Let

$$
B=\mathbf{C}\left[e_{n}(f): n \geqslant 1, f \in \Phi\right]
$$

be the polynomial algebra over $\mathbf{C}$ generated by the $e_{n}(f)$. We grade $B$ by assigning degree $d(f)$ to each $X_{i, f}$, so that $e_{n}(f)$ is homogeneous of degree $n . d(f)$.

For each partition $\lambda$ and each $f \in \Phi$ let

$$
\begin{aligned}
\tilde{P}_{\lambda}(f) & =q_{f}^{-n(\lambda)} P_{\lambda}\left(X_{f} ; q_{f}^{-1}\right), \\
\tilde{Q}_{\lambda}(f) & =q_{f}^{|\lambda|+n(\lambda)} Q_{\lambda}\left(X_{f} ; q_{f}^{-1}\right) \\
& =a_{\lambda}\left(q_{f}\right) \tilde{P}_{\lambda}(f),
\end{aligned}
$$

where $P_{\lambda}, Q_{\lambda}$ are the symmetric functions defined in Chapter III, and $q_{f}=q^{d(f)}$. For each $\boldsymbol{\mu}: \Phi \rightarrow \mathscr{P}$ such that $\|\boldsymbol{\mu}\|<\infty$ let

$$
\tilde{P}_{\mu}=\prod_{f \in \Phi} \tilde{P}_{\mu(f)}(f), \quad \tilde{Q}_{\mu}=\prod_{f \in \Phi} \tilde{Q}_{\mu(f)}(f)=a_{\mu} \tilde{P}_{\mu}
$$

(almost all terms in these products are equal to 1 , because $\|\boldsymbol{\mu}\|$ is finite). Clearly $\tilde{P}_{\mu}$ and $\tilde{Q}_{\mu}$ are homogeneous elements of $B$, of degree $\|\mu\|$. By Chapter III, (2.7), ( $\tilde{P}_{\mu}$ ) and ( $\tilde{Q}_{\mu}$ ) are $\mathbf{C}$-bases of $B$. We define a hermitian scalar product on $B$ by requiring that these should be dual bases, i.e.

$$
\left\langle\tilde{P}_{\mu}, \tilde{Q}_{\nu}\right\rangle=\delta_{\mu \nu}
$$

for all $\boldsymbol{\mu}, \boldsymbol{\nu}$.
Now let ch: $A \rightarrow B$ be the $\mathbf{C}$-linear mapping defined by

$$
\operatorname{ch}\left(\pi_{\mu}\right)=\tilde{P_{\mu}}
$$

where as before $\pi_{\mu}$ is the characteristic function of the conjugacy class $c_{\mu}$. This map ch we call the characteristic map, and $\operatorname{ch}(u)$ is the characteristic of $u \in A$.
(4.1) ch: $A \rightarrow B$ is an isometric isomorphism of graded C-algebras.

Proof. Since the $\pi_{\mu}$ form a basis of $A$ and the $\tilde{P}_{\mu}$ a basis of $B$, ch is a linear isomorphism, which clearly respects the gradings. It follows from
(3.2) and Chapter III, (3.6) that ch is a ring homomorphism, and from (2.7) that it is an isometry.

From Chapter III, (4.4) we have

$$
\sum_{\lambda} q^{|\lambda|} P_{\lambda}\left(x ; q^{-1}\right) Q_{\lambda}\left(y ; q^{-1}\right)=\prod_{i, j}\left(1-x_{i} y_{i}\right) /\left(1-q x_{i} y_{i}\right) .
$$

If we replace $x_{i}$ by $X_{i, f} \otimes 1, y_{j}$ by $1 \otimes X_{j, f}$, and $q$ by $q_{f}$, this identity takes the form

$$
\sum_{\lambda} \tilde{P}_{\lambda}(f) \otimes \tilde{Q}_{\lambda}(f)=\prod_{i, j}\left(1-X_{i, f} \otimes X_{j, f}\right) /\left(1-q_{f} X_{i, f} \otimes X_{j, f}\right) .
$$

Hence, by taking the product over all $f \in \Phi$ on either side, we obtain

$$
\begin{equation*}
\sum_{\mu} \tilde{P}_{\mu} \otimes \tilde{Q}_{\mu}=\prod_{f \in \Phi} \prod_{i, j}\left(1-X_{i, f} \otimes X_{j, f}\right) /\left(1-q_{f} X_{i, f} \otimes X_{j, f}\right) \tag{4.2}
\end{equation*}
$$

Now take logarithms:

$$
\begin{aligned}
\log \left(\sum_{\mu} \tilde{P}_{\mu} \otimes \tilde{Q}_{\mu}\right) & =\sum_{f \in \Phi} \sum_{i, j}\left(\log \left(1-X_{i, f} \otimes X_{j, f}\right)-\log \left(1-q_{f} X_{i, f} \otimes X_{j, f}\right)\right) \\
& =\sum_{n \geqslant 1} \frac{1}{n} \sum_{f \in \Phi} \sum_{i, j}\left(q_{f}^{n}-1\right) X_{i, f}^{n} \otimes X_{j, f}^{n}
\end{aligned}
$$

so that

$$
\begin{equation*}
\log \left(\sum_{\mu} \tilde{P}_{\mu} \otimes \tilde{Q}_{\mu}\right)=\sum_{n \geqslant 1} \frac{1}{n} \sum_{f \in \Phi}\left(q_{f}^{n}-1\right) p_{n}(f) \otimes p_{n}(f) \tag{4.3}
\end{equation*}
$$

It is convenient at this stage to modify our notation for the power sums $p_{n}(f)$. Let $x \in M$ and let $f \in \Phi$ be the minimal polynomial for $x$ over $k$ (or, equivalently, the $F$-orbit of $x$ (\$1)). Define

$$
\tilde{p}_{n}(x)= \begin{cases}p_{n / d}(f) & \text { if } n \text { is a multiple of } d=d(f) \\ 0 & \text { otherwise }\end{cases}
$$

so that $\tilde{p}_{n}(x) \in B_{n}$, and $\tilde{p}_{n}(x)=0$ unless $x \in M_{n}$. In this notation (4.3) takes the form

$$
\begin{equation*}
\log \left(\sum_{\mu} \tilde{P}_{\mu} \otimes \tilde{Q}_{\mu}\right)=\sum_{n \geqslant 1} \frac{q^{n}-1}{n} \sum_{x \in M_{n}} \tilde{p}(x) \otimes \tilde{P}_{n}(x) \tag{4.4}
\end{equation*}
$$

Now define, for each $\xi \in L$,

$$
\tilde{p}_{n}(\xi)=\left\{\begin{array}{lll}
(-1)^{n-1} \sum_{x \in M_{n}}\langle\xi, x\rangle_{n} \tilde{p}_{n}(x) & \text { if } & \xi \in L_{n}  \tag{4.5}\\
0 & \text { if } & \xi \notin L_{n}
\end{array}\right.
$$

Since $\tilde{p}_{n}(x)=\tilde{p}_{n}(y)$ if $x, y$ are in the same $F$-orbit in $M$, it follows that $\tilde{p}_{n}(\xi)=\tilde{p}_{n}(\eta)$ if $\xi, \eta$ are in the same $F$-orbit in $L$.

Let $\Theta$ denote the set of $F$-orbits in $L$. For $\varphi \in \Theta$ we denote by $d(\varphi)$ the number of elements of $\varphi$, and for each $r \geqslant 1$ we define

$$
p_{r}(\varphi)=\tilde{p}_{r d}(\xi)
$$

where $\xi$ is any element of $\varphi$, and $d=d(\varphi)$. We regard the $p_{r}(\varphi)$ as the power-sums of a set of variables $Y_{i, \varphi}$, each of degree $d(\varphi)$. We can then define other symmetric functions of the $Y_{i, \varphi}$ by means of the formulas of Chapter I, in particular Schur functions $s_{\lambda}(\varphi)$ by the formula (7.5) of Chapter I.

For each function $\boldsymbol{\lambda}: \Theta \rightarrow \mathscr{P}$ such that

$$
\|\boldsymbol{\lambda}\|=\sum_{\varphi \in \Theta} d(\varphi)|\boldsymbol{\lambda}(\varphi)|<\infty
$$

let

$$
S_{\lambda}=\prod_{\varphi \in \Theta} s_{\lambda(\varphi)}(\varphi)
$$

which is a homogeneous element of $B$, of degree $\|\boldsymbol{\lambda}\|$.
Now let $S$ be the $\mathbf{Z}$-submodule of $B$ generated by the $S_{\lambda}$. Since the Schur functions form a $\mathbf{Z}$-basis of the ring of symmetric functions, it is clear that $S$ is closed under multiplication and that the $S_{\lambda}$ form a Z-basis of $S$. Hence $S$ is a graded subring of $B$. The equations (4.5) can be solved for the $\tilde{p}_{n}(x)$ in terms of the $\tilde{p}_{n}(\xi)$, namely

$$
\tilde{p}_{n}(x)=(-1)^{n-1}\left(q^{n}-1\right)^{-1} \sum_{\xi \in L_{n}} \overline{\langle\xi, x\rangle_{n}} \tilde{p}_{n}(\xi)
$$

for $x \in M_{n}$, by orthogonality of characters of the finite group $M_{n}$. Hence we have $S \otimes_{\mathrm{z}} \mathrm{C}=B$.

The point of setting up this machinery is that the $S_{\boldsymbol{\lambda}}$ such that $\|\boldsymbol{\lambda}\|=n$ will turn out to be the characteristics of the irreducible characters of $G_{n}=G L_{n}(k)$.

To complete this section, we shall show that the $S_{\lambda}$ form an orthonormal basis of $S$.

If $u$ is any element of $B$, we may write $u=\sum u_{\mu} \tilde{P}_{\mu}$ with coefficients $u_{\mu} \in \mathbf{C}$, and we define $\bar{u}$ to be $\sum \bar{u}_{\mu} P_{\mu}$. Now from Chapter I, (4.3) we have

$$
\begin{aligned}
\log \left(\sum_{\lambda} s_{\lambda}(x) s_{\lambda}(y)\right) & =\sum_{i, j} \log \left(1-x_{i} y_{j}\right)^{-1} \\
& =\sum_{n>1} \frac{1}{n} p_{n}(x) p_{n}(y)
\end{aligned}
$$

for two sets of variables $x_{i}, y_{j}$, and therefore

$$
\begin{aligned}
\log \left(\sum_{\lambda} S_{\lambda} \otimes \bar{S}_{\lambda}\right) & =\sum_{n>1} \frac{1}{n} \sum_{\varphi \in \Theta} p_{n}(\varphi) \otimes \overline{p_{n}(\varphi)} \\
& =\sum_{n>1} \frac{1}{n} \sum_{\xi \in L_{n}} \tilde{p}_{n}(\xi) \otimes \overline{\tilde{p}_{n}(\xi)}
\end{aligned}
$$

But from (4.5) we have

$$
\begin{aligned}
\sum_{\xi \in L_{n}} \tilde{p}_{n}(\xi) \otimes \overline{\tilde{p}_{n}(\xi)} & =\sum_{\xi \in L_{n}} \sum_{x, y \in M_{n}}\langle\xi, x\rangle_{n} \overline{\langle\xi, y\rangle_{n}} \tilde{P}_{n}(x) \otimes \tilde{p}_{n}(y) \\
& =\left(q^{n}-1\right) \sum_{x \in M_{n}} \tilde{p}_{n}(x) \otimes \tilde{p}_{n}(x)
\end{aligned}
$$

by orthogonality of characters of the finite group $M_{n}$. It now follows from (4.4) that

$$
\begin{equation*}
\sum_{\lambda} S_{\lambda} \otimes \bar{S}_{\lambda}=\sum_{\mu} \tilde{P}_{\mu} \otimes \tilde{Q}_{\mu} \tag{4.6}
\end{equation*}
$$

If $S_{\lambda}=\Sigma_{\mu} u_{\lambda \mu} \tilde{P}_{\mu}=\Sigma_{\mu} v_{\lambda \mu} \tilde{Q}_{\mu}$, it follows from (4.6) that $\Sigma_{\lambda} u_{\lambda \mu} \bar{v}_{\lambda \nu}=$ $\delta_{\mu \nu}$, and therefore also

$$
\sum_{\mu} u_{\kappa \mu} \bar{U}_{\lambda \mu}=\delta_{\kappa \lambda} .
$$

In other words, $\left\langle S_{\kappa}, S_{\lambda}\right\rangle=\delta_{\kappa \lambda}$, so that
(4.7) The $S_{\lambda}$ form an orthonormal basis of $S$. I

## Example

Let $u$ be any class function on $G_{n}$. Then the value of $u$ at elements of the class $c_{\mu}$ is

$$
u\left(c_{\mu}\right)=\left\langle\operatorname{ch}(u), \tilde{Q}_{\mu}\right\rangle
$$

For $u\left(c_{\mu}\right)=a_{\mu}\left\langle u, \pi_{\mu}\right\rangle=\left\langle\operatorname{ch}(u), \operatorname{ch}\left(a_{\mu} \pi_{\mu}\right)\right\rangle=\left\langle\operatorname{ch}(u), \tilde{Q}_{\mu}\right\rangle$ by (2.7) and (4.1).

## 5. Construction of the characters

Fix a character $\theta$ of $M$, the multiplicative group of $\bar{k}$.
(5.1) Let $G$ be a finite group and let $\rho: G \rightarrow G L_{n}(k)$ be a modular representa. tion of $G$. For each $x \in G$ let $u_{i}(x)(1 \leqslant i \leqslant n)$ be the eigenvalues of $\rho(x)$. Let $f \in \mathbf{Z}\left[t_{1}, \ldots, t_{n}\right]^{S_{n}}$ be a symmetric polynomial. Then the function

$$
\chi: x \mapsto f\left(\theta\left(u_{1}(x)\right), \ldots, \theta\left(u_{n}(x)\right)\right)
$$

is a character of G, i.e. an integral linear combination of characters of complex representations of $G$.

We defer the proof to the Appendix. We shall apply (5.1) in the case that $G=G_{n}, \rho$ is the identity map and $f$ is the $r$ th elementary symmetric function $e_{r}(0 \leqslant r \leqslant n)$. We shall also assume that $\theta: M \rightarrow \mathbf{C}^{*}$ is injective, i.e. an isomorphism of $M$ onto the group of roots of unity in $\mathbf{C}$ of order prime to $p=$ char. $k$. Then (5.1) asserts that

$$
\chi_{r}: g \mapsto e_{r}\left(\theta\left(x_{1}\right), \ldots, \theta\left(x_{n}\right)\right),
$$

where $x_{i} \in \bar{k}$ are the eigenvalues of $g \in G_{n}$, is a (complex) character of $G_{n}$.
Now the characteristic polynomial of $g$ is ( $\S 2$, Example 2)

$$
\prod_{f \in \Phi} f^{|\mu(f)|}=\prod_{i=1}^{n}\left(t-x_{i}\right)
$$

where $\mu: \Phi \rightarrow \mathscr{P}$ is the partition-valued function determined by $g$.
For each $f \in \Phi$, say $f=\Pi\left(t-y_{i}\right)$, we shall write

$$
\tilde{f}=\Pi\left(1+y_{i} t\right)
$$

and

$$
\theta(\tilde{f})=\Pi\left(1+\theta\left(y_{i}\right) t\right)
$$

Then since

$$
\sum_{r=0}^{n} \chi_{r}(g) t^{r}=\prod_{i=1}^{n}\left(1+\theta\left(x_{i}\right) t\right)
$$

we have

$$
\begin{equation*}
\sum_{r=0}^{n} \chi_{r}(g) t^{r}=\prod_{f \in \Phi} \theta(\tilde{f})^{|\mu(f)|} \tag{5.2}
\end{equation*}
$$

We need to calculate the characteristic of $\chi_{r}$. Since

$$
\chi_{r}=\sum_{\mu} \chi_{r}\left(c_{\mu}\right) \pi_{\mu}
$$

where $\chi_{r}\left(c_{\mu}\right)$ is the value of $\chi_{r}$ at any element of the class $c_{\mu}$, it follows from (5.2) that

$$
\begin{equation*}
\sum_{r=0}^{n} \operatorname{ch}\left(\chi_{r}\right) t^{r}=\sum_{\mu} \prod_{f \in \Phi} \theta(\tilde{f})^{|\mu(f)|} \tilde{P}_{\mu} \tag{5.3}
\end{equation*}
$$

summed over all $\mu: \Phi \rightarrow \mathscr{P}$ such that $\|\mu\|=n$.
Now from Chapter III, §3, Example 1 we have

$$
\sum_{|\lambda|=m} t^{n(\lambda)} P_{\lambda}(x ; t)=h_{m}(x)
$$

and therefore

$$
\begin{equation*}
\sum_{|\lambda|=m} \tilde{P}_{\lambda}(f)=h_{m}(f) \tag{5.4}
\end{equation*}
$$

for each $f \in \Phi$. It follows that the sum on the right-hand side of (5.3) is equal to

$$
\sum_{\alpha} \prod_{f \in \Phi} \theta(\tilde{f})^{\alpha(f)} h_{\alpha(f)}(f)
$$

summed over all $\boldsymbol{\alpha}: \Phi \rightarrow \mathbf{N}$ such that $\Sigma_{f} d(f) \boldsymbol{\alpha}(f)=n$, and hence is equal to the coefficient of $u^{n}$ in

$$
H(t, u)=\prod_{f \in \Phi} \prod_{i \geqslant 1}\left(1-\theta(\tilde{f}) X_{i, f} u^{d(f)}\right)^{-1}
$$

Hence
(5.5) $\operatorname{ch}\left(\chi_{r}\right)$ is equal to the coefficient of $t^{r} u^{n}$ in $H(t, u)$.

To get $H(t, u)$ into a usable form, we shall calculate its logarithm:

$$
\begin{aligned}
\log H(t, u) & =\sum_{f \in \Phi} \sum_{i \geqslant 1} \log \left(1-\theta(\tilde{f}) X_{i, f} u^{d(f)}\right)^{-1} \\
& =\sum_{m \geqslant 1} \frac{1}{m} \sum_{f \in \Phi} \theta(\tilde{f})^{m} p_{m}(f) u^{m d(f)} .
\end{aligned}
$$

Now if $x$ is any root of $f$, we have

$$
\theta(\tilde{f})=\prod_{i=0}^{d-1}\left(1+t \theta\left(F^{i} x\right)\right)
$$

where $d=d(f)$, and therefore (since $F^{d} x=x$ )

$$
\theta(\tilde{f})^{m}=\prod_{i=0}^{m d-1}\left(1+t \theta\left(F^{i} x\right)\right)
$$

Consequently,

$$
\log H(t, u)=\sum_{m>1} \frac{u^{m}}{m} \sum_{x \in M_{m}} \tilde{p}_{m}(x) \prod_{i=0}^{m-1}\left(1+t \theta\left(F^{i} x\right)\right)
$$

Now $F^{i}(0 \leqslant i \leqslant m-1)$ acting on $k_{m}$ are the elements of the Galois group $\mathrm{g}_{m}=\operatorname{Gal}\left(k_{m} / k\right)$. Hence the inner sum above may be rewritten as

$$
\begin{aligned}
\sum_{x \in M_{m}} \tilde{p}_{m}(x) \prod_{\gamma \in \mathfrak{g}_{m}}(1+t \theta(\gamma x)) & =\sum_{I \in \mathfrak{g}_{m}} t^{|I|} \sum_{x \in M_{m}} \tilde{p}_{m}(x) \prod_{\gamma \in I} \theta(\gamma x) \\
& =(-1)^{m-1} \sum_{I \subset \mathfrak{g}_{m}} t^{\mid I I} \tilde{p}_{m}\left(\theta_{m, I}\right)
\end{aligned}
$$

by (4.5), where $\theta_{m, I}$ is the character $x \mapsto \Pi_{\gamma \in I} \theta(\gamma x)$ of $M_{m}$, identified with its image in $L_{m}$. So we have

$$
\begin{equation*}
\log H(t, u)=\sum_{m>1} \frac{(-1)^{m-1} u^{m}}{m} \sum_{I \subset \mathfrak{g}_{m}} t^{|l|} \tilde{p}_{m}\left(\theta_{m, I}\right) \tag{5.6}
\end{equation*}
$$

The group $\mathrm{g}_{m}$ acts by multiplication on the set of all subsets $I$ of $\mathrm{g}_{m}$. If the stabilizer of $I$ is trivial, we shall say that $I$ is primitive and that the pair $(m, I)$ is an index. In that case all the translates $\gamma I\left(\gamma \in \mathrm{~g}_{m}\right)$ are distinct, and it follows that the $F$-orbit of $\theta_{m, I}$ consists of $m$ elements. If $I$ is not primitive, the stabilizer of $I$ in $g_{m}$ is a non-trivial subgroup $\mathfrak{h}$ of $\mathfrak{g}_{m}$, generated by say $F^{s}$, where $s$ divides $m$. Since $I$ is stable under multiplication by elements of $\mathfrak{h}$, it is a union of cosets of $\mathfrak{h}$ in $\mathrm{g}_{m}$, say $I=\mathfrak{h} J$ where $J=I / \mathfrak{h}$ may be regarded as a subset of $\mathrm{g}_{m} / \mathfrak{h}=\mathrm{g}_{s}=\operatorname{Gal}\left(k_{s} / k\right)$. Moreover, by construction $J$ is a primitive subset of $g_{s}$, i.e. $(s, J)$ is an index, and it is clear that $\theta_{m, I}=\theta_{s, J} \circ N_{m, s}$, where $N_{m, s}: M_{m} \rightarrow M_{s}$ is the norm map ( $\S 1$ ), so that $\theta_{m, I}$ and $\theta_{s, J}$ define the same element of $L$. Since $(s, J)$ is an index, the $F$-orbit $\varphi_{s, J}$ of $\theta_{s, J}$ in $L$ has $s$ elements, and therefore $\tilde{p}_{m}\left(\theta_{m, I}\right)=p_{m / s}\left(\varphi_{s, J}\right)$.

Hence the formula (5.6) now becomes

$$
\log H(t, u)=\sum_{(s, J)} \sum_{n=1}^{\infty} \frac{(-1)^{n-1}}{n} p_{n}\left(\varphi_{s, J}\right)\left(t^{|J|} u^{s}\right)^{n}
$$

the sum being over all indices $(s, J)$, where two indices $(s, J)$ and $\left(s, J^{\prime}\right)$ are
to be regarded as the same if $J^{\prime}$ is a translate of $J$, i.e. if $\varphi_{s, J}=\varphi_{s, J^{\prime}}$. Now the inner sum above is by Chapter I , (2.10') equal to

$$
\log \sum_{m>0} e_{m}\left(\varphi_{s, J}\right)\left(t^{|J|} u^{s}\right)^{m}
$$

and therefore we have proved
(5.7) For each pair of integers $r, n$ such that $0 \leqslant r \leqslant n$, the coefficient of $t^{r} u^{n}$ in

$$
H(t, u)=\prod_{(s, J)}\left(\sum_{m>0} e_{m}\left(\varphi_{s, J}\right)\left(t^{|J|} u^{s}\right)^{m}\right)
$$

is the characteristic of a character of $G_{n}$. ।
We shall use (5.7) to prove
(5.8) Let $\varphi$ be an $F$-orbit in $L$, let $d=d(\varphi)$ and let $n \geqslant 0$. Then $e_{n}(\varphi)$ is the characteristic of a character of $G_{n d}$.

Proof. By induction on the pair ( $n, d$ ) ordered lexicographically: $(n, d)<$ ( $n^{\prime}, d^{\prime}$ ) if either $n<n^{\prime}$, or $n=n^{\prime}$ and $d<d^{\prime}$. The result is true when $n=d=1$, because then $\varphi=\{\xi\}$ where $\xi \in L_{1}$ is a character of $G_{1}=M_{1}$, and

$$
e_{1}(\xi)=p_{1}(\xi)=\sum_{x \in G_{1}} \xi(x) p_{1}(x)=\operatorname{ch}(\xi)
$$

(since $\operatorname{ch}\left(\pi_{x}\right)=p_{1}(x)$ for $x \in G_{1}, \pi_{x}$ being the characteristic function of $(x)$ ).
Let $\chi_{n, d}$ denote the coefficient of $t^{n} u^{n d}$ in $H(t, u)$. By (5.7) $\chi_{n, d}$ is the tharacteristic of a character of $G_{n d}$, and we have

$$
\chi_{n, d}=\sum_{v} \prod_{(s, J)} e_{v(s, J)}\left(\varphi_{s, J}\right)
$$

iummed over all N -valued functions $v$ on the set of indices such that

$$
\sum_{(s, J)}|J| v(s, J)=n, \quad \sum_{(s, J)} s v(s, J)=n d .
$$

Jach index $(s, J)$ that actually occurs has $v(s, J) \leqslant n$, and $s \leqslant d$ if $(s, J)=n$, so that $(v(s, J), s) \leqslant(n, d)$, with equality if and only if $v(s, J)$ $=n$ (so that $|J|=1$ ) and $s=d$. Hence $\chi_{n, d}$ has 'leading term' $e_{n}\left(\varphi_{d,(1)}\right)$, vhere 1 is the identity element of $g_{d}$, and $\varphi_{d,(1)}$ is the $F$-orbit of $\theta \mid M_{d}$. Now we can choose $\theta$ so that the $F$-orbit of $\theta \mid M_{d}$ is $\varphi$, and then we have

$$
\chi_{n, d}=e_{n}(\varphi)+\ldots
$$

where the terms not written are products of two or more $e$ 's, which by the inductive hypothesis are characteristics of characters of groups $G_{n^{\prime} d^{\prime}}$, where $\left(n^{\prime}, d^{\prime}\right)<(n, d)$. Hence $e_{n}(\varphi)$ is the characteristic of a character of $G_{n d}$.

## 6. The irreducible characters

We can now very quickly obtain all the irreducible characters of the groups $G_{n}=G L_{n}(k)$. Since each Schur function $s_{\lambda}$ is a polynomial in the $e$ 's with integer coefficients, it follows from (5.8) that each $s_{\lambda}(\varphi)$ and hence each $S_{\lambda}$ is the characteristic of a character $\chi^{\lambda}$ of $G_{n}$ (where $n=\|\lambda\|$ ).

By (4.1) and (4.7) we have $\left\langle\chi^{\kappa}, \chi^{\lambda}\right\rangle=\delta_{\kappa \lambda}$, and therefore each $\chi^{\lambda}$ such that $\|\lambda\|=n$ is, up to sign, an irreducible character of $G_{n}$. Moreover, the rank of the free $\mathbf{Z}$-module $R_{n}$ generated by the irreducible characters of $G_{n}$ is equal to the number of conjugacy classes in $G_{n}$, i.e. the number of functions $\mu: \Phi \rightarrow \mathscr{P}$ such that $\|\mu\|=n$. Since the groups $L, M$ are isomorphic, this is also the number of functions $\lambda: \Theta \rightarrow \mathscr{P}$ such that $\|\lambda\|=n$, and consequently the $\chi^{\lambda}$ form an orthonormal basis of $R_{n}$. Hence the characters $\pm \chi^{\lambda}$ exhaust all the irreducible characters of $G_{n}$.

It remains to settle the question of sign, which we shall do by computing the degree $d_{\lambda}=\chi^{\lambda}\left(1_{n}\right)$ of $\chi^{\lambda}$.

Let $\chi_{\mu}^{\lambda}$ denote the value of $\chi^{\lambda}$ at elements of the class $c_{\mu}$. Then

$$
\chi^{\lambda}=\sum_{\mu} \chi_{\mu}^{\lambda} \pi_{\mu}
$$

summed over all $\boldsymbol{\mu}: \Phi \rightarrow \mathscr{P}$ such that $\|\boldsymbol{\mu}\|=\|\boldsymbol{\lambda}\|$, and therefore

$$
\begin{equation*}
S_{\lambda}=\sum_{\mu} \chi_{\mu}^{\lambda} \tilde{P}_{\mu} \tag{6.1}
\end{equation*}
$$

which shows that $\chi_{\mu}^{\lambda}=\left\langle S_{\lambda}, \tilde{Q_{\mu}}\right\rangle$, and hence by (4.7) that

$$
\begin{equation*}
\tilde{Q}_{\mu}=\sum_{\lambda} \chi_{\mu}^{\lambda} \bar{S}_{\lambda} . \tag{6.2}
\end{equation*}
$$

Now suppose that $c_{\mu}$ is the class of the identity element $1_{n} \in G_{n}$, and let $f_{1}$ denote the polynomial $t-1$. Then $\boldsymbol{\mu}\left(f_{1}\right)=\left(1^{n}\right)$ and $\boldsymbol{\mu}(f)=0$ for $f \neq f_{1}$. Hence

$$
\begin{aligned}
\tilde{Q}_{\mu}=\tilde{Q}_{\left(1^{n}\right)}\left(f_{1}\right) & =q^{n(n+1) / 2} \varphi_{n}\left(q^{-1}\right) P_{\left(1^{n}\right)}\left(X_{f_{1}} ; q^{-1}\right) \\
& =\psi_{n}(q) e_{n}\left(f_{1}\right)
\end{aligned}
$$

by Chapter III, (2.8), where

$$
\psi_{n}(q)=\prod_{i=1}^{n}\left(q^{i}-1\right)
$$

Hence from (6.2) we have

$$
\begin{equation*}
\psi_{n}(q) e_{n}\left(f_{1}\right)=\sum_{\|\lambda\|=n} d_{\lambda} \bar{S}_{\lambda} \tag{6.3}
\end{equation*}
$$

Now let $\delta: B \rightarrow \mathbf{C}$ be the $\mathbf{C}$-algebra homomorphism defined by

$$
\delta\left(\tilde{p}_{n}(x)\right)= \begin{cases}0 & \text { if } x \neq 1  \tag{6.4}\\ (-1)^{n-1} /\left(q^{n}-1\right) & \text { if } x=1\end{cases}
$$

From (4.6) and (4.4) it follows that

$$
\begin{aligned}
\log \left(\sum_{\lambda} \delta\left(S_{\lambda}\right) \bar{S}_{\lambda}\right) & =\log \left(\sum_{\mu} \delta\left(\tilde{P}_{\mu}\right) \tilde{Q}_{\mu}\right) \\
& =\sum_{n>1} \frac{(-1)^{n-1}}{n} \tilde{p}_{n}(1) \\
& =\log \prod_{i}\left(1+X_{i, f_{1}}\right)
\end{aligned}
$$

and therefore

$$
\sum_{n>0} e_{n}\left(f_{1}\right)=\sum_{\lambda} \delta\left(S_{\lambda}\right) \bar{S}_{\lambda},
$$

so that

$$
e_{n}\left(f_{1}\right)=\sum_{\|\lambda\|=n} \delta\left(S_{\lambda}\right) \bar{S}_{\lambda}
$$

By comparing this formula with (6.3), we see that

$$
\begin{equation*}
d_{\lambda}=\psi_{n}(q) \delta\left(S_{\lambda}\right) \tag{6.5}
\end{equation*}
$$

To calculate the number $\delta\left(S_{\lambda}\right)$, observe that from (6.4) and the definition (4.5) of $\tilde{p}_{n}(\xi)$ we have

$$
\delta\left(\tilde{p}_{n}(\xi)\right)=\left(q^{n}-1\right)^{-1}
$$

for $\xi \in L_{n}$, and hence for all $\varphi \in \Theta$

$$
\delta\left(p_{n}(\varphi)\right)=\left(q_{\varphi}^{n}-1\right)^{-1}=\sum_{i>1} q_{\varphi}^{-i n}
$$

where $q_{\varphi}=q^{d(\varphi)}$. In other words, $\delta\left(p_{n}(\varphi)\right)$ is the $n$th power sum of the numbers $q_{\varphi}^{-i}(i \geqslant 1)$, and hence from Chapter I, §3, Example 2 we have

$$
\begin{aligned}
\delta\left(s_{\lambda}(\varphi)\right) & =s_{\lambda}\left(q_{\varphi}^{-1}, q_{\varphi}^{-2}, \ldots\right) \\
& =q_{\varphi}^{-|\lambda|-n(\lambda)} \prod_{x \in \lambda}\left(1-q_{\varphi}^{-h(x)}\right)^{-1} .
\end{aligned}
$$

where $h(x)$ is the hook-length at $x \in \lambda$. Since

$$
\sum_{x \in \lambda} h(x)=|\lambda|+n(\lambda)+n\left(\lambda^{\prime}\right)
$$

(Chapter I, §1, Example 2) it follows that

$$
\begin{equation*}
\delta\left(s_{\lambda}(\varphi)\right)=q_{\varphi}^{n\left(\lambda^{\prime}\right)} \tilde{H}_{\lambda}\left(q_{\varphi}\right)^{-1} \tag{6.6}
\end{equation*}
$$

where

$$
\tilde{H}_{\lambda}\left(q_{\varphi}\right)=\prod_{x \in \lambda}\left(q_{\varphi}^{h(x)}-1\right)
$$

From (6.5) and (6.6) we obtain

$$
\begin{equation*}
d_{\lambda}=\psi_{n}(q) \prod_{\varphi \in \Theta} q_{\varphi}^{n\left(\lambda(\varphi)^{\prime}\right)} \tilde{H}_{\lambda(\varphi)}\left(q_{\varphi}\right)^{-1} \tag{6.7}
\end{equation*}
$$

which is clearly positive. Hence $\chi^{\lambda}$ (and not $-\chi^{\lambda}$ ) is an irreducible character of $G_{n}$. To summarize:
(6.8) The functions $\chi^{\lambda}$ defined by $\operatorname{ch}\left(\chi^{\lambda}\right)=S_{\lambda}$, where $\lambda: \Theta \rightarrow \mathscr{P}$ and $\|\lambda\|=n$, are the irreducible characters of the group $G_{n}=G L_{n}(k)$. The degree $d_{\lambda}$ of $\chi^{\lambda}$ is given by (6.7), and the character table of $G_{n}$ is the transition matrix between the bases $\left(S_{\lambda}\right)$ and $\left(\tilde{P}_{\mu}\right)$.

## Examples

1. Let $\nu=\left(\nu, \ldots, \nu_{r}\right)$ be a partition of $n$, and let $\theta_{\nu}$ be a character of the 'maximal torus' $T_{\nu}$ ( $\$ 2$, Example 4). If we identify $T_{\nu}$ with $M_{\nu} \times \ldots \times M_{\nu}, \theta_{\nu}$ may be identified with $\left(\xi_{1}, \ldots, \xi_{r}\right)$, where $\xi_{i} \in L_{\nu_{i}}(1 \leqslant i \leqslant r)$. Then $\prod_{i=1}^{r} \tilde{p}_{\nu_{i}}\left(\xi_{i}\right)$ is the characteristic of an (in general reducible) character $B\left(\theta_{\nu}\right)$ of $G_{n}$, which depends only on the $F$-orbits $\varphi_{i}$ of $\xi_{i}$, i.e. $B\left(\theta_{\nu}\right)$ depends only on the $W_{\nu}$-orbit of $\theta_{\nu}$ in the character group $\hat{T}_{\nu}$. The distinct characters $B(\theta)$, where $\theta \in U_{\nu}\left(W_{\nu} \backslash \hat{T}_{\nu}\right)$, are pairwise orthogonal in $A_{n}$; and since by $\S 2$, Example 5 there are exactly as many of them as there are conjugacy classes in $G_{n}$, they form an orthogonal basis of the space $A_{n}$ of class functions on $G_{n}$. Green [G11] calls the $B(\theta)$ the basic characters. $B\left(\theta_{\nu}\right)$ is irreducible if and only if $d\left(\varphi_{i}\right)=\nu_{i}(1 \leqslant i \leqslant r)$, that is to say if and only if $\theta_{\nu}$ is a regular character of $T_{\nu}$ (i.e. its stabilizer in $W_{\nu}$ is trivial).

The value of $B\left(\theta_{\nu}\right)$ at a unipotent element of type $\lambda$ is ( $\S 4$, Example 1) equal to $\left\langle\Pi \tilde{p}_{v_{i}}\left(\xi_{i}\right), \tilde{Q}_{\lambda}\left(f_{1}\right)\right\rangle$, where $f_{1}=t-1$. By (4.5) this is equal to

$$
(-1)^{\Sigma\left(\nu_{i}-1\right)}\left\langle p_{\nu}\left(f_{1}\right), \tilde{Q}_{\lambda}\left(f_{1}\right)\right\rangle=(-1)^{n-l(\nu)} Q_{\nu}^{\lambda}(q)
$$

where $Q_{\nu}^{\lambda}(q)$ is the Green polynomial (Chapter III, §7).
Also $B\left(\theta_{\nu}\right)$ vanishes at regular semisimple classes which do not intersect the torus $T_{\nu}$.
2. As in $\S 2$, Example 2 it is sometimes more convenient to regard $\lambda: \Theta \rightarrow \mathscr{P}$ as a function on $L$, i.e. we define $\lambda(\xi)$ for $\xi \in L$ to be the partition $\lambda(\varphi)$, where $\varphi$ is the $F$-orbit of $\xi$. With this notation let

$$
\Delta(\lambda)=\prod_{\xi \in L} \xi^{|\lambda(\xi)|} \in L_{1} .
$$

Let $a \in k^{*}=M_{1}$. Then

$$
\begin{equation*}
\chi^{\lambda}\left(a .1_{n}\right)=\langle\Delta(\lambda), a\rangle_{1} \chi^{\lambda}\left(1_{n}\right) . \tag{*}
\end{equation*}
$$

This can be shown by the method used in the text to compute $\chi^{\lambda}\left(1_{n}\right)$, using the homomorphism $\delta_{a}: B \rightarrow \mathrm{C}$ defined by $\delta_{a}\left(\tilde{p}_{n}(x)\right)=(-1)^{n-1} /\left(q^{n}-1\right)$ if $x=a$, and $\delta_{a}\left(\tilde{p}_{n}(x)\right)=0$ if $x \neq a$. Then $\chi^{\lambda}\left(a .1_{n}\right)=\psi_{n}(q) \delta_{a}\left(S_{\lambda}\right)$, and $\delta_{a}$ has the effect of replacing the $\varphi$-variables $Y_{i, \varphi}$ by $\langle\xi, a\rangle_{d} \cdot q_{\varphi}^{-i}$, where $\xi \in \varphi$ and $d=d(\varphi)$. The formula (*) now follows easily.
3. Let $U_{n}$ be the set of unipotent elements in $G_{n}$. Then for every irreducible character $\chi^{\lambda}$ of $G_{n}$ we have

$$
\sum_{u \in U_{n}} \chi^{\lambda}(u)=(-1)^{a(\lambda)} q^{N(\lambda)} \chi^{\lambda}\left(1_{n}\right)
$$

where

$$
a(\lambda)=n-\Sigma_{\varphi}|\lambda(\varphi)| \text { and } N(\lambda)=\frac{1}{2} n(n-1)+\Sigma_{\varphi} d(\varphi)\left(n(\lambda(\varphi))-n\left(\lambda(\varphi)^{\prime}\right)\right) \text {. }
$$

Let $e_{\lambda}=\Sigma_{u \in U_{n}} \chi^{\lambda}(u)$. Then we have

$$
e_{\lambda}=\left|G_{n}\right| \sum_{|\rho|=n} a_{p}(q)^{-1}\left\langle S_{\lambda}, \tilde{Q}_{\rho}\left(f_{1}\right)\right\rangle
$$

where $f_{1}=t-1$, and hence from (5.4)

$$
e_{\lambda}=\left|G_{n}\right|\left\langle S_{\lambda}, h_{n}\left(f_{1}\right)\right\rangle
$$

so that

$$
q^{n(n-1) / 2} \psi_{n}(q) h_{n}\left(f_{1}\right)=\sum_{\|\lambda\|=n} e_{\lambda} \bar{S}_{\lambda} .
$$

Let $\varepsilon: B \rightarrow \mathbf{C}$ be the $\mathbf{C}$-algebra homomorphism defined by $\varepsilon\left(\tilde{p}_{n}(1)\right)=\left(q^{n}-1\right)^{-1}$, $\varepsilon\left(\tilde{p}_{n}(x)\right)=0$ if $x \neq 1$. Then as in the text we find that

$$
h_{n}\left(f_{1}\right)=\sum_{\|\lambda\|=n} \varepsilon\left(S_{\lambda}\right) \bar{S}_{\lambda}
$$

so that $e_{\lambda}=q^{n(n-1) / 2} \psi_{n}(q) \varepsilon\left(S_{\lambda}\right)$, and $\varepsilon\left(S_{\lambda}\right)$ can be computed in the same way as $\delta\left(S_{\lambda}\right)$ in the text.
4. Let $\psi$ be a non-trivial additive character of $k$, and $\chi^{\lambda}$ an irreducible character of $G_{n}$. We shall compute

$$
w_{\lambda}=\chi^{\lambda}\left(1_{n}\right)^{-1} \sum_{g \in G_{n}} \psi(\text { trace } g) \chi^{\lambda}(g)
$$

(see [K14], [M2]). For this purpose we introduce the following notation: if $x \in k_{n}$ let $\psi_{n}(x)=\psi\left(\operatorname{trace}_{k_{n} / k}(x)\right)$, and for $\xi \in L_{n}$ let

$$
\tau_{n}(\xi)=(-1)^{n-1} \sum_{x \in M_{n}}\langle\xi, x\rangle_{n} \psi_{n}(x)
$$

If $f \in \Phi$, let $\psi(f)$ denote $\psi_{d}(x)$, where $d=d(f)$ and $x$ is a root of $f$. If $\varphi \in \Theta$, let $\tau(\varphi)=\tau_{d}(\xi)$, where $d=d(\varphi)$ and $\xi \in \varphi$.

If $g \in c_{\mu}$, we have trace $(g)=\Sigma_{x \in M}|\mu(x)| x$ ( $\S 2$, Example 2) and therefore

$$
\psi(\text { trace } g)=\prod_{f \in \Phi} \psi(f)^{|\mu(f)|}=\psi_{\mu}, \quad \text { say. }
$$

We have

$$
\chi^{\lambda}\left(1_{n}\right) w_{\lambda}=\left|G_{n}\right| \sum_{\|\mu\|-n} a_{\mu}^{-1} \chi_{\mu}^{\lambda} \psi_{\mu}
$$

and since $\chi_{\mu}^{\lambda}=\left\langle S_{\lambda}, \tilde{Q}_{\mu}\right\rangle$ it follows that

$$
\begin{equation*}
\sum_{\mu} \psi_{\mu} \tilde{P}_{\mu}=\left|G_{n}\right|^{-1} \sum_{\lambda} \chi^{\lambda}\left(1_{n}\right) w_{\lambda} \bar{S}_{\lambda} \tag{1}
\end{equation*}
$$

Now define a C-algebra homomorphism $\varepsilon: B \rightarrow \mathbf{C}$ by $\varepsilon\left(X_{i, f}\right)=\psi(f) q_{f}^{-i}$, for all $f \in \Phi$ and $i \geqslant 1$. Then from Chapter III, $\S 2$, Example 1 it follows that $\varepsilon\left(\tilde{Q}_{\mu}\right)=\psi_{\mu}$, and hence from (1) and (4.6) we obtain

$$
\begin{equation*}
\varepsilon\left(S_{\lambda}\right)=\left|G_{n}\right|^{-1} \chi^{\lambda}\left(1_{n}\right) w_{\lambda} \tag{2}
\end{equation*}
$$

For each $x \in M_{n}$, we have $\varepsilon\left(\tilde{p}_{n}(x)\right)=\psi_{n}(x) /\left(q^{n}-1\right)$, and therefore

$$
\begin{aligned}
\varepsilon\left(\tilde{p}_{n}(\xi)\right) & =\frac{(-1)^{n-1}}{q^{n}-1} \sum_{x \in M_{n}}\langle\xi, x\rangle_{n} \psi_{n}(x) \\
& =\tau_{n}(\xi) /\left(q^{n}-1\right)
\end{aligned}
$$

for $\xi \in L_{n}$. Now the Hasse-Davenport identity (see e.g. [W1]) states that $\tau_{n d}(\xi)=$ $\tau_{n}(\xi)^{d}$ for all $d \geqslant 1$, and hence we have $\varepsilon\left(p_{n}(\varphi)\right)=\tau(\varphi)^{n} /\left(q_{\varphi}^{n}-1\right)$, where $q_{\varphi}=$ $q^{d(\varphi)}$, so that the effect of the homomorphism $\varepsilon$ is to replace the $\varphi$-variables $Y_{i, \varphi}$ by $\tau(\varphi) q_{\varphi}^{-i}$. Consequently

$$
\varepsilon\left(S_{\lambda}\right)=\prod_{\varphi \in \Theta} \tau(\varphi)^{|\lambda(\varphi)|} \cdot \delta\left(S_{\lambda}\right)
$$

where $\delta$ is the homomorphism defined in (6.4). From (2), (3), and (6.5) we obtain

$$
w_{\lambda}=q^{n(n-1) / 2} \prod_{\varphi \in \Theta} \tau(\varphi)^{|\lambda(\varphi)|} .
$$

5. In this example we shall compute the sum of the degrees of the irreducible representations of $G_{n}$. Since (6.5) $d_{\lambda}=\psi_{n}(q) \delta\left(S_{\lambda}\right)$, we need to compute $\Sigma_{\|\lambda\|=n} \delta\left(S_{\lambda}\right)$. For this purpose we shall compute the sum of the series

$$
S=\sum_{\lambda} \delta\left(S_{\lambda}\right) t^{\|\lambda\|}
$$

where $t$ is an indeterminate, and then pick out the coefficient of $t^{n}$.
We have

$$
S=\prod_{\varphi} \sum_{\lambda} \delta\left(s_{\lambda}(\varphi)\right) t^{|\lambda| \lambda(\varphi)},
$$

and since the homomorphism $\delta$ replaces the variables $Y_{i, \varphi}$ by $q_{\varphi}^{-1}(i \geqslant 1)$, it follows from Chapter I, §5, Example 4 that

$$
\sum_{\lambda} \delta\left(s_{\lambda}(\varphi)\right) t^{|\lambda| d(\varphi)}=\prod_{i}\left(1-\left(t q^{-i}\right)^{d(\varphi)}\right)^{-1} \prod_{i<j}\left(1-\left(t^{2} q^{-i-j}\right)^{d(\varphi)}\right)^{-1}
$$

and hence that
(1) $\log S=\sum_{\varphi}\left(\sum_{i} \log \left(1-\left(t q^{-i}\right)^{d(\varphi)}\right)^{-1}+\sum_{i<j} \log \left(1-\left(t^{2} q^{-i-j}\right)^{d(\varphi)}\right)^{-1}\right)$.

Let $d_{m}$ denote the number of $F$-orbits $\varphi$ with cardinality $d(\varphi)=m$, for each $m \geqslant 1$; then we have

$$
\begin{equation*}
q^{m}-1=\sum_{r \mid m} r d_{r} \tag{2}
\end{equation*}
$$

from considering the action of $F$ on the group $L_{m}$. We can then rewrite (1) as

$$
\begin{aligned}
\log S & =\sum_{m>1} d_{m}\left(\sum_{i>1} \sum_{r>1} \frac{\left(t q^{-i}\right)^{m r}}{r}+\sum_{i<j} \sum_{r>1} \frac{\left(t^{2} q^{-i-j}\right)^{m r}}{r}\right) \\
& =\sum_{m>1} \sum_{r \geqslant 1} \frac{d_{m}}{r} \frac{t^{m r}}{q^{m r}-1}\left(1+\sum_{i>1} t^{m r} q^{-2 i m r}\right)
\end{aligned}
$$

which by use of (2) is equal to

$$
\sum_{N>1}\left(\frac{t^{N}}{N}+\sum_{i>1} \frac{t^{2 N} q^{-2 i N}}{N}\right)
$$

It follows that

$$
\begin{aligned}
S & =\frac{1}{1-t} \prod_{i>1} \frac{1}{1-t^{2} q^{-2 i}}=(1+t) \prod_{i>0} \frac{1}{1-t^{2} q^{-2 i}} \\
& =(1+t) \sum_{m>0} t^{2 m} / \varphi_{m}\left(q^{-2}\right)
\end{aligned}
$$

(Chapter I, §2, Example 4). On picking out the coefficient of $t^{\boldsymbol{n}}$, and multiplying by $\psi_{n}(q)$, we obtain

$$
\sum_{\|\lambda\|=n} d_{\lambda}=(q-1) q^{2}\left(q^{3}-1\right) q^{4}\left(q^{5}-1\right) \ldots
$$

( $n$ factors altogether). This number is also equal to the number of symmetric matrices in $G_{n}$, or equivalently to the number of non-degenerate symmetric bilinear forms on $k^{n}$.
6. A calculation analogous to that of Example 5 shows that

$$
\sum d_{\mu}=(q-1) q^{2}\left(q^{3}-1\right) q^{4} \ldots\left(q^{2 n}-1\right)
$$

where the sum on the left is over $\boldsymbol{\mu}$ such that $\|\boldsymbol{\mu}\|=2 n$ and the partition $\boldsymbol{\mu}(\varphi)^{\prime}$ is even for each $\varphi$. This number is equal to the number of non-degenerate skew-symmetric bilinear forms on $k^{2 n}$. In fact we have

$$
\sum \chi^{\mu}=\operatorname{ind}_{C_{n}}^{G_{2 n}(1)}
$$

summed over $\mu$ as above, where $C_{n}=S p_{2 n}(k)$ is the symplectic subgroup of $G_{2 n}=G L_{2 n}(k)$.
7. Let $N_{n}$ denote the subgroup of upper unitriangular matrices in $G_{n}$. For each sequence $b=\left(b_{1}, \ldots, b_{r}\right)$ of positive integers with sum $n$, define a character $\psi_{b}$ of $N_{n}$ by the formula

$$
\psi_{b}\left(\left(h_{i j}\right)\right)=\psi\left(\sum h_{i, i+1}\right)
$$

where $\psi$ is a fixed non-degenerate additive character of $k$, and the sum is over the indices $i$ other than $b_{1}, b_{1}+b_{2}, \ldots, b_{1}+\ldots+b_{r-1}$. Then the multiplicity of each irreducible character $\chi^{\lambda}$ in the induced character ind ${ }_{N_{n}}^{G_{n}}\left(\psi_{b}\right)$ is equal to

$$
\sum_{a} \prod_{\varphi \in \boldsymbol{\theta}} K_{\lambda(\varphi), a(\varphi)^{+}}
$$

where the sum is over all functions $a: \Theta \rightarrow\left(\mathrm{Z}^{+}\right)^{r}$ such that $\Sigma_{\varphi} d(\varphi) a(\varphi)=b$, and $a(\varphi)^{+}$denotes the partition obtained by rearranging the sequence $a(\varphi)$. (For a proof, see [Z2].) In particular, ind ${ }_{N_{n}}^{G_{n}}\left(\psi_{(n)}\right)=\Sigma \chi^{\nu}$, summed over $v$ such that for each $\varphi$ the partition $\nu(\varphi)$ has length $\leqslant 1$ (this result is due to Gelfand and Graev).

## Notes and references

The result of Example 4 is due to T. Kondo [K14], and the results of Example 5 to A. A. Kljachko [K11] (also to R. Gow [G10] in the case of

Example 5(a) with $q$ odd). Example 7 was contributed by A. Zelevinsky.

## Appendix: proof of (5.1)

Since $f$ is a polynomial in the elementary symmetric functions $e_{r}$, it is enough to prove the proposition for $f=e_{r}(1 \leqslant r \leqslant n)$. Replacing $\rho$ by its exterior powers, it follows that we may assume that $f=e_{1}=t_{1}+\ldots+t_{n}$.
(1) Suppose first that $g=|G|$ is prime to $p=\operatorname{char}(k)$. Then $q$ mod. $g$ is a unit in $\mathbf{Z} /(g)$, hence $g$ divides $q^{r}-1$ where $r=\varphi(g)$ (Euler's function). Since $u_{i}(x)^{g}=1$ for all $x \in G$ and $1 \leqslant i \leqslant n$, it follows that all the eigenvalues $u_{i}(x)$ lie in $M_{r}$, and hence only the restriction of $\theta$ to $M_{r}$ comes into play. Since $M_{r}$ is a cyclic group it is enough to prove the proposition for a prescribed generator $\theta_{0}$ of $\hat{M}_{r}$, for then we have $\theta \mid M_{r}=\theta_{0}^{s}$ say, and we can apply the proposition (supposed proved for $\theta_{0}$ ) to the symmetric function $f\left(t_{1}^{s}, \ldots, t_{n}^{s}\right)$.
Let o be the ring of integers of the cyclotomic field generated by the ( $q^{r}-1$ )th roots of unity in $\mathbf{C}$, and let $\mathfrak{p}$ be a prime ideal of $\mathfrak{p}$ which contains $p$. Then $\mathfrak{D} / \mathfrak{p} \cong k_{r}$, and $\rho$ is the reduction $\bmod \mathfrak{p}$ of a representation $\sigma$ of $G$ with coefficients in 0 . Let $U$ be the group of $\left(q^{r}-1\right)$ th roots of unity in $\mathfrak{D}$. Reduction mod $\mathfrak{p}$ defines an isomorphism of $U$ onto $M_{r}$, and we take $\theta_{0}: M_{r} \rightarrow U$ to be the inverse of this isomorphism. If the eigenvalues of $\sigma(x)$ are $v_{i}(x)(1 \leqslant i \leqslant n)$, each $v_{i}(x)$ is a complex $g$ th root of unity, hence lies in $U$, and its reduction $\bmod \mathfrak{p}$ is $u_{i}(x)$ (for a suitable numbering of the $v_{i}(x)$ ). Hence $\chi(x)=\sum \theta_{0}\left(u_{i}(x)\right)=\sum v_{i}(x)$ is the trace of $\sigma(x)$.
(2) Now let $G$ be any finite group. By a famous theorem of Brauer (see for example Huppert, Endliche Gruppen I, p. 586), it is enough to prove the proposition in the case that $G$ is an elementary group, i.e. the direct product of a cyclic group $\langle x\rangle$ and an $l$-group, where $l$ is a prime which does not divide the order of $x$. Then $G$ is the direct product of a $p$-group $P$ and a group $H$ of order prime to $p$. If $y \in P$, the eigenvalues of $\rho(y)$ are $p$-power roots of unity in $\bar{k}$, hence are all equal to 1 , and since $y$ commutes with each $x \in H$ the matrices $\rho(x)$ and $\rho(y)$ can be simultaneously put in triangular form; hence the eigenvalues of $x y$ are the same as those of $x$, whence $\chi(x y)=\chi(x)$. But $\chi \mid H$ is a character of $H$, by the first part of the proof, hence $\chi$ is a character of $G$.

## Notes and references

Our account of the character theory of $G L_{n}(k)$ follows Green's paper [G11] in all essential points. For another account, oriented more towards the structure theory of reductive algebraic groups, see Springer [S20]. Another approach to the characters of $G L_{n}(k)$, based on the theory of Hopf algebras, is developed in [Z2] and [S21].

